!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.RethinkdbWebsocketClient=e():t.RethinkdbWebsocketClient=e()}(self,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=16)}([function(t,e,r){"use strict";var n=r(5),o="undefined"==typeof navigator,i=function(){try{var t={};return n.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(t){return!1}}(),c={e:{}},u;function s(){try{var t=u;return u=null,t.apply(this,arguments)}catch(t){return c.e=t,c}}function p(t){return u=t,s}var a=function(t,e){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=t,this.constructor$=e,e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}return n.prototype=e.prototype,t.prototype=new n,t.prototype};function l(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function f(t){return!l(t)}function h(t){return l(t)?new Error(j(t)):t}function _(t,e){var r,n=t.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=t[r];return o[r]=e,o}function y(t,e,r){if(!n.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var o=Object.getOwnPropertyDescriptor(t,e);return null!=o?null==o.get&&null==o.set?o.value:r:void 0}function d(t,e,r){if(l(t))return t;var o={value:r,configurable:!0,enumerable:!1,writable:!0};return n.defineProperty(t,e,o),t}function v(t){throw t}var m=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1};if(n.isES5){var r=Object.getOwnPropertyNames;return function(t){for(var o=[],i=Object.create(null);null!=t&&!e(t);){var c;try{c=r(t)}catch(t){return o}for(var u=0;u<c.length;++u){var s=c[u];if(!i[s]){i[s]=!0;var p=Object.getOwnPropertyDescriptor(t,s);null!=p&&null==p.get&&null==p.set&&o.push(s)}}t=n.getPrototypeOf(t)}return o}}var o={}.hasOwnProperty;return function(r){if(e(r))return[];var n=[];t:for(var i in r)if(o.call(r,i))n.push(i);else{for(var c=0;c<t.length;++c)if(o.call(t[c],i))continue t;n.push(i)}return n}}(),g=/this\s*\.\s*\S+\s*=/;function b(t){try{if("function"==typeof t){var e=n.names(t.prototype),r=n.isES5&&e.length>1,o=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=g.test(t+"")&&n.names(t).length>0;if(r||o||i)return!0}return!1}catch(t){return!1}}function w(t){function e(){}e.prototype=t;for(var r=8;r--;)new e;return t}var E=/^[a-z$_][a-z$_0-9]*$/i;function O(t){return E.test(t)}function R(t,e,r){for(var n=new Array(t),o=0;o<t;++o)n[o]=e+o+r;return n}function j(t){try{return t+""}catch(t){return"[no string representation]"}}function T(t){try{d(t,"isOperational",!0)}catch(t){}}function C(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function S(t){return t instanceof Error&&n.propertyIsWritable(t,"stack")}var A="stack"in new Error?function(t){return S(t)?t:new Error(j(t))}:function(t){if(S(t))return t;try{throw new Error(j(t))}catch(t){return t}};function k(t){return{}.toString.call(t)}function I(t,e,r){for(var o=n.names(t),i=0;i<o.length;++i){var c=o[i];if(r(c))try{n.defineProperty(e,c,n.getDescriptor(t,c))}catch(t){}}}var F={isClass:b,isIdentifier:O,inheritedDataKeys:m,getDataPropertyOrDefault:y,thrower:v,isArray:n.isArray,haveGetters:i,notEnumerableProp:d,isPrimitive:l,isObject:f,canEvaluate:o,errorObj:c,tryCatch:p,inherits:a,withAppended:_,maybeWrapAsError:h,toFastProperties:w,filledRange:R,toString:j,canAttachTrace:S,ensureErrorObject:A,originatesFromRejection:C,markAsOriginatingFromRejection:T,classString:k,copyDescriptors:I,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===k(process).toLowerCase()},P;F.isRecentNode=F.isNode&&(P=process.versions.node.split(".").map(Number),0===P[0]&&P[1]>10||P[0]>0),F.isNode&&F.toFastProperties(process);try{throw new Error}catch(t){F.lastLineError=t}t.exports=F},function(t,e,r){"use strict";var n,o,i=r(5),c=i.freeze,u=r(0),s=u.inherits,p=u.notEnumerableProp;function a(t,e){function r(n){if(!(this instanceof r))return new r(n);p(this,"message","string"==typeof n?n:e),p(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return s(r,Error),r}var l=a("Warning","warning"),f=a("CancellationError","cancellation error"),h=a("TimeoutError","timeout error"),_=a("AggregateError","aggregate error");try{n=TypeError,o=RangeError}catch(t){n=a("TypeError","type error"),o=a("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),d=0;d<y.length;++d)"function"==typeof Array.prototype[y[d]]&&(_.prototype[y[d]]=Array.prototype[y[d]]);i.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var v=0;function m(t){if(!(this instanceof m))return new m(t);p(this,"name","OperationalError"),p(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(p(this,"message",t.message),p(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_.prototype.toString=function(){var t=Array(4*v+1).join(" "),e="\n"+t+"AggregateError of:\n";v++,t=Array(4*v+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(n=o.join("\n"))+"\n"}return v--,e},s(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=c({CancellationError:f,TimeoutError:h,OperationalError:m,RejectionError:m,AggregateError:_}),p(Error,"__BluebirdErrorTypes__",g)),t.exports={Error:Error,TypeError:n,RangeError:o,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:l}},function(t,e,r){"use strict";var n;try{throw new Error}catch(t){n=t}var o=r(19),i=r(20),c=r(0);function u(){this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=o.isStatic?o(this.drainQueues):o}function s(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function p(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}u.prototype.disableTrampolineIfNecessary=function(){c.hasDevTools&&(this._trampolineEnabled=!1)},u.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(t){setTimeout(t,0)})},u.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},u.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},c.hasDevTools?(o.isStatic&&(o=function(t){setTimeout(t,0)}),u.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?s.call(this,t,e,r):this._schedule((function(){setTimeout((function(){t.call(e,r)}),100)}))},u.prototype.invoke=function(t,e,r){this._trampolineEnabled?p.call(this,t,e,r):this._schedule((function(){t.call(e,r)}))},u.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule((function(){t._settlePromises()}))}):(u.prototype.invokeLater=s,u.prototype.invoke=p,u.prototype.settlePromises=a),u.prototype.invokeFirst=function(t,e,r){this._normalQueue.unshift(t,e,r),this._queueTick()},u.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var r=t.shift(),n=t.shift();e.call(r,n)}else e._settlePromises()}},u.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},u.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},u.prototype._reset=function(){this._isTickUsed=!1},t.exports=new u,t.exports.firstLineError=n},function(t,e,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var o=r(18)();o.noConflict=function(){try{Promise===o&&(Promise=n)}catch(t){}return o},t.exports=o},function(t,e){t.exports={VersionDummy:{Version:{V0_1:1063369270,V0_2:1915781601,V0_3:1601562686,V0_4:1074539808,V1_0:885177795},Protocol:{PROTOBUF:656407617,JSON:2120839367}},Query:{QueryType:{START:1,CONTINUE:2,STOP:3,NOREPLY_WAIT:4,SERVER_INFO:5},AssocPair:{}},Frame:{FrameType:{POS:1,OPT:2}},Backtrace:{},Response:{ResponseType:{SUCCESS_ATOM:1,SUCCESS_SEQUENCE:2,SUCCESS_PARTIAL:3,WAIT_COMPLETE:4,SERVER_INFO:5,CLIENT_ERROR:16,COMPILE_ERROR:17,RUNTIME_ERROR:18},ErrorType:{INTERNAL:1e6,RESOURCE_LIMIT:2e6,QUERY_LOGIC:3e6,NON_EXISTENCE:31e5,OP_FAILED:41e5,OP_INDETERMINATE:42e5,USER:5e6,PERMISSION_ERROR:6e6},ResponseNote:{SEQUENCE_FEED:1,ATOM_FEED:2,ORDER_BY_LIMIT_FEED:3,UNIONED_FEED:4,INCLUDES_STATES:5}},Datum:{DatumType:{R_NULL:1,R_BOOL:2,R_NUM:3,R_STR:4,R_ARRAY:5,R_OBJECT:6,R_JSON:7},AssocPair:{}},Term:{TermType:{DATUM:1,MAKE_ARRAY:2,MAKE_OBJ:3,VAR:10,JAVASCRIPT:11,UUID:169,HTTP:153,ERROR:12,IMPLICIT_VAR:13,DB:14,TABLE:15,GET:16,GET_ALL:78,EQ:17,NE:18,LT:19,LE:20,GT:21,GE:22,NOT:23,ADD:24,SUB:25,MUL:26,DIV:27,MOD:28,FLOOR:183,CEIL:184,ROUND:185,APPEND:29,PREPEND:80,DIFFERENCE:95,SET_INSERT:88,SET_INTERSECTION:89,SET_UNION:90,SET_DIFFERENCE:91,SLICE:30,SKIP:70,LIMIT:71,OFFSETS_OF:87,CONTAINS:93,GET_FIELD:31,KEYS:94,VALUES:186,OBJECT:143,HAS_FIELDS:32,WITH_FIELDS:96,PLUCK:33,WITHOUT:34,MERGE:35,BETWEEN_DEPRECATED:36,BETWEEN:182,REDUCE:37,MAP:38,FOLD:187,FILTER:39,CONCAT_MAP:40,ORDER_BY:41,DISTINCT:42,COUNT:43,IS_EMPTY:86,UNION:44,NTH:45,BRACKET:170,INNER_JOIN:48,OUTER_JOIN:49,EQ_JOIN:50,ZIP:72,RANGE:173,INSERT_AT:82,DELETE_AT:83,CHANGE_AT:84,SPLICE_AT:85,COERCE_TO:51,TYPE_OF:52,UPDATE:53,DELETE:54,REPLACE:55,INSERT:56,DB_CREATE:57,DB_DROP:58,DB_LIST:59,TABLE_CREATE:60,TABLE_DROP:61,TABLE_LIST:62,CONFIG:174,STATUS:175,WAIT:177,RECONFIGURE:176,REBALANCE:179,SYNC:138,GRANT:188,INDEX_CREATE:75,INDEX_DROP:76,INDEX_LIST:77,INDEX_STATUS:139,INDEX_WAIT:140,INDEX_RENAME:156,FUNCALL:64,BRANCH:65,OR:66,AND:67,FOR_EACH:68,FUNC:69,ASC:73,DESC:74,INFO:79,MATCH:97,UPCASE:141,DOWNCASE:142,SAMPLE:81,DEFAULT:92,JSON:98,TO_JSON_STRING:172,ISO8601:99,TO_ISO8601:100,EPOCH_TIME:101,TO_EPOCH_TIME:102,NOW:103,IN_TIMEZONE:104,DURING:105,DATE:106,TIME_OF_DAY:126,TIMEZONE:127,YEAR:128,MONTH:129,DAY:130,DAY_OF_WEEK:131,DAY_OF_YEAR:132,HOURS:133,MINUTES:134,SECONDS:135,TIME:136,MONDAY:107,TUESDAY:108,WEDNESDAY:109,THURSDAY:110,FRIDAY:111,SATURDAY:112,SUNDAY:113,JANUARY:114,FEBRUARY:115,MARCH:116,APRIL:117,MAY:118,JUNE:119,JULY:120,AUGUST:121,SEPTEMBER:122,OCTOBER:123,NOVEMBER:124,DECEMBER:125,LITERAL:137,GROUP:144,SUM:145,AVG:146,MIN:147,MAX:148,SPLIT:149,UNGROUP:150,RANDOM:151,CHANGES:152,ARGS:154,BINARY:155,GEOJSON:157,TO_GEOJSON:158,POINT:159,LINE:160,POLYGON:161,DISTANCE:162,INTERSECTS:163,INCLUDES:164,CIRCLE:165,GET_INTERSECTING:166,FILL:167,GET_NEAREST:168,POLYGON_SUB:171,MINVAL:180,MAXVAL:181},AssocPair:{}}}},function(t,e){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!(r&&!r.writable&&!r.set)}};else{var n={}.hasOwnProperty,o={}.toString,i={}.constructor.prototype,c=function(t){var e=[];for(var r in t)n.call(t,r)&&e.push(r);return e};t.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:c,names:c,defineProperty:function(t,e,r){return t[e]=r.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return i}},isES5:r,propertyIsWritable:function(){return!0}}}},function(t,e){var r,n,o,i,c,u,s,p,a,l,f,h,_,y,d,v,m,g,b=function(t,e){for(var r in e)w.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},w={}.hasOwnProperty;i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(u=function(t){function e(t,e,r){this.name=this.constructor.name,this.msg=t,this.frames=null!=r?r.slice(0):void 0,null!=e?"."===t[t.length-1]?this.message=t.slice(0,t.length-1)+" in:\n"+_.prototype.printQuery(e)+"\n"+_.prototype.printCarrots(e,r):this.message=t+" in:\n"+_.prototype.printQuery(e)+"\n"+_.prototype.printCarrots(e,r):this.message=""+t,null!=Error.captureStackTrace&&Error.captureStackTrace(this,this)}return b(e,t),e}(Error))),v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(o),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(u)),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(u))),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(u),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d)),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(n),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e}(d),_=function(){var t,e,r,n,o;function i(){}return i.prototype.printQuery=function(t){var e;return e=n(t),o(e)},n=function(t){var e,r,o,i,c;for(o in r=function(){var r,o,i,c;for(c=[],r=0,o=(i=t.args).length;r<o;r++)e=i[r],c.push(n(e));return c}(),i={},c=t.optargs)w.call(c,o)&&(e=c[o],i[o]=n(e));return t.compose(r,i)},i.prototype.printCarrots=function(t,i){var c;return c=0===i.length?[e(n(t))]:r(t,i),o(c).replace(/[^\^]/g," ")},r=function(t,o){var i,c,u,s,p,a,l;for(p in u=o.shift(),c=function(){var e,c,p,a;for(p=t.args,a=[],s=e=0,c=p.length;e<c;s=++e)i=p[s],u===s?a.push(r(i,o)):a.push(n(i));return a}(),a={},l=t.optargs)w.call(l,p)&&(i=l[p],a[p]=u===p?r(i,o):n(i));return null!=u?t.compose(c,a):e(t.compose(c,a))},t={},e=function(e){return[t,e]},o=function(e){var r,n,i,c;for(i="",r=0,n=e.length;r<n;r++)c=e[r],Array.isArray(c)?2===c.length&&c[0]===t?i+=o(c[1]).replace(/./g,"^"):i+=o(c):i+=c;return i},i}(),t.exports={ReqlError:u,ReqlCompileError:o,RqlCompileError:o,ReqlServerCompileError:v,ReqlDriverCompileError:i,RqlClientError:c,ReqlRuntimeError:d,RqlRuntimeError:d,RqlServerError:d,ReqlQueryLogicError:h,ReqlNonExistenceError:p,ReqlResourceLimitError:y,ReqlUserError:g,ReqlInternalError:s,ReqlTimeoutError:m,ReqlAvailabilityError:n,ReqlOpFailedError:a,ReqlOpIndeterminateError:l,ReqlPermissionError:f,ReqlDriverError:c,RqlDriverError:c,ReqlAuthError:r,printQuery:_.prototype.printQuery}},function(t,e,r){var n,o,i;o=r(11),i=r(13),n=r(6),i.connect=o.connect,i.Error=n,i._bluebird=r(3),t.exports=i,t.exports.net=o},function(t,e,r){"use strict";r.r(e);var n=r(14),o=r.n(n),i=r(15),c=r.n(i),u=function(){this.offset=0,this.lastChunk=!1,this.chunk=null,this.chunkLength=0,this.headerSize=8,this.lengthPadding=0,this.header=null};function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}u.prototype.addChunk=function(t){if(!this.chunk||this.offset===this.chunkLength)return this.chunk=t,this.chunkLength=t.length,void(this.offset=0);var e=t.length,r=this.chunkLength+e;if(r>this.chunk.length){for(var n=2*this.chunk.length;r>=n;)n*=2;var o=Buffer.alloc(n);this.chunk.copy(o),this.chunk=o}t.copy(this.chunk,this.chunkLength),this.chunkLength=r},u.prototype.read=function(){if(this.chunkLength<this.headerSize+4+this.offset)return!1;var t=this.chunk.readInt32LE(this.offset+this.headerSize)+this.lengthPadding;if(t>this.chunkLength-(this.offset+4+this.headerSize))return!1;var e=this.chunk.slice(this.offset,this.offset+t+4+this.headerSize);return this.offset+=t+12,e},r.d(e,"configureTcpPolyfill",(function(){return l})),r.d(e,"setIsConnected",(function(){return f})),r.d(e,"Socket",(function(){return h})),r.d(e,"connect",(function(){return _})),r.d(e,"createConnection",(function(){return y})),r.d(e,"createServer",(function(){return d})),r.d(e,"isIPv4",(function(){return v})),r.d(e,"isIPv6",(function(){return m})),r.d(e,"isIP",(function(){return g}));var p={path:"/",secure:!1,wsProtocols:void 0,wsBinaryType:void 0,simulatedLatencyMs:void 0,waitForPacket:!1,isConnected:!1},a=function(t){return function(){throw new Error("Not implemented in TcpPolyfill: "+t)}};function l(t){p.path=t.path,p.secure=t.secure,p.wsProtocols=t.wsProtocols,p.wsBinaryType=t.wsBinaryType,p.simulatedLatencyMs=t.simulatedLatencyMs,p.waitForPacket=t.waitForPacket,p.isConnected=!1}function f(){p.isConnected=!0}function h(t){var e=this;if(!(this instanceof h))return new h(t);var r=new c.a({});["on","once","removeListener","emit","addListener","removeAllListeners","setMaxListeners","listeners"].forEach((function(t){e[t]=r[t].bind(r)}));var n=null;this.connect=function(t,i,c){e._simulatedLatencyMs=p.simulatedLatencyMs;var s=p.secure?"wss":"ws",a=p.path,l="".concat(s,"://").concat(i,":").concat(t).concat(a),f=new u;n=new WebSocket(l,p.wsProtocols),p.wsBinaryType&&(n.binaryType=p.wsBinaryType),c&&r.on("connect",c),n.onopen=function(t){r.emit("connect")},n.onclose=function(t){r.emit("end"),r.emit("close")},n.onerror=function(t){r.emit("error",t)},n.onmessage=function(t){var e=t.data,i="string"==typeof e&&"base64"===n.protocol,c=p.wsProtocols&&p.wsProtocols.constructor===Array&&p.wsProtocols.indexOf("base64")>=0,u="undefined"!=typeof navigator&&"ReactNative"===navigator.product&&c&&!n.protocol,s=i||u,a=p.waitForPacket&&p.isConnected;if("undefined"!=typeof Blob&&e instanceof Blob)o()(e,(function(t,e){if(t)throw t;r.emit("data",e)}));else if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){if(6===e.byteLength&&"logout"===Buffer.from(e).toString())return r.emit("logout");if(a){f.addChunk(Buffer.from(e));for(var l=f.read();l;)r.emit("data",l),l=f.read()}else r.emit("data",Buffer.from(e))}else s?r.emit("data",new Buffer(e,"base64")):r.emit("data",e)}},this.end=function(t){void 0!==t&&e.write(t),n.close()},this.destroy=function(){n.close()},this.write=function(t){var r=null;if("base64"===n.protocol)r=new Buffer(t).toString("base64");else{for(var o=new ArrayBuffer(t.length),i=new Uint8Array(o),c=0;c<t.length;++c)i[c]=t[c];r=o}var u=e._simulatedLatencyMs;"number"==typeof u&&u>0?setTimeout((function(){return n.send(r)}),u):n.send(r)},this.setNoDelay=function(t){},this.setKeepAlive=function(t,e){};["setEncoding","pause","resume","setTimeout","address","unref","ref"].forEach((function(t){e[t]=a(t)}))}function _(){for(var t={},e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r[0]&&"object"===s(r[0]))t.port=r[0].port,t.host=r[0].host,t.connectListener=r[1];else{if(!(Number(r[0])>0))throw new Error("Unsupported arguments for net.connect");t.port=r[0],t.host=r[1],t.connectListener=r[2]}var o=new h;return o.connect(t.port,t.host,t.connectListener),o}var y=_,d=a("createServer"),v=function(t){return!0},m=function(t){return!1},g=function(t){return v(t)?4:m(t)?6:0}},function(t,e,r){var n,o,i,c,u,s,p,a,l,f,h=[].slice;o=r(6),l=r(4),a=l.Response.ErrorType,p=function(t){return 1===t?"":"s"},t.exports.ar=function(t){return function(){var e;if((e=1<=arguments.length?h.call(arguments,0):[]).length!==t.length)throw new o.ReqlDriverCompileError("Expected "+t.length+" argument"+p(t.length)+" but found "+e.length+".");return t.apply(this,e)}},t.exports.varar=function(t,e,r){return function(){var n;if(n=1<=arguments.length?h.call(arguments,0):[],null!=t&&n.length<t||null!=e&&n.length>e){if(null!=t&&null==e)throw new o.ReqlDriverCompileError("Expected "+t+" or more arguments but found "+n.length+".");if(null!=e&&null==t)throw new o.ReqlDriverCompileError("Expected "+e+" or fewer arguments but found "+n.length+".");throw new o.ReqlDriverCompileError("Expected between "+t+" and "+e+" arguments but found "+n.length+".")}return r.apply(this,n)}},t.exports.aropt=function(t){return function(){var e,r,n,i;if(null!=(i=(e=1<=arguments.length?h.call(arguments,0):[])[r=t.length-1])&&"[object Object]"!==Object.prototype.toString.call(i)&&(i=null),r!==(n=e.length-(null!=i?1:0)))throw 1!==r?new o.ReqlDriverCompileError("Expected "+r+" arguments (not including options) but found "+n+"."):new o.ReqlDriverCompileError("Expected "+r+" argument (not including options) but found "+n+".");return t.apply(this,e)}},t.exports.toArrayBuffer=function(t){var e,r,n,o,i;for(e=new Uint8Array(new ArrayBuffer(t.length)),r=n=0,o=t.length;n<o;r=++n)i=t[r],e[r]=i;return e.buffer},t.exports.fromCamelCase=function(t){return t.replace(/[A-Z]/g,(function(t){return"_"+t.toLowerCase()}))},t.exports.toCamelCase=function(t){return t.replace(/_[a-z]/g,(function(t){return t[1].toUpperCase()}))},n=function(t,e){var r,n,i,c,u;switch(t.$reql_type$){case"TIME":switch(e.timeFormat){case"native":case void 0:if(null==t.epoch_time)throw new o.ReqlDriverError("pseudo-type TIME "+t+" object missing expected field 'epoch_time'.");return new Date(1e3*t.epoch_time);case"raw":return t;default:throw new o.ReqlDriverError("Unknown timeFormat run option "+e.timeFormat+".")}break;case"GROUPED_DATA":switch(e.groupFormat){case"native":case void 0:for(u=[],n=0,i=(c=t.data).length;n<i;n++)r=c[n],u.push({group:r[0],reduction:r[1]});return u;case"raw":return t;default:throw new o.ReqlDriverError("Unknown groupFormat run option "+e.groupFormat+".")}break;case"BINARY":switch(e.binaryFormat){case"native":case void 0:if(null==t.data)throw new o.ReqlDriverError("pseudo-type BINARY object missing expected field 'data'.");return new Buffer(t.data,"base64");case"raw":return t;default:throw new o.ReqlDriverError("Unknown binaryFormat run option "+e.binaryFormat+".")}break;default:return t}},f=function(t,e){var r,o,i,c,u;if(Array.isArray(t))for(r=o=0,c=t.length;o<c;r=++o)u=t[r],t[r]=f(u,e);else if(t&&"object"==typeof t){for(i in t)u=t[i],t[i]=f(u,e);t=n(t,e)}return t},c=function(t,e){return f(t.r[0],e)},s=function(t,e){return f(t.r,e)},u=function(t,e,r){return new t(c(e),r,e.b)},i=function(t){switch(t){case a.QUERY_LOGIC:return o.ReqlQueryLogicError;case a.NON_EXISTENCE:return o.ReqlNonExistenceError;case a.RESOURCE_LIMIT:return o.ReqlResourceLimitError;case a.USER:return o.ReqlUserError;case a.INTERNAL:return o.ReqlInternalError;case a.OP_FAILED:return o.ReqlOpFailedError;case a.OP_INDETERMINATE:return o.ReqlOpIndeterminateError;case a.PERMISSION_ERROR:return o.ReqlPermissionError;default:return o.ReqlRuntimeError}},t.exports.recursivelyConvertPseudotype=f,t.exports.mkAtom=c,t.exports.mkSeq=s,t.exports.mkErr=u,t.exports.errorClass=i},function(t,e,r){"use strict";var n=r(0),o=n.maybeWrapAsError,i=r(1),c=i.TimeoutError,u=i.OperationalError,s=n.haveGetters,p=r(5);var a,l=/^(?:name|message|stack|cause)$/;function f(t){var e;if(function(t){return t instanceof Error&&p.getPrototypeOf(t)===Error.prototype}(t)){(e=new u(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var r=p.keys(t),o=0;o<r.length;++o){var i=r[o];l.test(i)||(e[i]=t[i])}return e}return n.markAsOriginatingFromRejection(t),t}function h(t){return function(e,r){if(null!==t){if(e){var n=f(o(e));t._attachExtraTrace(n),t._reject(n)}else if(arguments.length>2){for(var i=arguments.length,c=new Array(i-1),u=1;u<i;++u)c[u-1]=arguments[u];t._fulfill(c)}else t._fulfill(r);t=null}}}if(a=s?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=h(t),this.callback=this.asCallback},s){var _={get:function(){return h(this.promise)}};p.defineProperty(a.prototype,"asCallback",_),p.defineProperty(a.prototype,"callback",_)}a._nodebackForPromise=h,a.prototype.toString=function(){return"[object PromiseResolver]"},a.prototype.resolve=a.prototype.fulfill=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(t)},a.prototype.reject=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(t)},a.prototype.progress=function(t){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(t)},a.prototype.cancel=function(t){this.promise.cancel(t)},a.prototype.timeout=function(){this.reject(new c("timeout"))},a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=function(){return this.promise.toJSON()},t.exports=a},function(t,e,r){var n,o,i,c,u,s,p,a,l,f,h,_,y,d,v,m,g,b,w,E,O,R,j,T=function(t,e){for(var r in e)C.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},C={}.hasOwnProperty;_=r(8),O=r(50),l=r(12),R=r(9),a=r(6),p=r(51),w=r(4),s=r(52),g=w.VersionDummy.Version.V1_0,b=0,d=w.VersionDummy.Protocol.JSON,v=w.Query.QueryType,m=w.Response.ResponseType,E=r(13),i=r(3),u=R.ar,j=R.varar,R.aropt,f=R.mkAtom,h=R.mkErr,n=function(t){function e(t,e){var r,n,o;void 0===t?t={}:"string"==typeof t&&(t={host:t}),this.host=t.host||this.DEFAULT_HOST,this.port=t.port||this.DEFAULT_PORT,this.db=t.db,this.authKey=t.authKey||this.DEFAULT_AUTH_KEY,this.timeout=t.timeout||this.DEFAULT_TIMEOUT,"boolean"==typeof t.ssl&&t.ssl?this.ssl={}:"object"==typeof t.ssl?this.ssl=t.ssl:this.ssl=!1,this.outstandingCallbacks={},this.nextToken=1,this.open=!1,this.closing=!1,this.buffer=new Buffer(0),this._events=this._events||{},o=this,n=function(t){return o.removeListener("connect",r),t instanceof a.ReqlError?e(t):e(new a.ReqlDriverError("Could not connect to "+o.host+":"+o.port+".\n"+t.message))},this.once("error",n),r=function(t){return function(){return t.removeListener("error",n),t.open=!0,e(null,t)}}(this),this.once("connect",r),this._closePromise=null}return T(e,t),e.prototype.DEFAULT_HOST="localhost",e.prototype.DEFAULT_PORT=28015,e.prototype.DEFAULT_AUTH_KEY="",e.prototype.DEFAULT_TIMEOUT=20,e.prototype._data=function(t){var e,r,n,o,i;for(this.buffer=Buffer.concat([this.buffer,t]),o=[];this.buffer.length>=12&&(i=this.buffer.readUInt32LE(0)+4294967296*this.buffer.readUInt32LE(4),n=this.buffer.readUInt32LE(8),this.buffer.length>=12+n);)r=this.buffer.slice(12,n+12),e=JSON.parse(r),this._processResponse(e,i),o.push(this.buffer=this.buffer.slice(12+n));return o},e.prototype._delQuery=function(t){return delete this.outstandingCallbacks[t]},e.prototype._processResponse=function(t,e){var r,n,o,i,c,u,s,l,_,y;if(s=t.p,null!=this.outstandingCallbacks[e])if(r=(l=this.outstandingCallbacks[e]).cb,y=l.root,n=l.cursor,u=l.opts,l.feed,null!=n){if(n._addResponse(t),n._endFlag&&0===n._outstandingRequests)return this._delQuery(e)}else if(null!=r)switch(t.t){case m.COMPILE_ERROR:return r(h(a.ReqlServerCompileError,t,y)),this._delQuery(e);case m.CLIENT_ERROR:return r(h(a.ReqlDriverError,t,y)),this._delQuery(e);case m.RUNTIME_ERROR:return o=R.errorClass(t.e),r(h(o,t,y)),this._delQuery(e);case m.SUCCESS_ATOM:return t=f(t,u),Array.isArray(t)&&(t=p.makeIterable(t)),null!=s&&(t={profile:s,value:t}),r(null,t),this._delQuery(e);case m.SUCCESS_PARTIAL:for(n=null,i=0,c=(_=t.n).length;i<c;i++)switch(_[i]){case w.Response.ResponseNote.SEQUENCE_FEED:null==n&&(n=new p.Feed(this,e,u,y));break;case w.Response.ResponseNote.UNIONED_FEED:null==n&&(n=new p.UnionedFeed(this,e,u,y));break;case w.Response.ResponseNote.ATOM_FEED:null==n&&(n=new p.AtomFeed(this,e,u,y));break;case w.Response.ResponseNote.ORDER_BY_LIMIT_FEED:null==n&&(n=new p.OrderByLimitFeed(this,e,u,y))}return null==n&&(n=new p.Cursor(this,e,u,y)),this.outstandingCallbacks[e].cursor=n,r(null,null!=s?{profile:s,value:n._addResponse(t)}:n._addResponse(t));case m.SUCCESS_SEQUENCE:return n=new p.Cursor(this,e,u,y),this._delQuery(e),r(null,null!=s?{profile:s,value:n._addResponse(t)}:n._addResponse(t));case m.WAIT_COMPLETE:return this._delQuery(e),r(null,null);case m.SERVER_INFO:return this._delQuery(e),r(null,t=f(t,u));default:return r(new a.ReqlDriverError("Unknown response type"))}},e.prototype.close=j(0,2,(function(t,e){var r,n,o,c,u;if(null!=e){if(c=t,"[object Object]"!==Object.prototype.toString.call(c))throw new a.ReqlDriverError("First argument to two-argument `close` must be an object.");r=e}else"[object Object]"===Object.prototype.toString.call(t)?(c=t,r=null):"function"==typeof t?(c={},r=t):(c=t,r=null);for(n in c)if(C.call(c,n)&&"noreplyWait"!==n)throw new a.ReqlDriverError("First argument to two-argument `close` must be { noreplyWait: <bool> }.");return null!=this._closePromise?this._closePromise.nodeify(r):(this.closing=!0,o=(null==c.noreplyWait||c.noreplyWait)&&this.open,this._closePromise=new i((u=this,function(t,e){var r;return r=function(r,n){return u.open=!1,u.closing=!1,u.cancel(),null!=r?e(r):t(n)},o?u.noreplyWait(r):r()})).nodeify(r))})),e.prototype.noreplyWait=j(0,1,(function(t){var e,r,n;return this.open?(r=this.nextToken++,(e={}).type=v.NOREPLY_WAIT,e.token=r,new i((n=this,function(t,o){var i;return i=function(e,r){return e?o(e):t(r)},n.outstandingCallbacks[r]={cb:i,root:null,opts:null},n._sendQuery(e)})).nodeify(t)):new i((function(t,e){return e(new a.ReqlDriverError("Connection is closed."))})).nodeify(t)})),e.prototype.server=j(0,1,(function(t){var e,r,n;return this.open?(r=this.nextToken++,(e={}).type=v.SERVER_INFO,e.token=r,new i((n=this,function(t,o){var i;return i=function(e,r){return e?o(e):t(r)},n.outstandingCallbacks[r]={cb:i,root:null,opts:null},n._sendQuery(e)})).nodeify(t)):new i((function(t,e){return e(new a.ReqlDriverError("Connection is closed."))})).nodeify(t)})),e.prototype.cancel=u((function(){var t,e,r,n;for(t in r={t:m.RUNTIME_ERROR,r:["Connection is closed."],b:[]},e=this.outstandingCallbacks)C.call(e,t)&&(null!=(n=e[t]).cursor?n.cursor._addResponse(r):null!=n.cb&&n.cb(h(R.errorClass(r.e),r,n.root)));return this.outstandingCallbacks={}})),e.prototype.reconnect=j(0,2,(function(t,e){var r,n,o;return null!=e?(n=t,r=e):"function"==typeof t?(n={},r=t):(n=null!=t?t:{},r=e),new i((o=this,function(t,e){var r;return r=function(r){return o.constructor.call(o,{host:o.host,port:o.port,timeout:o.timeout,authKey:o.authKey},(function(r,n){return null!=r?e(r):t(n)}))},o.close(n,r)})).nodeify(r)})),e.prototype.use=u((function(t){return this.db=t})),e.prototype.isOpen=function(){return this.open&&!this.closing},e.prototype._start=function(t,e,r){var n,o,i,c;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");for(n in i=this.nextToken++,(o={}).global_optargs={},o.type=v.START,o.query=t.build(),o.token=i,r)C.call(r,n)&&(c=r[n],o.global_optargs[R.fromCamelCase(n)]=E.expr(c).build());if(null==r.db&&null==this.db||(o.global_optargs.db=E.db(r.db||this.db).build()),null!=r.noreply&&(o.global_optargs.noreply=E.expr(!!r.noreply).build()),null!=r.profile&&(o.global_optargs.profile=E.expr(!!r.profile).build()),null!=r.noreply&&r.noreply||(this.outstandingCallbacks[i]={cb:e,root:t,opts:r}),this._sendQuery(o),null!=r.noreply&&r.noreply&&"function"==typeof e)return e(null)},e.prototype._continueQuery=function(t){var e;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");return e={type:v.CONTINUE,token:t},this._sendQuery(e)},e.prototype._endQuery=function(t){var e;if(!this.open)throw new a.ReqlDriverError("Connection is closed.");return e={type:v.STOP,token:t},this._sendQuery(e)},e.prototype._sendQuery=function(t){var e;return e=[t.type],void 0!==t.query&&(e.push(t.query),null!=t.global_optargs&&Object.keys(t.global_optargs).length>0&&e.push(t.global_optargs)),this._writeQuery(t.token,JSON.stringify(e))},e}(l.EventEmitter),y={},c=function(t){function e(t,r){var n,o;if(!e.isAvailable())throw new a.ReqlDriverError("TCP sockets are not available in this environment");e.__super__.constructor.call(this,t,r),this.ssl?(this.ssl.host=this.host,this.ssl.port=this.port,this.rawSocket=O.connect(this.ssl)):this.rawSocket=_.connect(this.port,this.host),this.rawSocket.setNoDelay(),this.rawSocket.setKeepAlive(!0),n=setTimeout((o=this,function(){return o.rawSocket.destroy(),o.emit("error",new a.ReqlTimeoutError("Could not connect to "+o.host+":"+o.port+", operation timed out."))}),1e3*this.timeout),this.rawSocket.once("error",(function(){return clearTimeout(n)})),this.rawSocket.once("connect",function(e){return function(){var r,o,i,c,u,p,l,f,h,_,v,m,w,E,O,R,j,T;return(j=new Buffer(4)).writeUInt32LE(g,0),new Buffer(4).writeUInt32LE(d,0),w=new Buffer(s.randomBytes(18)).toString("base64"),e.rawSocket.user=t.user,e.rawSocket.password=t.password,void 0===e.rawSocket.user&&(e.rawSocket.user="admin"),void 0===e.rawSocket.password&&(e.rawSocket.password=""),c="n="+e.rawSocket.user+",r="+w,h=JSON.stringify({protocol_version:b,authentication_method:"SCRAM-SHA-256",authentication:"n,,"+c}),v=new Buffer("\0","binary"),e.rawSocket.write(Buffer.concat([j,Buffer(h.toString()),v])),R=1,_=0,f=0,E="",O="",o="",i="",r=0,T=function(t,e){var r,n,o,i;for(i=[],r=n=0,o=Math.min(t.length,e.length);0<=o?n<o:n>o;r=0<=o?++n:--n)i.push(t[r]^e[r]);return new Buffer(i)},m=function(t,e,r){var n,o,i,c,u,p;if(n=t.toString("base64")+","+e.toString("base64")+","+r.toString(),y[n])return y[n];for((i=s.createHmac("sha256",t)).update(e),i.update("\0\0\0"),u=p=i.digest(),o=0,c=r-1;0<=c?o<c:o>c;0<=c?++o:--o)(i=s.createHmac("sha256",t)).update(u),u=i.digest(),p=T(p,u);return y[n]=p,p},u=function(t,e){var r,n,o,i,c,u;for(o=void 0,u=e,c=void 0,t.length===e.length&&(o=t,c=0),t.length!==e.length&&(o=e,c=1),r=n=0,i=Math.min(o.length,u.length);0<=i?n<i:n>i;r=0<=i?++n:--n)c|=o[r]^u[r];return 0===c},l=function(t,r){return 10<=t&&t<=20?e.emit("error",new a.ReqlAuthError(r)):e.emit("error",new a.ReqlDriverError(r))},p=function(t){var y,d,g,j,C,S,A,k,I,F,P,N,x,L,D,U,M,q,B,H,V,Q,Y,J;for(e.buffer=Buffer.concat([e.buffer,t]),P=0,I=N=0,L=(U=e.buffer).length;N<L;I=++N)if(0===U[I]){V=e.buffer.slice(P,I),P=I+1,Q=V.toString();try{H=JSON.parse(Q)}catch(A){throw A,new a.ReqlDriverError(Q)}if(1===R){if(!H.success)return void l(H.error_code,H.error);if(_=H.min_protocol_version,f=H.max_protocol_version,_>b||f<b)throw new a.ReqlDriverError("Unsupported protocol version "+b+", expected between "+_+" and "+f+".");R=2}else if(2===R){if(!H.success)return void l(H.error_code,H.error);for(d={},x=0,D=(M=(E=H.authentication).split(",")).length;x<D;x++)I=(F=M[x]).indexOf("="),d[F.slice(0,I)]=F.slice(I+1);if(o=d.r,i=new Buffer(d.s,"base64"),r=parseInt(d.i),o.substr(0,w.length)!==w)throw new a.ReqlAuthError("Invalid nonce from server");g="c=biws,r="+o,q=m(e.rawSocket.password,i,r),j=s.createHmac("sha256",q).update("Client Key").digest(),Y=s.createHash("sha256").update(j).digest(),y=c+","+E+","+g,S=s.createHmac("sha256",Y).update(y).digest(),C=T(j,S),B=s.createHmac("sha256",q).update("Server Key").digest(),O=s.createHmac("sha256",B).update(y).digest(),R=3,h=JSON.stringify({authentication:g+",p="+C.toString("base64")}),v=new Buffer("\0","binary"),e.rawSocket.write(Buffer.concat([Buffer(h.toString()),v]))}else{if(3!==R)throw new a.ReqlDriverError("Unexpected handshake state");if(!H.success)return void l(H.error_code,H.error);if(k=H.authentication.indexOf("="),J=H.authentication.slice(k+1),!u(J,O.toString("base64")))throw new a.ReqlAuthError("Invalid server signature");R=4,e.rawSocket.removeListener("data",p),e.rawSocket.on("data",(function(t){return e._data(t)})),clearTimeout(n),e.emit("connect")}}return e.buffer=e.buffer.slice(P+1)},e.rawSocket.on("data",p)}}(this)),this.rawSocket.on("error",function(t){return function(e){return t.emit("error",e)}}(this)),this.rawSocket.on("close",function(t){return function(){return t.isOpen()&&t.close({noreplyWait:!1}),t.emit("close")}}(this)),this.rawSocket.on("timeout",function(t){return function(){return t.open=!1,t.emit("timeout")}}(this))}return T(e,t),e.isAvailable=function(){return!process.browser},e.prototype.clientPort=function(){return this.rawSocket.localPort},e.prototype.clientAddress=function(){return this.rawSocket.localAddress},e.prototype.close=j(0,2,(function(t,r){var n,o,c;return null!=r?(o=t,n=r):"[object Object]"===Object.prototype.toString.call(t)?(o=t,n=null):"function"==typeof t?(o={},n=t):o={},new i((c=this,function(t,r){var n;return n=function(e,n){var o,i,u;return i=function(){return null!=e?r(e):t(n)},o=function(){var t;return i(),null!=(t=c.rawSocket)&&t.removeAllListeners(),c.rawSocket=null,c.emit("close")},null!=c.rawSocket?"closed"===c.rawSocket.readyState?o():(null!=(u=c.rawSocket)&&u.once("close",o),c.rawSocket.end()):process.nextTick(i)},e.__super__.close.call(c,o,n)})).nodeify(n)})),e.prototype.cancel=function(){return this.rawSocket.destroy(),e.__super__.cancel.call(this)},e.prototype._writeQuery=function(t,e){var r;return(r=new Buffer(8)).writeUInt32LE(4294967295&t,0),r.writeUInt32LE(Math.floor(t/4294967295),4),this.rawSocket.write(r),this.write(new Buffer(e))},e.prototype.write=function(t){var e;return(e=new Buffer(4)).writeUInt32LE(t.length,0),this.rawSocket.write(e),this.rawSocket.write(t)},e}(n),o=function(t){function e(t,r){var n,o,i,c;if(!e.isAvailable())throw new a.ReqlDriverError("XMLHttpRequest is not available in this environment");e.__super__.constructor.call(this,t,r),n="https"===t.protocol?"https":this.DEFAULT_PROTOCOL,o=n+"://"+this.host+":"+this.port+t.pathname+"ajax/reql/",(i=new XMLHttpRequest).open("POST",o+"open-new-connection?cacheBuster="+Math.random(),!0),i.responseType="text",i.onreadystatechange=(c=this,function(t){if(4===i.readyState)return 200===i.status?(c._url=o,c._connId=i.response,c.emit("connect")):c.emit("error",new a.ReqlDriverError("XHR error, http status "+i.status+"."))}),i.send(),this.xhr=i}return T(e,t),e.prototype.DEFAULT_PROTOCOL="http",e.isAvailable=function(){return"undefined"!=typeof XMLHttpRequest},e.prototype.cancel=function(){var t;if(null!=this._connId)return this.xhr.abort(),(t=new XMLHttpRequest).open("POST",this._url+"close-connection?conn_id="+this._connId,!0),t.responseType="arraybuffer",t.send(),this._url=null,this._connId=null,e.__super__.cancel.call(this)},e.prototype.close=j(0,2,(function(t,r){var n,o;if(null!=r?(o=t,n=r):"[object Object]"===Object.prototype.toString.call(t)?(o=t,n=null):(o={},n=t),null!=n&&"function"!=typeof n)throw new a.ReqlDriverError("Final argument to `close` must be a callback function or object.");return e.__super__.close.call(this,o,n)})),e.prototype._writeQuery=function(t,e){var r;return(r=new Buffer(encodeURI(e).split(/%..|./).length-1+8)).writeUInt32LE(4294967295&t,0),r.writeUInt32LE(Math.floor(t/4294967295),4),r.write(e,8),this.write(r,t)},e.prototype.write=function(t,e){var r,n,o,i;for((o=new XMLHttpRequest).open("POST",this._url+"?conn_id="+this._connId,!0),o.responseType="arraybuffer",o.onreadystatechange=(i=this,function(t){var e,r;if(4===o.readyState&&200===o.status)return r=new Buffer(function(){var t,r,n,i;for(i=[],t=0,r=(n=new Uint8Array(o.response)).length;t<r;t++)e=n[t],i.push(e);return i}()),i._data(r)}),o.onerror=function(t){return function(r){return t.outstandingCallbacks[e].cb(new Error("This HTTP connection is not open"))}}(this),n=new Uint8Array(t.length),r=0;r<t.length;)n[r]=t[r],r++;return o.send(n),this.xhr=o},e}(n),t.exports.isConnection=function(t){return t instanceof n},t.exports.connect=j(0,2,(function(t,e){var r;return"function"==typeof t?(r={},e=t):r=t||{},new i((function(t,e){if(null!=r.authKey&&(null!=r.password||null!=r.user||null!=r.username))throw new a.ReqlDriverError("Cannot use both authKey and password");if(r.user&&r.username)throw new a.ReqlDriverError("Cannot use both user and username");return r.authKey?(r.user="admin",r.password=r.authKey):null!=r.username&&(r.user=r.username),function(t,e){if(c.isAvailable())return new c(t,e);if(o.isAvailable())return new o(t,e);throw new a.ReqlDriverError("Neither TCP nor HTTP avaiable in this environment")}(r,(function(r,n){return r?e(r):t(n)}))})).nodeify(e)})),t.exports.Connection=n,t.exports.HttpConnection=o,t.exports.TcpConnection=c},function(t,e){t.exports=require("events")},function(t,e,r){var n,o,i,c,u,s,p,a,l,f,h,_,y,d,v,m,g,b,w,E,O,R,j,T,C,S,A,k,I,F,P,N,x,L,D,U,M,q,B,H,V,Q,Y,J,G,W,z,K,X,$,Z,tt,et,rt,nt,ot,it,ct,ut,st,pt,at,lt,ft,ht,_t,yt,dt,vt,mt,gt,bt,wt,Et,Ot,Rt,jt,Tt,Ct,St,At,kt,It,Ft,Pt,Nt,xt,Lt,Dt,Ut,Mt,qt,Bt,Ht,Vt,Qt,Yt,Jt,Gt,Wt,zt,Kt,Xt,$t,Zt,te,ee,re,ne,oe,ie,ce,ue,se,pe,ae,le,fe,he,_e,ye,de,ve,me,ge,be,we,Ee,Oe,Re,je,Te,Ce,Se,Ae,ke,Ie,Fe,Pe,Ne,xe,Le,De,Ue,Me,qe,Be,He,Ve,Qe,Ye,Je,Ge,We,ze,Ke,Xe,$e,Ze,tr,er,rr,nr,or,ir,cr,ur,sr,pr,ar,lr,fr,hr,_r,yr,dr,vr,mr=[].slice,gr={}.hasOwnProperty,br=function(t,e){for(var r in e)gr.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};dr=r(9),or=r(6),ar=r(11),lr=r(4).Term.TermType,oe=r(3),rr=dr.ar,vr=dr.varar,nr=dr.aropt,fr=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],fr.expr.apply(fr,t)},ir=function(t){var e;return void 0===t?t:(t=fr.expr(t),(e=function(t){var r,n;return t instanceof Ne&&(t instanceof at||(!!t.args.map(e).some((function(t){return t}))||!!function(){var e,o;for(r in o=[],e=t.optargs)gr.call(e,r)&&(n=e[r],o.push(n));return o}().map(e).some((function(t){return t}))))})(t)?new z({},(function(e){return t})):t)},cr=function(t){var e,r,n;if(Array.isArray(t)){for(r=0,n=t.length;r<n;r++)if(e=t[r],!0===cr(e))return!0}else if("r.row"===t)return!0;return!1},ue=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.eq=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(B,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ne=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.lt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ft,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.le=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(St,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.gt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(it,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(K,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.not=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Yt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.add=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(n,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.sub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ce,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.mul=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Vt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.div=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(D,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.mod=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Bt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.floor=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Y,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ceil=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(h,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.round=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ye,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.append=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(i,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.prepend=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ne,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.difference=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(N,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setInsert=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ge,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setUnion=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(we,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setIntersection=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(be,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setDifference=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(me,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.slice=vr(1,3,(function(t,e,r){return null!=r?new Oe(r,this,t,e):void 0!==e?"[object Object]"!==Object.prototype.toString.call(e)||e instanceof Ne?new Oe({},this,t,e):new Oe(e,this,t):new Oe({},this,t)})),e.prototype.skip=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ee,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.limit=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(At,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getField=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(tt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.contains=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(b,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.insertAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Et,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.spliceAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Re,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.deleteAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(F,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.changeAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(_,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.offsetsOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(zt,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.hasFields=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ct,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.withFields=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($e,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.keys=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ct,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.values=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ze,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.changes=nr((function(t){return new y(t,this)})),e.prototype.pluck=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Zt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.without=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ze,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.merge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ut,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.between=nr((function(t,e,r){return new p(r,this,t,e)})),e.prototype.reduce=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(he,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.map=vr(1,null,(function(){var t,e,r;return t=2<=arguments.length?mr.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(xt,[{},this].concat(mr.call(t),[ir(e)]),(function(){}))})),e.prototype.fold=nr((function(t,e,r){return new J(r,this,t,ir(e))})),e.prototype.filter=nr((function(t,e){return new Q(e,this,ir(t))})),e.prototype.concatMap=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(m,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.distinct=nr((function(t){return new L(t,this)})),e.prototype.count=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(w,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.union=function(){var t,e,r,n,o;return r=1<=arguments.length?mr.call(arguments,0):[],n={},e=r,!(o=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(o)||o instanceof Ne||(n=o,e=r.slice(0,r.length-1)),e=function(){var r,n,o;for(o=[],r=0,n=e.length;r<n;r++)(t=e[r])instanceof u||t instanceof P?o.push(t):o.push(ir(t));return o}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ye,[n,this].concat(mr.call(e)),(function(){}))},e.prototype.nth=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Gt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.bracket=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(l,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toJSON=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Be,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toJsonString=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Be,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.match=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Lt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.split=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(je,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.upcase=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Je,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.downcase=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(U,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.isEmpty=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Rt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.innerJoin=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(bt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.outerJoin=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($t,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.eqJoin=nr((function(t,e,r){return new H(r,this,ir(t),e)})),e.prototype.zip=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(er,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.coerceTo=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(v,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ungroup=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.typeOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(He,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.update=nr((function(t,e){return new Ge(e,this,ir(t))})),e.prototype.delete=nr((function(t){return new I(t,this)})),e.prototype.replace=nr((function(t,e){return new _e(e,this,ir(t))})),e.prototype.do=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(W,[{},ir(t.slice(-1)[0]),this].concat(mr.call(t.slice(0,-1))),(function(){}))},e.prototype.default=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(k,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.or=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Kt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.and=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(o,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.branch=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(f,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.forEach=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(G,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.sum=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Se,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.avg=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(s,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.info=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(gt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.sample=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(de,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.group=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],e.length>0&&(!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Ne||(r=n,t=e.slice(0,e.length-1))),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ot,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.orderBy=function(){var t,e,r,n,o;return r=1<=arguments.length?mr.call(arguments,0):[],n={},e=r,!(o=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(o)||o instanceof Ne||(n=o,e=r.slice(0,r.length-1)),e=function(){var r,n,o;for(o=[],r=0,n=e.length;r<n;r++)(t=e[r])instanceof u||t instanceof P?o.push(t):o.push(ir(t));return o}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Xt,[n,this].concat(mr.call(e)),(function(){}))},e.prototype.toGeojson=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Me,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.distance=nr((function(t,e){return new x(e,this,t)})),e.prototype.intersects=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ot,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.includes=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ft,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.fill=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(V,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.polygonSub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(re,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.tableCreate=nr((function(t,e){return new Ie(e,this,t)})),e.prototype.tableDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Fe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.tableList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.config=function(){return new g({},this)},e.prototype.status=function(){return new Te({},this)},e.prototype.wait=nr((function(t){return new Xe(t,this)})),e.prototype.table=nr((function(t,e){return new ke(e,this,t)})),e.prototype.get=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getAll=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],e.length>1&&(!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Ne||(r=n,t=e.slice(0,e.length-1))),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Z,[r,this].concat(mr.call(t)),(function(){}))},e.prototype.min=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],1===e.length&&(!(n=e[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Ne||(r=n,t=[])),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Mt,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.max=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],1===e.length&&(!(n=e[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Ne||(r=n,t=[])),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Dt,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.insert=nr((function(t,e){return new wt(e,this,fr.expr(t))})),e.prototype.indexCreate=vr(1,3,(function(t,e,r){return null!=r?new ht(r,this,t,ir(e)):null!=e?"[object Object]"!==Object.prototype.toString.call(e)||"function"==typeof e||e instanceof Ne?new ht({},this,t,ir(e)):new ht(e,this,t):new ht({},this,t)})),e.prototype.indexDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(_t,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(yt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexStatus=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(vt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexWait=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(mt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexRename=nr((function(t,e,r){return new dt(r,this,t,e)})),e.prototype.reconfigure=function(t){return new fe(t,this)},e.prototype.rebalance=function(){return new le({},this)},e.prototype.sync=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ae,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.grant=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(nt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toISO8601=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toEpochTime=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ue,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.inTimezone=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(lt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.during=nr((function(t,e,r){return new M(r,this,t,e)})),e.prototype.date=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(se,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.timeOfDay=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Le,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.timezone=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(De,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.year=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(tr,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.month=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ht,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.day=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(O,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.dayOfWeek=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(R,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.dayOfYear=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(j,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.hours=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ut,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.minutes=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.seconds=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ve,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.uuid=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ve,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getIntersecting=nr((function(t,e){return new et(e,this,t)})),e.prototype.getNearest=nr((function(t,e){return new rt(e,this,t)})),e}(Ne=function(){function t(){var t;return void 0!=={}.__proto__?((t=rr((function(e){return t.bracket(e)}))).__proto__=this.__proto__,t):this}return t.prototype.showRunWarning=!0,t.prototype.run=function(t,e,r){if(!0===ar.isConnection(t)){if("function"==typeof e){if(void 0!==r)return oe.reject(new or.ReqlDriverError("Second argument to `run` cannot be a function if a third argument is provided.")).nodeify(e);r=e,e={}}}else(null!=t?t.constructor:void 0)===Object&&(!0===this.showRunWarning&&("undefined"!=typeof process&&null!==process&&process.stderr.write("RethinkDB warning: This syntax is deprecated. Please use `run(connection[, options], callback)`."),this.showRunWarning=!1),r=e,e=t,t=t.connection,delete e.connection);return null==e&&(e={}),null!=r&&"function"!=typeof r?oe.reject(new or.ReqlDriverError("If provided, the callback must be a function. Please use `run(connection[, options][, callback])")):!1===ar.isConnection(t)?oe.reject(new or.ReqlDriverError("First argument to `run` must be an open connection.")).nodeify(r):new oe((n=this,function(r,o){var i,c;c=function(t,e){return null!=t?o(t):r(e)};try{return t._start(n,c,e)}catch(i){return c(i)}})).nodeify(r);var n},t.prototype.toString=function(){return or.printQuery(this)},t}()),E=function(t){function e(t){var r;return(r=e.__super__.constructor.call(this)).data=t,r}return br(e,t),e.prototype.args=[],e.prototype.optargs={},e.prototype.compose=function(){switch(typeof this.data){case"string":return'"'+this.data+'"';default:return""+this.data}},e.prototype.build=function(){if("number"==typeof this.data&&!isFinite(this.data))throw new TypeError("Illegal non-finite number `"+this.data.toString()+"`.");return this.data},e}(ue),_r=function(t){var e,r,n;for(e in r={},t)gr.call(t,e)&&(n=t[e],r[dr.toCamelCase(e)]=n);return r},yr=function(t){var e,r,n;for(e in r={},t)gr.call(t,e)&&(n=t[e],void 0!==e&&void 0!==n&&(r[dr.fromCamelCase(e)]=fr.expr(n)));return r},ie=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.compose=function(t,e){return["r.",this.st]},e}(ce=function(t){function e(){var t,r,n,o,i;return o=arguments[0],r=2<=arguments.length?mr.call(arguments,1):[],(i=e.__super__.constructor.call(this)).args=function(){var e,o,i;for(i=[],n=e=0,o=r.length;e<o;n=++e){if(void 0===(t=r[n]))throw new or.ReqlDriverCompileError("Argument "+n+" to "+(this.st||this.mt)+" may not be `undefined`.");i.push(fr.expr(t))}return i}.call(this),i.optargs=yr(o),i}return br(e,t),e.prototype.build=function(){var t,e,r,n,o,i,c,u,s,p;for(s=[this.tt,[]],r=0,o=(c=this.args).length;r<o;r++)e=c[r],s[1].push(e.build());for(n in i={},t=!1,u=this.optargs)gr.call(u,n)&&(p=u[n],t=!0,i[n]=p.build());return t&&s.push(i),s},e.prototype.compose=function(t,e){return this.st?["r.",this.st,"(",sr(t,e),")"]:(hr(this.args[0])&&(t[0]=["r(",t[0],")"]),[t[0],".",this.mt,"(",sr(t.slice(1),e),")"])},e}(ue)),ur=function(t){var e,r,n,o,i;if(null==t[0])return[];for(i=[t[0]],r=0,n=(o=t.slice(1)).length;r<n;r++)e=o[r],i.push(", ",e);return i},pr=function(t){var e,r;return["{",ur(function(){var n;for(e in n=[],t)gr.call(t,e)&&(r=t[e],n.push([JSON.stringify(e),": ",r]));return n}()),"}"]},sr=function(t,e){var r;return r=[],t.length>0&&r.push(ur(t)),Object.keys(e).length>0&&(r.length>0&&r.push(", "),r.push(pr(_r(e)))),r},hr=function(t){return t instanceof E||t instanceof Pt||t instanceof Nt},Pt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MAKE_ARRAY,e.prototype.st="[...]",e.prototype.compose=function(t){return["[",ur(t),"]"]},e}(ce),Nt=function(t){function e(t,r){var n,o,i;for(n in null==r&&(r=20),(o=e.__super__.constructor.call(this,{})).optargs={},t)if(gr.call(t,n)){if(void 0===(i=t[n]))throw new or.ReqlDriverCompileError("Object field '"+n+"' may not be undefined");o.optargs[n]=fr.expr(i,r-1)}return o}return br(e,t),e.prototype.tt=lr.MAKE_OBJ,e.prototype.st="{...}",e.prototype.compose=function(t,e){return pr(e)},e.prototype.build=function(){var t,e,r,n;for(t in r={},e=this.optargs)gr.call(e,t)&&(n=e[t],r[t]=n.build());return r},e}(ce),Ke=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.VAR,e.prototype.compose=function(t){return["var_"+t]},e}(ce),jt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.JAVASCRIPT,e.prototype.st="js",e}(ce),st=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.HTTP,e.prototype.st="http",e}(ce),Tt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.JSON,e.prototype.st="json",e}(ce),a=function(t){function e(t){var r;if(t instanceof Ne)r=e.__super__.constructor.call(this,{},t);else{if(!(t instanceof Buffer))throw new TypeError("Parameter to `r.binary` must be a Buffer object or RQL query.");(r=e.__super__.constructor.call(this)).base64_data=t.toString("base64")}return r}return br(e,t),e.prototype.tt=lr.BINARY,e.prototype.st="binary",e.prototype.compose=function(){return 0===this.args.length?"r.binary(<data>)":e.__super__.compose.apply(this,arguments)},e.prototype.build=function(){return 0===this.args.length?{$reql_type$:"BINARY",data:this.base64_data}:e.__super__.build.apply(this,arguments)},e}(ce),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ARGS,e.prototype.st="args",e}(ce),We=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ERROR,e.prototype.st="error",e}(ce),pe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.RANDOM,e.prototype.st="random",e}(ce),at=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.IMPLICIT_VAR,e.prototype.compose=function(){return["r.row"]},e}(ce),T=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DB,e.prototype.st="db",e}(ce),ke=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TABLE,e.prototype.st="table",e.prototype.compose=function(t,e){return this.args[0]instanceof T?[t[0],".table(",sr(t.slice(1),e),")"]:["r.table(",sr(t,e),")"]},e}(ce),$=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GET,e.prototype.mt="get",e}(ce),Z=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GET_ALL,e.prototype.mt="getAll",e}(ce),B=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.EQ,e.prototype.mt="eq",e}(ce),Qt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.NE,e.prototype.mt="ne",e}(ce),Ft=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.LT,e.prototype.mt="lt",e}(ce),St=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.LE,e.prototype.mt="le",e}(ce),it=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GT,e.prototype.mt="gt",e}(ce),K=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GE,e.prototype.mt="ge",e}(ce),Yt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.NOT,e.prototype.mt="not",e}(ce),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ADD,e.prototype.mt="add",e}(ce),Ce=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SUB,e.prototype.mt="sub",e}(ce),Vt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MUL,e.prototype.mt="mul",e}(ce),D=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DIV,e.prototype.mt="div",e}(ce),Bt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MOD,e.prototype.mt="mod",e}(ce),Y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FLOOR,e.prototype.mt="floor",e}(ce),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CEIL,e.prototype.mt="ceil",e}(ce),ye=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ROUND,e.prototype.mt="round",e}(ce),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.APPEND,e.prototype.mt="append",e}(ce),ne=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.PREPEND,e.prototype.mt="prepend",e}(ce),N=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DIFFERENCE,e.prototype.mt="difference",e}(ce),ge=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SET_INSERT,e.prototype.mt="setInsert",e}(ce),we=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SET_UNION,e.prototype.mt="setUnion",e}(ce),be=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SET_INTERSECTION,e.prototype.mt="setIntersection",e}(ce),me=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SET_DIFFERENCE,e.prototype.mt="setDifference",e}(ce),Oe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SLICE,e.prototype.mt="slice",e}(ce),Ee=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SKIP,e.prototype.mt="skip",e}(ce),At=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.LIMIT,e.prototype.mt="limit",e}(ce),tt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GET_FIELD,e.prototype.mt="getField",e}(ce),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.BRACKET,e.prototype.st="(...)",e.prototype.compose=function(t){return[t[0],"(",t[1],")"]},e}(ce),b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CONTAINS,e.prototype.mt="contains",e}(ce),Et=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INSERT_AT,e.prototype.mt="insertAt",e}(ce),Re=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SPLICE_AT,e.prototype.mt="spliceAt",e}(ce),F=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DELETE_AT,e.prototype.mt="deleteAt",e}(ce),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CHANGE_AT,e.prototype.mt="changeAt",e}(ce),ct=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.HAS_FIELDS,e.prototype.mt="hasFields",e}(ce),$e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.WITH_FIELDS,e.prototype.mt="withFields",e}(ce),Ct=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.KEYS,e.prototype.mt="keys",e}(ce),ze=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.VALUES,e.prototype.mt="values",e}(ce),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CHANGES,e.prototype.mt="changes",e}(ce),Wt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.OBJECT,e.prototype.mt="object",e}(ce),Zt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.PLUCK,e.prototype.mt="pluck",e}(ce),zt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.OFFSETS_OF,e.prototype.mt="offsetsOf",e}(ce),Ze=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.WITHOUT,e.prototype.mt="without",e}(ce),Ut=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MERGE,e.prototype.mt="merge",e}(ce),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.BETWEEN,e.prototype.mt="between",e}(ce),he=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.REDUCE,e.prototype.mt="reduce",e}(ce),xt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MAP,e.prototype.mt="map",e}(ce),J=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FOLD,e.prototype.mt="fold",e}(ce),Q=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FILTER,e.prototype.mt="filter",e}(ce),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CONCAT_MAP,e.prototype.mt="concatMap",e}(ce),Xt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ORDER_BY,e.prototype.mt="orderBy",e}(ce),L=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DISTINCT,e.prototype.mt="distinct",e}(ce),w=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.COUNT,e.prototype.mt="count",e}(ce),Ye=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.UNION,e.prototype.mt="union",e}(ce),Gt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.NTH,e.prototype.mt="nth",e}(ce),Be=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TO_JSON_STRING,e.prototype.mt="toJsonString",e}(ce),Lt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MATCH,e.prototype.mt="match",e}(ce),je=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SPLIT,e.prototype.mt="split",e}(ce),Je=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.UPCASE,e.prototype.mt="upcase",e}(ce),U=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DOWNCASE,e.prototype.mt="downcase",e}(ce),Rt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.IS_EMPTY,e.prototype.mt="isEmpty",e}(ce),ot=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GROUP,e.prototype.mt="group",e}(ce),Se=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SUM,e.prototype.mt="sum",e}(ce),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.AVG,e.prototype.mt="avg",e}(ce),Mt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MIN,e.prototype.mt="min",e}(ce),Dt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MAX,e.prototype.mt="max",e}(ce),bt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INNER_JOIN,e.prototype.mt="innerJoin",e}(ce),$t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.OUTER_JOIN,e.prototype.mt="outerJoin",e}(ce),H=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.EQ_JOIN,e.prototype.mt="eqJoin",e}(ce),er=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ZIP,e.prototype.mt="zip",e}(ce),ae=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.RANGE,e.prototype.st="range",e}(ce),v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.COERCE_TO,e.prototype.mt="coerceTo",e}(ce),Qe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.UNGROUP,e.prototype.mt="ungroup",e}(ce),He=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TYPE_OF,e.prototype.mt="typeOf",e}(ce),gt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INFO,e.prototype.mt="info",e}(ce),de=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SAMPLE,e.prototype.mt="sample",e}(ce),Ge=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.UPDATE,e.prototype.mt="update",e}(ce),I=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DELETE,e.prototype.mt="delete",e}(ce),_e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.REPLACE,e.prototype.mt="replace",e}(ce),wt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INSERT,e.prototype.mt="insert",e}(ce),C=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DB_CREATE,e.prototype.st="dbCreate",e}(ce),S=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DB_DROP,e.prototype.st="dbDrop",e}(ce),A=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DB_LIST,e.prototype.st="dbList",e}(ce),Ie=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TABLE_CREATE,e.prototype.mt="tableCreate",e}(ce),Fe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TABLE_DROP,e.prototype.mt="tableDrop",e}(ce),Pe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TABLE_LIST,e.prototype.mt="tableList",e}(ce),ht=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_CREATE,e.prototype.mt="indexCreate",e}(ce),_t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_DROP,e.prototype.mt="indexDrop",e}(ce),dt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_RENAME,e.prototype.mt="indexRename",e}(ce),yt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_LIST,e.prototype.mt="indexList",e}(ce),vt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_STATUS,e.prototype.mt="indexStatus",e}(ce),mt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INDEX_WAIT,e.prototype.mt="indexWait",e}(ce),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CONFIG,e.prototype.mt="config",e}(ce),Te=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.STATUS,e.prototype.mt="status",e}(ce),Xe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.WAIT,e.prototype.mt="wait",e}(ce),fe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.RECONFIGURE,e.prototype.mt="reconfigure",e}(ce),le=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.REBALANCE,e.prototype.mt="rebalance",e}(ce),Ae=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SYNC,e.prototype.mt="sync",e}(ce),nt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GRANT,e.prototype.mt="grant",e}(ce),W=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FUNCALL,e.prototype.st="do",e.prototype.compose=function(t){return t.length>2?["r.do(",ur(t.slice(1)),", ",t[0],")"]:(hr(this.args[1])&&(t[1]=["r(",t[1],")"]),[t[1],".do(",t[0],")"])},e}(ce),k=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DEFAULT,e.prototype.mt="default",e}(ce),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.BRANCH,e.prototype.st="branch",e}(ce),Kt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.OR,e.prototype.mt="or",e}(ce),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.AND,e.prototype.mt="and",e}(ce),G=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FOR_EACH,e.prototype.mt="forEach",e}(ce),z=function(t){function e(t,r){var n,o,i,c,u;for(o=[],n=[],u=0;u<r.length;)n.push(e.nextVarId),o.push(new Ke({},e.nextVarId)),e.nextVarId++,u++;if(void 0===(c=r.apply(null,o)))throw new or.ReqlDriverCompileError("Anonymous function returned `undefined`. Did you forget a `return`?");return i=function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pt,[{}].concat(mr.call(n)),(function(){})),e.__super__.constructor.call(this,t,i,c)}return br(e,t),e.prototype.tt=lr.FUNC,e.nextVarId=0,e.prototype.compose=function(t){var e,r,n,o,i,c;if(!0===cr(t[1]))return[t[1]];for(c="",r=n=0,o=(i=t[0][1]).length;n<o;r=++n)e=i[r],c+=r%2==0?Ke.prototype.compose(e):e;return["function(",c,") { return ",t[1],"; }"]},e}(ce),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ASC,e.prototype.st="asc",e}(ce),P=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DESC,e.prototype.st="desc",e}(ce),It=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.LITERAL,e.prototype.st="literal",e}(ce),pt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.ISO8601,e.prototype.st="ISO8601",e}(ce),qe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TO_ISO8601,e.prototype.mt="toISO8601",e}(ce),q=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.EPOCH_TIME,e.prototype.st="epochTime",e}(ce),Ue=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TO_EPOCH_TIME,e.prototype.mt="toEpochTime",e}(ce),Jt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.NOW,e.prototype.st="now",e}(ce),lt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.IN_TIMEZONE,e.prototype.mt="inTimezone",e}(ce),M=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DURING,e.prototype.mt="during",e}(ce),se=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DATE,e.prototype.mt="date",e}(ce),Le=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TIME_OF_DAY,e.prototype.mt="timeOfDay",e}(ce),De=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TIMEZONE,e.prototype.mt="timezone",e}(ce),tr=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.YEAR,e.prototype.mt="year",e}(ce),Ht=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MONTH,e.prototype.mt="month",e}(ce),O=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DAY,e.prototype.mt="day",e}(ce),R=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DAY_OF_WEEK,e.prototype.mt="dayOfWeek",e}(ce),j=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DAY_OF_YEAR,e.prototype.mt="dayOfYear",e}(ce),ut=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.HOURS,e.prototype.mt="hours",e}(ce),qt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MINUTES,e.prototype.mt="minutes",e}(ce),ve=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SECONDS,e.prototype.mt="seconds",e}(ce),xe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TIME,e.prototype.st="time",e}(ce),X=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GEOJSON,e.prototype.st="geojson",e}(ce),Me=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TO_GEOJSON,e.prototype.mt="toGeojson",e}(ce),te=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.POINT,e.prototype.st="point",e}(ce),kt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.LINE,e.prototype.st="line",e}(ce),ee=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.POLYGON,e.prototype.st="polygon",e}(ce),x=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DISTANCE,e.prototype.mt="distance",e}(ce),Ot=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INTERSECTS,e.prototype.mt="intersects",e}(ce),ft=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.INCLUDES,e.prototype.mt="includes",e}(ce),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.CIRCLE,e.prototype.st="circle",e}(ce),et=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GET_INTERSECTING,e.prototype.mt="getIntersecting",e}(ce),rt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.GET_NEAREST,e.prototype.mt="getNearest",e}(ce),V=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FILL,e.prototype.mt="fill",e}(ce),re=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.POLYGON_SUB,e.prototype.mt="polygonSub",e}(ce),Ve=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.UUID,e.prototype.st="uuid",e}(ce),fr.expr=vr(1,2,(function(t,e){var r;if(null==e&&(e=20),void 0===t)throw new or.ReqlDriverCompileError("Cannot wrap undefined with r.expr().");if(e<=0)throw new or.ReqlDriverCompileError("Nesting depth limit exceeded.");if("number"!=typeof e||isNaN(e))throw new or.ReqlDriverCompileError("Second argument to `r.expr` must be a number or undefined.");return t instanceof Ne?t:"function"==typeof t?new z({},t):t instanceof Date?new pt({},t.toISOString()):t instanceof Buffer?new a(t):Array.isArray(t)?(t=function(){var n,o,i;for(i=[],n=0,o=t.length;n<o;n++)r=t[n],i.push(fr.expr(r,e-1));return i}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pt,[{}].concat(mr.call(t)),(function(){}))):"number"==typeof t?new E(t):"[object Object]"===Object.prototype.toString.call(t)?new Nt(t,e):new E(t)})),fr.js=nr((function(t,e){return new jt(e,t)})),fr.http=nr((function(t,e){return new st(e,t)})),fr.json=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Tt,[{}].concat(mr.call(t)),(function(){}))},fr.error=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(We,[{}].concat(mr.call(t)),(function(){}))},fr.random=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Ne||(r=n,t=e.slice(0,e.length-1)),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(pe,[r].concat(mr.call(t)),(function(){}))},fr.binary=rr((function(t){return new a(t)})),fr.row=new at({}),fr.table=nr((function(t,e){return new ke(e,t)})),fr.db=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(T,[{}].concat(mr.call(t)),(function(){}))},fr.dbCreate=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(C,[{}].concat(mr.call(t)),(function(){}))},fr.dbDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(S,[{}].concat(mr.call(t)),(function(){}))},fr.dbList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(A,[{}].concat(mr.call(t)),(function(){}))},fr.tableCreate=nr((function(t,e){return new Ie(e,t)})),fr.tableDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Fe,[{}].concat(mr.call(t)),(function(){}))},fr.tableList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pe,[{}].concat(mr.call(t)),(function(){}))},fr.grant=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(nt,[{}].concat(mr.call(t)),(function(){}))},fr.do=vr(1,null,(function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(W,[{},ir(t.slice(-1)[0])].concat(mr.call(t.slice(0,-1))),(function(){}))})),fr.branch=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(f,[{}].concat(mr.call(t)),(function(){}))},fr.map=vr(1,null,(function(){var t,e,r;return t=2<=arguments.length?mr.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(xt,[{}].concat(mr.call(t),[ir(e)]),(function(){}))})),fr.group=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ot,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.reduce=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(he,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.count=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(w,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.sum=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Se,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.avg=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(s,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.min=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Mt,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.max=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Dt,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.distinct=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(L,[{}].concat(mr.call(t)),(function(){}))},fr.contains=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(b,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.asc=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(u,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.desc=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(P,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.eq=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(B,[{}].concat(mr.call(t)),(function(){}))},fr.ne=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qt,[{}].concat(mr.call(t)),(function(){}))},fr.lt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ft,[{}].concat(mr.call(t)),(function(){}))},fr.le=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(St,[{}].concat(mr.call(t)),(function(){}))},fr.gt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(it,[{}].concat(mr.call(t)),(function(){}))},fr.ge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(K,[{}].concat(mr.call(t)),(function(){}))},fr.or=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Kt,[{}].concat(mr.call(t)),(function(){}))},fr.and=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(o,[{}].concat(mr.call(t)),(function(){}))},fr.not=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Yt,[{}].concat(mr.call(t)),(function(){}))},fr.add=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(n,[{}].concat(mr.call(t)),(function(){}))},fr.sub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ce,[{}].concat(mr.call(t)),(function(){}))},fr.div=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(D,[{}].concat(mr.call(t)),(function(){}))},fr.mul=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Vt,[{}].concat(mr.call(t)),(function(){}))},fr.mod=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Bt,[{}].concat(mr.call(t)),(function(){}))},fr.floor=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Y,[{}].concat(mr.call(t)),(function(){}))},fr.ceil=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(h,[{}].concat(mr.call(t)),(function(){}))},fr.round=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ye,[{}].concat(mr.call(t)),(function(){}))},fr.typeOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(He,[{}].concat(mr.call(t)),(function(){}))},fr.info=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(gt,[{}].concat(mr.call(t)),(function(){}))},fr.literal=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(It,[{}].concat(mr.call(t)),(function(){}))},fr.ISO8601=nr((function(t,e){return new pt(e,t)})),fr.epochTime=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(q,[{}].concat(mr.call(t)),(function(){}))},fr.now=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Jt,[{}].concat(mr.call(t)),(function(){}))},fr.time=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(xe,[{}].concat(mr.call(t)),(function(){}))},fr.monday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MONDAY,e.prototype.st="monday",e}(ie)),fr.tuesday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.TUESDAY,e.prototype.st="tuesday",e}(ie)),fr.wednesday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.WEDNESDAY,e.prototype.st="wednesday",e}(ie)),fr.thursday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.THURSDAY,e.prototype.st="thursday",e}(ie)),fr.friday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FRIDAY,e.prototype.st="friday",e}(ie)),fr.saturday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SATURDAY,e.prototype.st="saturday",e}(ie)),fr.sunday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SUNDAY,e.prototype.st="sunday",e}(ie)),fr.january=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.JANUARY,e.prototype.st="january",e}(ie)),fr.february=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.FEBRUARY,e.prototype.st="february",e}(ie)),fr.march=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MARCH,e.prototype.st="march",e}(ie)),fr.april=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.APRIL,e.prototype.st="april",e}(ie)),fr.may=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MAY,e.prototype.st="may",e}(ie)),fr.june=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.JUNE,e.prototype.st="june",e}(ie)),fr.july=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.JULY,e.prototype.st="july",e}(ie)),fr.august=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.AUGUST,e.prototype.st="august",e}(ie)),fr.september=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.SEPTEMBER,e.prototype.st="september",e}(ie)),fr.october=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.OCTOBER,e.prototype.st="october",e}(ie)),fr.november=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.NOVEMBER,e.prototype.st="november",e}(ie)),fr.december=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.DECEMBER,e.prototype.st="december",e}(ie)),fr.minval=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MINVAL,e.prototype.st="minval",e}(ie)),fr.maxval=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return br(e,t),e.prototype.tt=lr.MAXVAL,e.prototype.st="maxval",e}(ie)),fr.object=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Wt,[{}].concat(mr.call(t)),(function(){}))},fr.args=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(c,[{}].concat(mr.call(t)),(function(){}))},fr.geojson=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(X,[{}].concat(mr.call(t)),(function(){}))},fr.point=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(te,[{}].concat(mr.call(t)),(function(){}))},fr.line=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(kt,[{}].concat(mr.call(t)),(function(){}))},fr.polygon=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ee,[{}].concat(mr.call(t)),(function(){}))},fr.intersects=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ot,[{}].concat(mr.call(t)),(function(){}))},fr.distance=nr((function(t,e,r){return new x(r,t,e)})),fr.circle=nr((function(t,e,r){return new d(r,t,e)})),fr.uuid=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ve,[{}].concat(mr.call(t)),(function(){}))},fr.range=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ae,[{}].concat(mr.call(t)),(function(){}))},fr.union=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ye,[{}].concat(mr.call(t)),(function(){}))},t.exports=fr},function(t,e){t.exports=function(t,e){if("undefined"==typeof Blob||!(t instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof e)throw new Error("second argument must be a function");var r=new FileReader;r.addEventListener("loadend",(function t(n){r.removeEventListener("loadend",t,!1),n.error?e(n.error):e(null,Buffer.from(r.result))}),!1),r.readAsArrayBuffer(t)}},function(t,e,r){var n;
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(o){var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=10;function u(){this._events={},this._conf&&s.call(this,this._conf)}function s(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function p(t){this._events={},this.newListener=!1,s.call(this,t)}function a(t,e,r,n){if(!r)return[];var o,i,c,u,s,p,l,f=[],h=e.length,_=e[n],y=e[n+1];if(n===h&&r._listeners){if("function"==typeof r._listeners)return t&&t.push(r._listeners),[r];for(o=0,i=r._listeners.length;o<i;o++)t&&t.push(r._listeners[o]);return[r]}if("*"===_||"**"===_||r[_]){if("*"===_){for(c in r)"_listeners"!==c&&r.hasOwnProperty(c)&&(f=f.concat(a(t,e,r[c],n+1)));return f}if("**"===_){for(c in(l=n+1===h||n+2===h&&"*"===y)&&r._listeners&&(f=f.concat(a(t,e,r,h))),r)"_listeners"!==c&&r.hasOwnProperty(c)&&("*"===c||"**"===c?(r[c]._listeners&&!l&&(f=f.concat(a(t,e,r[c],h))),f=f.concat(a(t,e,r[c],n))):f=c===y?f.concat(a(t,e,r[c],n+2)):f.concat(a(t,e,r[c],n)));return f}f=f.concat(a(t,e,r[_],n+1))}if((u=r["*"])&&a(t,e,u,n+1),s=r["**"])if(n<h)for(c in s._listeners&&a(t,e,s,h),s)"_listeners"!==c&&s.hasOwnProperty(c)&&(c===y?a(t,e,s[c],n+2):c===_?a(t,e,s[c],n+1):((p={})[c]=s[c],a(t,e,{"**":p},n+1)));else s._listeners?a(t,e,s,h):s["*"]&&s["*"]._listeners&&a(t,e,s["*"],h);return f}function l(t,e){for(var r=0,n=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;r+1<n;r++)if("**"===t[r]&&"**"===t[r+1])return;for(var o=this.listenerTree,u=t.shift();u;){if(o[u]||(o[u]={}),o=o[u],0===t.length){if(o._listeners){if("function"==typeof o._listeners)o._listeners=[o._listeners,e];else if(i(o._listeners)&&(o._listeners.push(e),!o._listeners.warned)){var s=c;void 0!==this._events.maxListeners&&(s=this._events.maxListeners),s>0&&o._listeners.length>s&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace())}}else o._listeners=e;return!0}u=t.shift()}return!0}p.prototype.delimiter=".",p.prototype.setMaxListeners=function(t){this._events||u.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},p.prototype.event="",p.prototype.once=function(t,e){return this.many(t,1,e),this},p.prototype.many=function(t,e,r){var n=this;if("function"!=typeof r)throw new Error("many only accepts instances of Function");function o(){0==--e&&n.off(t,o),r.apply(this,arguments)}return o._origin=r,this.on(t,o),n},p.prototype.emit=function(){this._events||u.call(this);var t,e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];for(o=0,r=this._all.length;o<r;o++)this.event=e,this._all[o].apply(this,n)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){t=[];var i="string"==typeof e?e.split(this.delimiter):e.slice();a.call(this,t,i,this.listenerTree,0)}else t=this._events[e];if("function"==typeof t){if(this.event=e,1===arguments.length)t.call(this);else if(arguments.length>1)switch(arguments.length){case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];t.apply(this,n)}return!0}if(t){for(r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];var c=t.slice();for(o=0,r=c.length;o<r;o++)this.event=e,c[o].apply(this,n);return c.length>0||!!this._all}return!!this._all},p.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");if(this._events||u.call(this),this.emit("newListener",t,e),this.wildcard)return l.call(this,t,e),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],e];else if(i(this._events[t])&&(this._events[t].push(e),!this._events[t].warned)){var r=c;void 0!==this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=e;return this},p.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},p.prototype.addListener=p.prototype.on,p.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var r,n=[];if(this.wildcard){var o="string"==typeof t?t.split(this.delimiter):t.slice();n=a.call(this,null,o,this.listenerTree,0)}else{if(!this._events[t])return this;r=this._events[t],n.push({_listeners:r})}for(var c=0;c<n.length;c++){var u=n[c];if(r=u._listeners,i(r)){for(var s=-1,p=0,l=r.length;p<l;p++)if(r[p]===e||r[p].listener&&r[p].listener===e||r[p]._origin&&r[p]._origin===e){s=p;break}if(s<0)continue;return this.wildcard?u._listeners.splice(s,1):this._events[t].splice(s,1),0===r.length&&(this.wildcard?delete u._listeners:delete this._events[t]),this}(r===e||r.listener&&r.listener===e||r._origin&&r._origin===e)&&(this.wildcard?delete u._listeners:delete this._events[t])}return this},p.prototype.offAny=function(t){var e,r=0,n=0;if(t&&this._all&&this._all.length>0){for(r=0,n=(e=this._all).length;r<n;r++)if(t===e[r])return e.splice(r,1),this}else this._all=[];return this},p.prototype.removeListener=p.prototype.off,p.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||u.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),r=a.call(this,null,e,this.listenerTree,0),n=0;n<r.length;n++){var o=r[n];o._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},p.prototype.listeners=function(t){if(this.wildcard){var e=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return a.call(this,e,r,this.listenerTree,0),e}return this._events||u.call(this),this._events[t]||(this._events[t]=[]),i(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},p.prototype.listenersAny=function(){return this._all?this._all:[]},void 0===(n=function(){return p}.call(e,r,e,t))||(t.exports=n)}()},function(t,e,r){t.exports=r(17)},function(t,e,r){"use strict";r.r(e),r.d(e,"connect",(function(){return a})),r.d(e,"default",(function(){return l}));var n=r(3),o=r.n(n);r.d(e,"Promise",(function(){return o.a}));var i=r(7),c=r.n(i);r.d(e,"rethinkdb",(function(){return c.a}));var u=r(4),s=r.n(u);r.d(e,"protodef",(function(){return s.a}));var p=r(8);function a(t){var e=t.host,r=t.port,n=t.path,i=t.secure,u=t.wsProtocols,s=t.wsBinaryType,a=t.db,l=t.simulatedLatencyMs,f=t.user,h=t.password,_=t.waitForPacket;Object(p.configureTcpPolyfill)({path:n,secure:i,wsProtocols:u,wsBinaryType:s,simulatedLatencyMs:l,waitForPacket:_});var y=process.browser;process.browser=!1;var d=f,v=h;void 0===d&&(d="default"),void 0===v&&(v="");var m={host:e,port:r,db:a,user:d,password:v},g=o.a.promisify(c.a.connect)(m);return process.browser=y,g.then((function(t){return Object(p.setIsConnected)(),t}))}var l={rethinkdb:c.a,protodef:s.a,Promise:o.a,connect:a}},function(t,e,r){"use strict";t.exports=function(){var e,n=function(){return new a("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},o=function(){return new R.PromiseInspection(this._target())},i=function(t){return R.reject(new a(t))},c=r(0);e=c.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},c.notEnumerableProp(R,"_getDomain",e);var u={},s=r(2),p=r(1),a=R.TypeError=p.TypeError;R.RangeError=p.RangeError,R.CancellationError=p.CancellationError,R.TimeoutError=p.TimeoutError,R.OperationalError=p.OperationalError,R.RejectionError=p.OperationalError,R.AggregateError=p.AggregateError;var l=function(){},f={},h={e:null},_=r(21)(R,l),y=r(22)(R,l,_,i),d=r(23)(),v=r(24)(R,d),m=r(25)(R,d,v),g=r(26)(h),b=r(10),w=b._nodebackForPromise,E=c.errorObj,O=c.tryCatch;function R(t){if("function"!=typeof t)throw new a("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==R)throw new a("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,t!==l&&this._resolveFromResolver(t)}function j(t){var e=new R(l);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._progressHandler0=t,e._promise0=t,e._receiver0=t,e._settledValue=t}return R.prototype.toString=function(){return"[object Promise]"},R.prototype.caught=R.prototype.catch=function(t){var e=arguments.length;if(e>1){var r,n=new Array(e-1),o=0;for(r=0;r<e-1;++r){var i=arguments[r];if("function"!=typeof i)return R.reject(new a("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));n[o++]=i}n.length=o,t=arguments[r];var c=new g(n,t,this);return this._then(void 0,c.doFilter,void 0,c,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},R.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},R.prototype.then=function(t,e,r){if(v()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+c.classString(t);arguments.length>1&&(n+=", "+c.classString(e)),this._warn(n)}return this._then(t,e,r,void 0,void 0)},R.prototype.done=function(t,e,r){this._then(t,e,r,void 0,void 0)._setIsFinal()},R.prototype.spread=function(t,e){return this.all()._then(t,e,void 0,f,void 0)},R.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},R.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},R.prototype.all=function(){return new y(this).promise()},R.prototype.error=function(t){return this.caught(c.originatesFromRejection,t)},R.getNewLibraryCopy=t.exports,R.is=function(t){return t instanceof R},R.fromNode=function(t){var e=new R(l),r=O(t)(w(e));return r===E&&e._rejectCallback(r.e,!0,!0),e},R.all=function(t){return new y(t).promise()},R.defer=R.pending=function(){var t=new R(l);return new b(t)},R.cast=function(t){var e=_(t);if(!(e instanceof R)){var r=e;(e=new R(l))._fulfillUnchecked(r)}return e},R.resolve=R.fulfilled=R.cast,R.reject=R.rejected=function(t){var e=new R(l);return e._captureStackTrace(),e._rejectCallback(t,!0),e},R.setScheduler=function(t){if("function"!=typeof t)throw new a("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var e=s._schedule;return s._schedule=t,e},R.prototype._then=function(t,r,n,o,i){var c=void 0!==i,u=c?i:new R(l);c||(u._propagateFrom(this,5),u._captureStackTrace());var p=this._target();p!==this&&(void 0===o&&(o=this._boundTo),c||u._setIsMigrated());var a=p._addCallbacks(t,r,n,u,o,e());return p._isResolved()&&!p._isSettlePromisesQueued()&&s.invoke(p._settlePromiseAtPostResolution,p,a),u},R.prototype._settlePromiseAtPostResolution=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(t)},R.prototype._length=function(){return 131071&this._bitField},R.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},R.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},R.prototype._setLength=function(t){this._bitField=-131072&this._bitField|131071&t},R.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},R.prototype._setRejected=function(){this._bitField=134217728|this._bitField},R.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},R.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},R.prototype._isFinal=function(){return(33554432&this._bitField)>0},R.prototype._cancellable=function(){return(67108864&this._bitField)>0},R.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},R.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},R.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},R.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},R.prototype._isMigrated=function(){return(4194304&this._bitField)>0},R.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[5*t-5+4];if(e!==u)return void 0===e&&this._isBound()?this._boundValue():e},R.prototype._promiseAt=function(t){return 0===t?this._promise0:this[5*t-5+3]},R.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[5*t-5+0]},R.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[5*t-5+1]},R.prototype._boundValue=function(){var t=this._boundTo;return void 0!==t&&t instanceof R?t.isFulfilled()?t.value():void 0:t},R.prototype._migrateCallbacks=function(t,e){var r=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),o=t._progressHandlerAt(e),i=t._promiseAt(e),c=t._receiverAt(e);i instanceof R&&i._setIsMigrated(),void 0===c&&(c=u),this._addCallbacks(r,n,o,i,c,null)},R.prototype._addCallbacks=function(t,e,r,n,o,i){var c=this._length();if(c>=131066&&(c=0,this._setLength(0)),0===c)this._promise0=n,void 0!==o&&(this._receiver0=o),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===i?t:i.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:i.bind(e)),"function"==typeof r&&(this._progressHandler0=null===i?r:i.bind(r));else{var u=5*c-5;this[u+3]=n,this[u+4]=o,"function"==typeof t&&(this[u+0]=null===i?t:i.bind(t)),"function"==typeof e&&(this[u+1]=null===i?e:i.bind(e)),"function"==typeof r&&(this[u+2]=null===i?r:i.bind(r))}return this._setLength(c+1),c},R.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=131066&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=5*r-5;this[n+3]=e,this[n+4]=t}this._setLength(r+1)},R.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},R.prototype._resolveCallback=function(t,e){if(!this._isFollowingOrFulfilledOrRejected()){if(t===this)return this._rejectCallback(n(),!1,!0);var r=_(t,this);if(!(r instanceof R))return this._fulfill(t);var o=1|(e?4:0);this._propagateFrom(r,o);var i=r._target();if(i._isPending()){for(var c=this._length(),u=0;u<c;++u)i._migrateCallbacks(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else i._isFulfilled()?this._fulfillUnchecked(i._value()):this._rejectUnchecked(i._reason(),i._getCarriedStackTrace())}},R.prototype._rejectCallback=function(t,e,r){r||c.markAsOriginatingFromRejection(t);var n=c.ensureErrorObject(t),o=n===t;this._attachExtraTrace(n,!!e&&o),this._reject(t,o?void 0:n)},R.prototype._resolveFromResolver=function(t){var e=this;this._captureStackTrace(),this._pushContext();var r=!0,n=O(t)((function(t){null!==e&&(e._resolveCallback(t),e=null)}),(function(t){null!==e&&(e._rejectCallback(t,r),e=null)}));r=!1,this._popContext(),void 0!==n&&n===E&&null!==e&&(e._rejectCallback(n.e,!0,!0),e=null)},R.prototype._settlePromiseFromHandler=function(t,e,r,o){var i;if(!o._isRejected())if(o._pushContext(),i=e!==f||this._isRejected()?O(t).call(e,r):O(t).apply(this._boundValue(),r),o._popContext(),i===E||i===o||i===h){var c=i===o?n():i.e;o._rejectCallback(c,!1,!0)}else o._resolveCallback(i)},R.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},R.prototype._followee=function(){return this._rejectionHandler0},R.prototype._setFollowee=function(t){this._rejectionHandler0=t},R.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},R.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&t._isBound()&&this._setBoundTo(t._boundTo)},R.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},R.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},R.prototype._settlePromiseAt=function(t){var e=this._promiseAt(t),r=e instanceof R;if(r&&e._isMigrated())return e._unsetIsMigrated(),s.invoke(this._settlePromiseAt,this,t);var n=this._isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,i=this._settledValue,c=this._receiverAt(t);this._clearCallbackDataAtIndex(t),"function"==typeof n?r?this._settlePromiseFromHandler(n,c,i,e):n.call(c,i,e):c instanceof y?c._isResolved()||(this._isFulfilled()?c._promiseFulfilled(i,e):c._promiseRejected(i,e)):r&&(this._isFulfilled()?e._fulfill(i):e._reject(i,o)),t>=4&&4==(31&t)&&s.invokeLater(this._setLength,this,0)},R.prototype._clearCallbackDataAtIndex=function(t){if(0===t)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var e=5*t-5;this[e+3]=this[e+4]=this[e+0]=this[e+1]=this[e+2]=void 0}},R.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},R.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},R.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},R.prototype._queueSettlePromises=function(){s.settlePromises(this),this._setSettlePromisesQueued()},R.prototype._fulfillUnchecked=function(t){if(t===this){var e=n();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._setFulfilled(),this._settledValue=t,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},R.prototype._rejectUncheckedCheckError=function(t){var e=c.ensureErrorObject(t);this._rejectUnchecked(t,e===t?void 0:e)},R.prototype._rejectUnchecked=function(t,e){if(t===this){var r=n();return this._attachExtraTrace(r),this._rejectUnchecked(r)}this._setRejected(),this._settledValue=t,this._cleanValues(),this._isFinal()?s.throwLater((function(t){throw"stack"in t&&s.invokeFirst(d.unhandledRejection,void 0,t),t}),void 0===e?t:e):(void 0!==e&&e!==t&&this._setCarriedStackTrace(e),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled())},R.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var t=this._length(),e=0;e<t;e++)this._settlePromiseAt(e)},c.notEnumerableProp(R,"_makeSelfResolutionError",n),r(27)(R,y),r(28)(R,l,_,i),r(29)(R,l,_),r(30)(R,h,_),r(31)(R),r(32)(R),r(33)(R,y,_,l),R.version="2.11.0",R.Promise=R,r(34)(R,y,i,_,l),r(35)(R),r(36)(R,i,_,m),r(37)(R,i,l,_),r(38)(R),r(39)(R),r(40)(R,y,_,i),r(41)(R,l,_,i),r(42)(R,y,i,_,l),r(43)(R,y),r(44)(R,y,i),r(45)(R,l),r(46)(R),r(47)(R,l),r(48)(R,l),r(49)(R,l),c.toFastProperties(R),c.toFastProperties(R.prototype),j({a:1}),j({b:2}),j({c:3}),j(1),j((function(){})),j(void 0),j(!1),j(new R(l)),d.setBounds(s.firstLineError,c.lastLineError),R}},function(t,e,r){"use strict";var n,o=r(0);if(o.isNode&&"undefined"==typeof MutationObserver){var i=global.setImmediate,c=process.nextTick;n=o.isRecentNode?function(t){i.call(global,t)}:function(t){c.call(process,t)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?n="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}:(n=function(t){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}).isStatic=!0;t.exports=n},function(t,e,r){"use strict";function n(t){this._capacity=t,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(t){return this._capacity<t},n.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},n.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var r=(this._front-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},n.prototype.unshift=function(t,e,r){this._unshiftOne(r),this._unshiftOne(e),this._unshiftOne(t)},n.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=r,this._length=n},n.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},t.exports=n},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=n.errorObj,i=n.isObject;function c(t){return t.then}var u={}.hasOwnProperty;return function(r,s){if(i(r)){if(r instanceof t)return r;if(function(t){return u.call(t,"_promise0")}(r)){var p=new t(e);return r._then(p._fulfillUnchecked,p._rejectUncheckedCheckError,p._progressUnchecked,p,null),p}var a=n.tryCatch(c)(r);if(a===o){s&&s._pushContext();p=t.reject(a.e);return s&&s._popContext(),p}if("function"==typeof a)return function(r,i,c){var u=new t(e),s=u;c&&c._pushContext();u._captureStackTrace(),c&&c._popContext();var p=!0,a=n.tryCatch(i).call(r,(function(t){if(!u)return;u._resolveCallback(t),u=null}),(function(t){if(!u)return;u._rejectCallback(t,p,!0),u=null}),(function(t){if(!u)return;"function"==typeof u._progress&&u._progress(t)}));p=!1,u&&a===o&&(u._rejectCallback(a.e,!0,!0),u=null);return s}(r,a,s)}return r}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0).isArray;function c(r){var n,o=this._promise=new t(e);r instanceof t&&(n=r,o._propagateFrom(n,5)),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return c.prototype.length=function(){return this._length},c.prototype.promise=function(){return this._promise},c.prototype._init=function e(r,c){var u=n(this._values,this._promise);if(u instanceof t){if(u=u._target(),this._values=u,!u._isFulfilled())return u._isPending()?void u._then(e,this._reject,void 0,this,c):void this._reject(u._reason());if(u=u._value(),!i(u)){var s=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(s)}}else if(!i(u))return void this._promise._reject(o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0!==u.length){var p=this.getActualLength(u.length);this._length=p,this._values=this.shouldCopyValues()?new Array(p):this._values;for(var a=this._promise,l=0;l<p;++l){var f=this._isResolved(),h=n(u[l],a);h instanceof t?(h=h._target(),f?h._ignoreRejections():h._isPending()?h._proxyPromiseArray(this,l):h._isFulfilled()?this._promiseFulfilled(h._value(),l):this._promiseRejected(h._reason(),l)):f||this._promiseFulfilled(h,l)}}else-5===c?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{}}}(c))},c.prototype._isResolved=function(){return null===this._values},c.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},c.prototype.__hardReject__=c.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1,!0)},c.prototype._promiseProgressed=function(t,e){this._promise._progress({index:e,value:t})},c.prototype._promiseFulfilled=function(t,e){this._values[e]=t,++this._totalResolved>=this._length&&this._resolve(this._values)},c.prototype._promiseRejected=function(t,e){this._totalResolved++,this._reject(t)},c.prototype.shouldCopyValues=function(){return!0},c.prototype.getActualLength=function(t){return t},c}},function(t,e,r){"use strict";t.exports=function(){var t,e=r(2),n=r(0),o=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,i=null,c=null,u=!1;function s(t){this._parent=t;var e=this._length=1+(void 0===t?0:t._length);y(this,s),e>32&&this.uncycle()}function p(t){for(var e=[],r=0;r<t.length;++r){var n=t[r],o=i.test(n)||"    (No stack trace)"===n,c=o&&l(n);o&&!c&&(u&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function a(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}n.inherits(s,Error),s.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],r={},n=0,o=this;void 0!==o;++n)e.push(o),o=o._parent;for(n=(t=this._length=n)-1;n>=0;--n){var i=e[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<t;++n){var c=r[e[n].stack];if(void 0!==c&&c!==n){c>0&&(e[c-1]._parent=void 0,e[c-1]._length=1),e[n]._parent=void 0,e[n]._length=1;var u=n>0?e[n-1]:this;c<t-1?(u._parent=e[c+1],u._parent.uncycle(),u._length=u._parent._length+1):(u._parent=void 0,u._length=1);for(var s=u._length+1,p=n-2;p>=0;--p)e[p]._length=s,s++;return}}}},s.prototype.parent=function(){return this._parent},s.prototype.hasParent=function(){return void 0!==this._parent},s.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=s.parseStackAndMessage(t),r=e.message,o=[e.stack],i=this;void 0!==i;)o.push(p(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],r=1;r<t.length;++r){for(var n=t[r],o=e.length-1,i=e[o],c=-1,u=n.length-1;u>=0;--u)if(n[u]===i){c=u;break}for(u=c;u>=0;--u){var s=n[u];if(e[o]!==s)break;e.pop(),o--}e=n}}(o),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(o),n.notEnumerableProp(t,"stack",function(t,e){for(var r=0;r<e.length-1;++r)e[r].push("From previous event:"),e[r]=e[r].join("\n");r<e.length&&(e[r]=e[r].join("\n"));return t+"\n"+e.join("\n")}(r,o)),n.notEnumerableProp(t,"__stackCleaned__",!0)}},s.parseStackAndMessage=function(t){var e=t.stack;return{message:t.toString(),stack:p(e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),r=0;r<e.length;++r){var n=e[r];if("    (No stack trace)"===n||i.test(n))break}return r>0&&(e=e.slice(r)),e}(t):["    (No stack trace)"])}},s.formatAndLogError=function(e,r){if("undefined"!=typeof console){var n;if("object"==typeof e||"function"==typeof e){var o=e.stack;n=r+c(o,e)}else n=r+String(e);"function"==typeof t?t(n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}},s.unhandledRejection=function(t){s.formatAndLogError(t,"^--- With additional stack trace: ")},s.isSupported=function(){return"function"==typeof y},s.fireRejectionEvent=function(t,r,n,o){var i=!1;try{"function"==typeof r&&(i=!0,"rejectionHandled"===t?r(o):r(n,o))}catch(t){e.throwLater(t)}var c=!1;try{c=d(t,n,o)}catch(t){c=!0,e.throwLater(t)}var u=!1;if(_)try{u=_(t.toLowerCase(),{reason:n,promise:o})}catch(t){u=!0,e.throwLater(t)}c||i||u||"unhandledRejection"!==t||s.formatAndLogError(n,"Unhandled rejection ")};var l=function(){return!1},f=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function h(t){var e=t.match(f);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}s.setBounds=function(t,e){if(s.isSupported()){for(var r,n,i=t.stack.split("\n"),c=e.stack.split("\n"),u=-1,p=-1,a=0;a<i.length;++a){if(f=h(i[a])){r=f.fileName,u=f.line;break}}for(a=0;a<c.length;++a){var f;if(f=h(c[a])){n=f.fileName,p=f.line;break}}u<0||p<0||!r||!n||r!==n||u>=p||(l=function(t){if(o.test(t))return!0;var e=h(t);return!!(e&&e.fileName===r&&u<=e.line&&e.line<=p)})}};var _,y=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():a(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,i=t,c=e;var r=Error.captureStackTrace;return l=function(t){return o.test(t)},function(t,e){Error.stackTraceLimit=Error.stackTraceLimit+6,r(t,e),Error.stackTraceLimit=Error.stackTraceLimit-6}}var n,s=new Error;if("string"==typeof s.stack&&s.stack.split("\n")[0].indexOf("stackDetection@")>=0)return i=/@/,c=e,u=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){n="stack"in t}return"stack"in s||!n||"number"!=typeof Error.stackTraceLimit?(c=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?a(e):e.toString()},null):(i=t,c=e,function(t){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}(),d=function(){if(n.isNode)return function(t,e,r){return"rejectionHandled"===t?process.emit(t,r):process.emit(t,e,r)};var t=!1,e=!0;try{var r=new self.CustomEvent("test");t=r instanceof CustomEvent}catch(t){}if(!t)try{var o=document.createEvent("CustomEvent");o.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(o)}catch(t){e=!1}e&&(_=function(e,r){var n;return t?n=new self.CustomEvent(e,{detail:r,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,r),!!n&&!self.dispatchEvent(n)});var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),function(t,e,r){var n=i[t],o=self[n];return!!o&&("rejectionHandled"===t?o.call(self,r):o.call(self,e,r),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(t=function(t){console.warn(t)},n.isNode&&process.stderr.isTTY?t=function(t){process.stderr.write("[31m"+t+"[39m\n")}:n.isNode||"string"!=typeof(new Error).stack||(t=function(t){console.warn("%c"+t,"color: red")})),s}},function(t,e,r){"use strict";t.exports=function(t,e){var n,o,i=t._getDomain,c=r(2),u=r(1).Warning,s=r(0),p=s.canAttachTrace,a=s.isNode&&(!!process.env.BLUEBIRD_DEBUG||!1);return s.isNode&&0==process.env.BLUEBIRD_DEBUG&&(a=!1),a&&c.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),c.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){e.fireRejectionEvent("rejectionHandled",n,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),e.fireRejectionEvent("unhandledRejection",o,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return a&&(this._trace=new e(this._peekContext())),this},t.prototype._attachExtraTrace=function(t,r){if(a&&p(t)){var n=this._trace;if(void 0!==n&&r&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var o=e.parseStackAndMessage(t);s.notEnumerableProp(t,"stack",o.message+"\n"+o.stack.join("\n")),s.notEnumerableProp(t,"__stackCleaned__",!0)}}},t.prototype._warn=function(t){var r=new u(t),n=this._peekContext();if(n)n.attachExtraTrace(r);else{var o=e.parseStackAndMessage(r);r.stack=o.message+"\n"+o.stack.join("\n")}e.formatAndLogError(r,"")},t.onPossiblyUnhandledRejection=function(t){var e=i();o="function"==typeof t?null===e?t:e.bind(t):void 0},t.onUnhandledRejectionHandled=function(t){var e=i();n="function"==typeof t?null===e?t:e.bind(t):void 0},t.longStackTraces=function(){if(c.haveItemsQueued()&&!1===a)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(a=e.isSupported())&&c.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return a&&e.isSupported()},e.isSupported()||(t.longStackTraces=function(){},a=!1),function(){return a}}},function(t,e,r){"use strict";t.exports=function(t,e,r){var n=[];function o(){this._trace=new e(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return o.prototype._pushContext=function(){r()&&void 0!==this._trace&&n.push(this._trace)},o.prototype._popContext=function(){r()&&void 0!==this._trace&&n.pop()},t.prototype._peekContext=i,t.prototype._pushContext=o.prototype._pushContext,t.prototype._popContext=o.prototype._popContext,function(){if(r())return new o}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(0),n=r(1),o=e.tryCatch,i=e.errorObj,c=r(5).keys,u=n.TypeError;function s(t,e,r){this._instances=t,this._callback=e,this._promise=r}function p(t,e){var r={},n=o(t).call(r,e);return n===i?n:c(r).length?(i.e=new u("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),i):n}return s.prototype.doFilter=function(e){for(var r=this._callback,n=this._promise._boundValue(),c=0,u=this._instances.length;c<u;++c){var s=this._instances[c],a=s===Error||null!=s&&s.prototype instanceof Error;if(a&&e instanceof s)return(l=o(r).call(n,e))===i?(t.e=l.e,t):l;if("function"==typeof s&&!a){var l,f=p(s,e);if(f===i){e=i.e;break}if(f)return(l=o(r).call(n,e))===i?(t.e=l.e,t):l}}return t.e=e,t},s}},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=r(2),i=n.tryCatch,c=n.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},t.prototype._doProgressWith=function(e){var r=e.value,o=e.handler,u=e.promise,s=e.receiver,p=i(o).call(s,r);if(p===c){if(null!=p.e&&"StopProgressPropagation"!==p.e.name){var a=n.canAttachTrace(p.e)?p.e:new Error(n.toString(p.e));u._attachExtraTrace(a),u._progress(p.e)}}else p instanceof t?p._then(u._progress,null,null,u,void 0):u._progress(p)},t.prototype._progressUnchecked=function(r){for(var n=this._length(),i=this._progress,c=0;c<n;c++){var u=this._progressHandlerAt(c),s=this._promiseAt(c);if(s instanceof t)"function"==typeof u?o.invoke(this._doProgressWith,this,{handler:u,promise:s,receiver:this._receiverAt(c),value:r}):o.invoke(i,s,r);else{var p=this._receiverAt(c);"function"==typeof u?u.call(p,r,s):p instanceof e&&!p._isResolved()&&p._promiseProgressed(r,s)}}}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),c=i.tryCatch;t.method=function(r){if("function"!=typeof r)throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var n=new t(e);n._captureStackTrace(),n._pushContext();var o=c(r).apply(this,arguments);return n._popContext(),n._resolveFromSyncValue(o),n}},t.attempt=t.try=function(r,n,u){if("function"!=typeof r)return o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s=new t(e);s._captureStackTrace(),s._pushContext();var p=i.isArray(n)?c(r).apply(u,n):c(r).call(u,n);return s._popContext(),s._resolveFromSyncValue(p),s},t.prototype._resolveFromSyncValue=function(t){t===i.errorObj?this._rejectCallback(t.e,!1,!0):this._resolveCallback(t,!0)}}},function(t,e,r){"use strict";t.exports=function(t,e,r){var n=function(t,e){this._reject(e)},o=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(n,n,null,this,t)},i=function(t,e){this._isPending()&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(n){var u=r(n),s=new t(e);s._propagateFrom(this,1);var p=this._target();if(s._setBoundTo(u),u instanceof t){var a={promiseRejectionQueued:!1,promise:s,target:p,bindingPromise:u};p._then(e,o,s._progress,s,a),u._then(i,c,s._progress,s,a)}else s._resolveCallback(p);return s},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=131072|this._bitField,this._boundTo=t):this._bitField=-131073&this._bitField},t.prototype._isBound=function(){return 131072==(131072&this._bitField)},t.bind=function(n,o){var i=r(n),c=new t(e);return c._setBoundTo(i),i instanceof t?i._then((function(){c._resolveCallback(o)}),c._reject,c._progress,c,null):c._resolveCallback(o),c}}},function(t,e,r){"use strict";t.exports=function(t,e,n){var o=r(0),i=o.isPrimitive,c=o.thrower;function u(){return this}function s(){throw this}function p(t,e,r){var n,o;return n=i(e)?r?(o=e,function(){return o}):function(t){return function(){throw t}}(e):r?u:s,t._then(n,c,void 0,e,void 0)}function a(r){var o=this.promise,i=this.handler,c=o._isBound()?i.call(o._boundValue()):i();if(void 0!==c){var u=n(c,o);if(u instanceof t)return p(u=u._target(),r,o.isFulfilled())}return o.isRejected()?(e.e=r,e):r}function l(e){var r=this.promise,o=this.handler,i=r._isBound()?o.call(r._boundValue(),e):o(e);if(void 0!==i){var c=n(i,r);if(c instanceof t)return p(c=c._target(),e,!0)}return e}t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?a:l,e?a:void 0,void 0,r,void 0)},t.prototype.lastly=t.prototype.finally=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},function(t,e,r){"use strict";var n=r(0).isPrimitive;t.exports=function(t){var e=function(){return this},r=function(){throw this},o=function(){},i=function(){throw void 0},c=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype.return=t.prototype.thenReturn=function(r){return void 0===r?this.then(o):n(r)?this._then(c(r,2),void 0,void 0,void 0,void 0):(r instanceof t&&r._ignoreRejections(),this._then(e,void 0,void 0,r,void 0))},t.prototype.throw=t.prototype.thenThrow=function(t){return void 0===t?this.then(i):n(t)?this._then(c(t,1),void 0,void 0,void 0,void 0):this._then(r,void 0,void 0,t,void 0)}}},function(t,e,r){"use strict";t.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValue=t._settledValue):(this._bitField=0,this._settledValue=void 0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},e.prototype.isFulfilled=t.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype._isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype._isPending=function(){return 0==(402653184&this._bitField)},e.prototype.isResolved=t.prototype._isResolved=function(){return(402653184&this._bitField)>0},t.prototype.isPending=function(){return this._target()._isPending()},t.prototype.isRejected=function(){return this._target()._isRejected()},t.prototype.isFulfilled=function(){return this._target()._isFulfilled()},t.prototype.isResolved=function(){return this._target()._isResolved()},t.prototype._value=function(){return this._settledValue},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},t.prototype.value=function(){var t=this._target();if(!t.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return t._settledValue},t.prototype.reason=function(){var t=this._target();if(!t.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return t._unsetRejectionIsUnhandled(),t._settledValue},t.PromiseInspection=e}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),c=i.canEvaluate,u=i.tryCatch,s=i.errorObj;if(c){for(var p=function(t){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,t))},a=function(t){for(var e=[],r=1;r<=t;++r)e.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,e.join(", ")))},l=[],f=[void 0],h=1;h<=5;++h)l.push(p(h)),f.push(a(h));var _=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};_.prototype.callers=f,_.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(e>=r){var n=this.callers[r];t._pushContext();var o=u(n)(this);t._popContext(),o===s?t._rejectCallback(o.e,!1,!0):t._resolveCallback(o)}else this.now=e};var y=function(t){this._reject(t)}}t.join=function(){var r,i=arguments.length-1;if(i>0&&"function"==typeof arguments[i]&&(r=arguments[i],i<6&&c)){(v=new t(o))._captureStackTrace();for(var u=new _(i,r),s=l,p=0;p<i;++p){var a=n(arguments[p],v);a instanceof t?(a=a._target())._isPending()?a._then(s[p],y,void 0,v,u):a._isFulfilled()?s[p].call(v,a._value(),u):v._reject(a._reason()):s[p].call(v,a,u)}return v}for(var f=arguments.length,h=new Array(f),d=0;d<f;++d)h[d]=arguments[d];r&&h.pop();var v=new e(h).promise();return void 0!==r?v.spread(r):v}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o,i){var c=t._getDomain,u=r(2),s=r(0),p=s.tryCatch,a=s.errorObj,l={},f=[];function h(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace();var o=c();this._callback=null===o?e:o.bind(e),this._preservedValues=n===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=r>=1?[]:f,u.invoke(_,this,void 0)}function _(){this._init$(void 0,-2)}function y(t,e,r,n){var o="object"==typeof r&&null!==r?r.concurrency:0;return new h(t,e,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,n)}s.inherits(h,e),h.prototype._init=function(){},h.prototype._promiseFulfilled=function(e,r){var n=this._values,i=this.length(),c=this._preservedValues,u=this._limit;if(n[r]===l){if(n[r]=e,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(u>=1&&this._inFlight>=u)return n[r]=e,void this._queue.push(r);null!==c&&(c[r]=e);var s=this._callback,f=this._promise._boundValue();this._promise._pushContext();var h=p(s).call(f,e,r,i);if(this._promise._popContext(),h===a)return this._reject(h.e);var _=o(h,this._promise);if(_ instanceof t){if((_=_._target())._isPending())return u>=1&&this._inFlight++,n[r]=l,_._proxyPromiseArray(this,r);if(!_._isFulfilled())return this._reject(_._reason());h=_._value()}n[r]=h}++this._totalResolved>=i&&(null!==c?this._filter(n,c):this._resolve(n))},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),o=0,i=0;i<r;++i)t[i]&&(n[o++]=e[i]);n.length=o,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return"function"!=typeof t?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(this,t,e,null).promise()},t.map=function(t,e,r,o){return"function"!=typeof e?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(t,e,r,o).promise()}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(1),n=r(2),o=e.CancellationError;t.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;this._unsetCancellable(),r._target()._rejectCallback(t,!1,!0)},t.prototype.cancel=function(t){return this.isCancellable()?(void 0===t&&(t=new o),n.invokeLater(this._cancel,this,t),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(n.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var t=this.then();return t._unsetCancellable(),t},t.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);return n._setCancellable(),n._cancellationParent=void 0,n}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(1).TypeError,c=r(0).inherits,u=t.PromiseInspection;function s(e){for(var r=e.length,n=0;n<r;++n){var o=e[n];if(o.isRejected())return t.reject(o.error());e[n]=o._settledValue}return e}function p(t){setTimeout((function(){throw t}),0)}function a(e,r){var o=0,i=e.length,c=t.defer();return function u(){if(o>=i)return c.resolve();var s=function(t){var e=n(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(e[o++]);if(s instanceof t&&s._isDisposable()){try{s=n(s._getDisposer().tryDispose(r),e.promise)}catch(t){return p(t)}if(s instanceof t)return s._then(u,p,null,null,null)}u()}(),c.promise}function l(t){var e=new u;return e._settledValue=t,e._bitField=268435456,a(this,e).thenReturn(t)}function f(t){var e=new u;return e._settledValue=t,e._bitField=134217728,a(this,e).thenThrow(t)}function h(t,e,r){this._data=t,this._promise=e,this._context=r}function _(t,e,r){this.constructor$(t,e,r)}function y(t){return h.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}h.prototype.data=function(){return this._data},h.prototype.promise=function(){return this._promise},h.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},h.prototype.tryDispose=function(t){var e=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=null!==e?this.doDispose(e,t):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},h.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},c(_,h),_.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},t.using=function(){var r=arguments.length;if(r<2)return e("you must pass at least 2 arguments to Promise.using");var o,i=arguments[r-1];if("function"!=typeof i)return e("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var c=!0;2===r&&Array.isArray(arguments[0])?(r=(o=arguments[0]).length,c=!1):(o=arguments,r--);for(var u=new Array(r),p=0;p<r;++p){var a=o[p];if(h.isDisposer(a)){var _=a;(a=a.promise())._setDisposable(_)}else{var d=n(a);d instanceof t&&(a=d._then(y,null,null,{resources:u,index:p},void 0))}u[p]=a}var v=t.settle(u).then(s).then((function(t){var e;v._pushContext();try{e=c?i.apply(void 0,t):i.call(void 0,t)}finally{v._popContext()}return e}))._then(l,f,void 0,u,void 0);return u.promise=v,v},t.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new _(t,this,o());throw new i}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(1).TypeError,c=r(0),u=c.errorObj,s=c.tryCatch,p=[];function a(e,r,o,i){(this._promise=new t(n))._captureStackTrace(),this._stack=i,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(p):p}a.prototype.promise=function(){return this._promise},a.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},a.prototype._continue=function(e){if(e===u)return this._promise._rejectCallback(e.e,!1,!0);var r=e.value;if(!0===e.done)this._promise._resolveCallback(r);else{var n=o(r,this._promise);if(!(n instanceof t)&&null===(n=function(e,r,n){for(var i=0;i<r.length;++i){n._pushContext();var c=s(r[i])(e);if(n._popContext(),c===u){n._pushContext();var p=t.reject(u.e);return n._popContext(),p}var a=o(c,n);if(a instanceof t)return a}return null}(n,this._yieldHandlers,this._promise)))return void this._throw(new i("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));n._then(this._next,this._throw,void 0,this,null)}},a.prototype._throw=function(t){this._promise._attachExtraTrace(t),this._promise._pushContext();var e=s(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},a.prototype._next=function(t){this._promise._pushContext();var e=s(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},t.coroutine=function(t,e){if("function"!=typeof t)throw new i("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=Object(e).yieldHandler,n=a,o=(new Error).stack;return function(){var e=t.apply(this,arguments),i=new n(void 0,void 0,r,o);return i._generator=e,i._next(void 0),i.promise()}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");p.push(t)},t.spawn=function(r){if("function"!=typeof r)return e("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=new a(r,this),o=n.promise();return n._run(t.spawn),o}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(0),n=r(2),o=e.tryCatch,i=e.errorObj;function c(t,r){if(!e.isArray(t))return u.call(this,t,r);var c=o(r).apply(this._boundValue(),[null].concat(t));c===i&&n.throwLater(c.e)}function u(t,e){var r=this._boundValue(),c=void 0===t?o(e).call(r,null):o(e).call(r,null,t);c===i&&n.throwLater(c.e)}function s(t,e){if(!t){var r=this._target()._getCarriedStackTrace();r.cause=t,t=r}var c=o(e).call(this._boundValue(),t);c===i&&n.throwLater(c.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,e){if("function"==typeof t){var r=u;void 0!==e&&Object(e).spread&&(r=c),this._then(r,s,void 0,this,t)}return this}}},function(t,e,r){"use strict";var n=Object.create;if(n){var o=n(null),i=n(null);o[" size"]=i[" size"]=0}t.exports=function(t){var e,n,c=r(0),u=c.canEvaluate,s=c.isIdentifier,p=function(t){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,t))(f)},a=function(t){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",t))},l=function(t,e,r){var n=r[t];if("function"!=typeof n){if(!s(t))return null;if(n=e(t),r[t]=n,r[" size"]++,r[" size"]>512){for(var o=Object.keys(r),i=0;i<256;++i)delete r[o[i]];r[" size"]=o.length-256}}return n};function f(e,r){var n;if(null!=e&&(n=e[r]),"function"!=typeof n){var o="Object "+c.classString(e)+" has no method '"+c.toString(r)+"'";throw new t.TypeError(o)}return n}function h(t){return f(t,this.pop()).apply(t,this)}function _(t){return t[this]}function y(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}e=function(t){return l(t,p,o)},n=function(t){return l(t,a,i)},t.prototype.call=function(t){for(var r=arguments.length,n=new Array(r-1),o=1;o<r;++o)n[o-1]=arguments[o];if(u){var i=e(t);if(null!==i)return this._then(i,void 0,void 0,n,void 0)}return n.push(t),this._then(h,void 0,void 0,n,void 0)},t.prototype.get=function(t){var e;if("number"==typeof t)e=y;else if(u){var r=n(t);e=null!==r?r:_}else e=_;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),c=i.isObject,u=r(5);function s(t){for(var e=u.keys(t),r=e.length,n=new Array(2*r),o=0;o<r;++o){var i=e[o];n[o]=t[i],n[o+r]=i}this.constructor$(n)}function p(e){var r,i=n(e);return c(i)?(r=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new s(i).promise(),i instanceof t&&r._propagateFrom(i,4),r):o("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}i.inherits(s,e),s.prototype._init=function(){this._init$(void 0,-3)},s.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){for(var r={},n=this.length(),o=0,i=this.length();o<i;++o)r[this._values[o+n]]=this._values[o];this._resolve(r)}},s.prototype._promiseProgressed=function(t,e){this._promise._progress({key:this._values[e+this.length()],value:t})},s.prototype.shouldCopyValues=function(){return!1},s.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return p(this)},t.props=function(t){return p(t)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0).isArray,c=function(t){return t.then((function(e){return u(e,t)}))};function u(r,u){var s=n(r);if(s instanceof t)return c(s);if(!i(r))return o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var p=new t(e);void 0!==u&&p._propagateFrom(u,5);for(var a=p._fulfill,l=p._reject,f=0,h=r.length;f<h;++f){var _=r[f];(void 0!==_||f in r)&&t.cast(_)._then(a,l,void 0,p,null)}return p}t.race=function(t){return u(t,void 0)},t.prototype.race=function(){return u(this,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o,i){var c=t._getDomain,u=r(2),s=r(0),p=s.tryCatch,a=s.errorObj;function l(e,r,n,s){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=s===i?[]:null,this._zerothIsAccum=void 0===n,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var p=o(n,this._promise),a=!1,l=p instanceof t;l&&((p=p._target())._isPending()?p._proxyPromiseArray(this,-1):p._isFulfilled()?(n=p._value(),this._gotAccum=!0):(this._reject(p._reason()),a=!0)),l||this._zerothIsAccum||(this._gotAccum=!0);var h=c();this._callback=null===h?r:h.bind(r),this._accum=n,a||u.invoke(f,this,void 0)}function f(){this._init$(void 0,-5)}function h(t,e,r,o){return"function"!=typeof e?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new l(t,e,r,o).promise()}s.inherits(l,e),l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},l.prototype._promiseFulfilled=function(e,r){var n=this._values;n[r]=e;var i,c=this.length(),u=this._preservedValues,s=null!==u,l=this._gotAccum,f=this._valuesPhase;if(!f)for(f=this._valuesPhase=new Array(c),i=0;i<c;++i)f[i]=0;if(i=f[r],0===r&&this._zerothIsAccum?(this._accum=e,this._gotAccum=l=!0,f[r]=0===i?1:2):-1===r?(this._accum=e,this._gotAccum=l=!0):0===i?f[r]=1:(f[r]=2,this._accum=e),l){for(var h,_=this._callback,y=this._promise._boundValue(),d=this._reducingIndex;d<c;++d)if(2!==(i=f[d])){if(1!==i)return;if(e=n[d],this._promise._pushContext(),s?(u.push(e),h=p(_).call(y,e,d,c)):h=p(_).call(y,this._accum,e,d,c),this._promise._popContext(),h===a)return this._reject(h.e);var v=o(h,this._promise);if(v instanceof t){if((v=v._target())._isPending())return f[d]=4,v._proxyPromiseArray(this,d);if(!v._isFulfilled())return this._reject(v._reason());h=v._value()}this._reducingIndex=d+1,this._accum=h}else this._reducingIndex=d+1;this._resolve(s?u:this._accum)}},t.prototype.reduce=function(t,e){return h(this,t,e,null)},t.reduce=function(t,e,r,n){return h(t,e,r,n)}}},function(t,e,r){"use strict";t.exports=function(t,e){var n=t.PromiseInspection;function o(t){this.constructor$(t)}r(0).inherits(o,e),o.prototype._promiseResolved=function(t,e){this._values[t]=e,++this._totalResolved>=this._length&&this._resolve(this._values)},o.prototype._promiseFulfilled=function(t,e){var r=new n;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)},o.prototype._promiseRejected=function(t,e){var r=new n;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)},t.settle=function(t){return new o(t).promise()},t.prototype.settle=function(){return new o(this).promise()}}},function(t,e,r){"use strict";t.exports=function(t,e,n){var o=r(0),i=r(1).RangeError,c=r(1).AggregateError,u=o.isArray;function s(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function p(t,e){if((0|e)!==e||e<0)return n("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var r=new s(t),o=r.promise();return r.setHowMany(e),r.init(),o}o.inherits(s,e),s.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},s.prototype.init=function(){this._initialized=!0,this._init()},s.prototype.setUnwrap=function(){this._unwrap=!0},s.prototype.howMany=function(){return this._howMany},s.prototype.setHowMany=function(t){this._howMany=t},s.prototype._promiseFulfilled=function(t){this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},s.prototype._promiseRejected=function(t){if(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()){for(var e=new c,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},s.prototype._fulfilled=function(){return this._totalResolved},s.prototype._rejected=function(){return this._values.length-this.length()},s.prototype._addRejected=function(t){this._values.push(t)},s.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},s.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},s.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new i(e)},s.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return p(t,e)},t.prototype.some=function(t){return p(this,t)},t._SomePromiseArray=s}},function(t,e,r){"use strict";t.exports=function(t,e){var n={},o=r(0),i=r(10)._nodebackForPromise,c=o.withAppended,u=o.maybeWrapAsError,s=o.canEvaluate,p=r(1).TypeError,a={__isPromisified__:!0},l=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),f=function(t){return o.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function h(t){return!l.test(t)}function _(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function y(t,e,r){var n=o.getDataPropertyOrDefault(t,e+r,a);return!!n&&_(n)}function d(t,e,r,n){for(var i=o.inheritedDataKeys(t),c=[],u=0;u<i.length;++u){var s=i[u],a=t[s],l=n===f||f(s,a,t);"function"!=typeof a||_(a)||y(t,s,e)||!n(s,a,t,l)||c.push(s,a)}return function(t,e,r){for(var n=0;n<t.length;n+=2){var o=t[n];if(r.test(o))for(var i=o.replace(r,""),c=0;c<t.length;c+=2)if(t[c]===i)throw new p("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",e))}}(c,e,r),c}var v=function(t){return t.replace(/([$])/,"\\$")},m=function(t){return o.filledRange(t,"_arg","")};var g=s?function(r,s,p,a){var l=Math.max(0,function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}(a)-1),f=function(t){for(var e=[t],r=Math.max(0,t-1-3),n=t-1;n>=r;--n)e.push(n);for(n=t+1;n<=3;++n)e.push(n);return e}(l),h="string"==typeof r||s===n;var _="string"==typeof r?"this != null ? this['"+r+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise);                      \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n        ".replace("Parameters",function(t){return o.filledRange(Math.max(t,3),"_arg","")}(l)).replace("[CodeForSwitchCase]",function(){for(var t,e,r,n="",o=0;o<f.length;++o)n+="case "+f[o]+":"+(t=f[o],e=void 0,r=void 0,e=m(t).join(", "),r=t>0?", ":"",(h?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===s?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",e).replace(", ",r));return n+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",h?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",_))(t,a,s,c,u,i,o.tryCatch,o.errorObj,o.notEnumerableProp,e)}:function(r,s,p,a){var l=function(){return this}(),f=r;function h(){var o=s;s===n&&(o=this);var p=new t(e);p._captureStackTrace();var a="string"==typeof f&&this!==l?this[f]:r,h=i(p);try{a.apply(o,c(arguments,h))}catch(t){p._rejectCallback(u(t),!0,!0)}return p}return"string"==typeof f&&(r=a),o.notEnumerableProp(h,"__isPromisified__",!0),h};function b(t,e,r,i){for(var c=new RegExp(v(e)+"$"),u=d(t,e,c,r),s=0,p=u.length;s<p;s+=2){var a=u[s],l=u[s+1],f=a+e;if(i===g)t[f]=g(a,n,a,l,e);else{var h=i(l,(function(){return g(a,n,a,l,e)}));o.notEnumerableProp(h,"__isPromisified__",!0),t[f]=h}}return o.toFastProperties(t),t}function w(t,e){return g(t,e,void 0,t)}t.promisify=function(t,e){if("function"!=typeof t)throw new p("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(_(t))return t;var r=w(t,arguments.length<2?n:e);return o.copyDescriptors(t,r,h),r},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new p("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");var r=(e=Object(e)).suffix;"string"!=typeof r&&(r="Async");var n=e.filter;"function"!=typeof n&&(n=f);var i=e.promisifier;if("function"!=typeof i&&(i=g),!o.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var c=o.inheritedDataKeys(t),u=0;u<c.length;++u){var s=t[c[u]];"constructor"!==c[u]&&o.isClass(s)&&(b(s.prototype,r,n,i),b(s,r,n,i))}return b(t,r,n,i)}}},function(t,e,r){"use strict";t.exports=function(t){var e=t._SomePromiseArray;function r(t){var r=new e(t),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}t.any=function(t){return r(t)},t.prototype.any=function(){return r(this)}}},function(t,e,r){"use strict";t.exports=function(t,e){var r=t.reduce;t.prototype.each=function(t){return r(this,t,null,e)},t.each=function(t,n){return r(t,n,null,e)}}},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=t.TimeoutError,i=function(t){return c(+this).thenReturn(t)},c=t.delay=function(r,n){if(void 0===n){n=r,r=void 0;var o=new t(e);return setTimeout((function(){o._fulfill()}),n),o}return n=+n,t.resolve(r)._then(i,null,null,n,void 0)};function u(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function s(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}t.prototype.delay=function(t){return c(this,t)},t.prototype.timeout=function(t,e){t=+t;var r=this.then().cancellable();r._cancellationParent=this;var i=setTimeout((function(){!function(t,e){var r;t.isPending()&&(!n.isPrimitive(e)&&e instanceof Error?r=e:("string"!=typeof e&&(e="operation timed out"),r=new o(e)),n.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._cancel(r))}(r,e)}),t);return r._then(u,s,void 0,i,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e){var r=t.map;t.prototype.filter=function(t,n){return r(this,t,n,e)},t.filter=function(t,n,o){return r(t,n,o,e)}}},function(t,e,r){"use strict";function n(){throw new Error("TlsStub does not implement tls.connect()")}r.r(e),r.d(e,"connect",(function(){return n}))},function(t,e,r){var n,o,i,c,u,s,p,a,l,f,h,_,y,d,v,m=function(t,e){return function(){return t.apply(e,arguments)}},g=[].slice,b=function(t,e){for(var r in e)w.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},w={}.hasOwnProperty;f=r(6),d=r(9),_=r(4).Response.ResponseType,a=r(3),c=r(12).EventEmitter,l=d.ar,v=d.varar,d.aropt,h=d.mkErr,null==y&&(y=function(t){return setTimeout(t,0)}),i=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.toString=l((function(){return"[object Cursor]"})),e}(s=function(){function t(t,e,r,n){this._eachCb=m(this._eachCb,this),this._conn=t,this._token=e,this._opts=r,this._root=n,this._responses=[],this._responseIndex=0,this._outstandingRequests=1,this._iterations=0,this._endFlag=!1,this._contFlag=!1,this._closeAsap=!1,this._cont=null,this._cbQueue=[],this._closeCb=null,this._closeCbPromise=null,this.next=this._next}return t.prototype.stackSize=100,t.prototype._addResponse=function(t){if(t.t===this._type||t.t===_.SUCCESS_SEQUENCE?t.r.length>0&&this._responses.push(t):this._responses.push(t),this._outstandingRequests-=1,t.t!==this._type&&(this._endFlag=!0,null!=this._closeCb))switch(t.t){case _.COMPILE_ERROR:this._closeCb(h(f.ReqlServerCompileError,t,this._root));break;case _.CLIENT_ERROR:this._closeCb(h(f.ReqlClientError,t,this._root));break;case _.RUNTIME_ERROR:this._closeCb(h(d.errorClass(t.e),t,this._root));break;default:this._closeCb()}return this._contFlag=!1,!1===this._closeAsap?this._promptNext():this.close(this._closeCb),this},t.prototype._getCallback=function(){var t;return this._iterations+=1,t=this._cbQueue.shift(),this._iterations%this.stackSize==this.stackSize-1?function(e,r){return y((function(){return t(e,r)}))}:t},t.prototype._handleRow=function(){var t,e,r;return e=this._responses[0],r=d.recursivelyConvertPseudotype(e.r[this._responseIndex],this._opts),t=this._getCallback(),this._responseIndex+=1,this._responseIndex===e.r.length&&(this._responses.shift(),this._responseIndex=0),t(null,r)},t.prototype.bufferEmpty=function(){return 0===this._responses.length||this._responses[0].r.length<=this._responseIndex},t.prototype._promptNext=function(){var t,e,r;for(null!=this._closeCbPromise&&(t=this._getCallback())(new f.ReqlDriverError("Cursor is closed."));null!=this._cbQueue[0];){if(!0===this.bufferEmpty())return void(!0===this._endFlag?(t=this._getCallback())(new f.ReqlDriverError("No more rows in the cursor.")):this._responses.length<=1&&this._promptCont());switch(r=this._responses[0],1===this._responses.length&&this._promptCont(),r.t){case _.SUCCESS_PARTIAL:this._handleRow();break;case _.SUCCESS_SEQUENCE:0===r.r.length?this._responses.shift():this._handleRow();break;case _.COMPILE_ERROR:this._responses.shift(),(t=this._getCallback())(h(f.ReqlServerCompileError,r,this._root));break;case _.CLIENT_ERROR:this._responses.shift(),(t=this._getCallback())(h(f.ReqlClientError,r,this._root));break;case _.RUNTIME_ERROR:this._responses.shift(),t=this._getCallback(),e=d.errorClass(r.e),t(h(e,r,this._root));break;default:this._responses.shift(),(t=this._getCallback())(new f.ReqlDriverError("Unknown response type for cursor"))}}},t.prototype._promptCont=function(){if(!this._contFlag&&!this._endFlag&&this._conn.isOpen())return this._contFlag=!0,this._outstandingRequests+=1,this._conn._continueQuery(this._token)},t.prototype.hasNext=function(){throw new f.ReqlDriverError("The `hasNext` command has been removed since 1.13. Use `next` instead.")},t.prototype._next=v(0,1,(function(t){var e,r;if(null!=t&&"function"!=typeof t)throw new f.ReqlDriverError("First argument to `next` must be a function or undefined.");return r=this,e=function(t){return r._cbQueue.push(t),r._promptNext()},a.fromNode(e).nodeify(t)})),t.prototype.close=v(0,1,(function(t){var e;return null!=this._closeCbPromise?this._closeCbPromise.isPending()?this._closeCbPromise=this._closeCbPromise.nodeify(t):this._closeCbPromise=a.resolve().nodeify(t):this._endFlag?(this._closeCbPromise=a.resolve().nodeify(t),this._responses=[],this._responseIndex=0):this._closeCbPromise=new a((e=this,function(t,r){return e._closeCb=function(n){for(e._responses=[],e._responseIndex=0;e._cbQueue.length>0;)e._cbQueue.shift();return e._outstandingRequests=0,n?r(n):t()},e._closeAsap=!0,e._outstandingRequests+=1,e._conn._endQuery(e._token)})).nodeify(t),this._closeCbPromise})),t.prototype.each=v(1,2,(function(t,e){var r,n;if("function"!=typeof t)throw new f.ReqlDriverError("First argument to each must be a function.");if(null!=e&&"function"!=typeof e)throw new f.ReqlDriverError("Optional second argument to each must be a function.");return this,n=this,r=function(o,i){return null!=o?"No more rows in the cursor."===o.message?"function"==typeof e?e():void 0:t(o):!1!==t(null,i)?n._next(r):"function"==typeof e?e():void 0},this._next(r)})),t.prototype.eachAsync=v(1,3,(function(t,e,r){var n,o,i,c,u;if(null==r&&(r={concurrency:1}),"function"!=typeof t)throw new f.ReqlDriverError("First argument to eachAsync must be a function.");if(null!=e)if("object"==typeof e)r=e,e=void 0;else if("function"!=typeof e)throw new f.ReqlDriverError("Optional second argument to eachAsync must be a function or `options` object");if(!(r&&"number"==typeof r.concurrency&&r.concurrency>0))throw new f.ReqlDriverError("Optional `options.concurrency` argument to eachAsync must be a positive number");return o=[],c=function(e){var r,n,o,i;return t.length<=1?i=a.resolve(t(e)):(o=!1,r=!1,n=void 0,i=a.fromNode((function(i){return void 0!==t(e,(function(t){return o=!0,r?i(t):n=t}))?i(new f.ReqlDriverError("A two-argument row handler for eachAsync may only return undefined.")):o&&i(n),r=!0}))),i.then((function(t){if(void 0===t||typeof t===a)return t;throw new f.ReqlDriverError("Row handler for eachAsync may only return a Promise or undefined.")}))},u=this,i=(n=function(){return null!=u._closeCbPromise?a.resolve().then((function(t){throw new f.ReqlDriverError("Cursor is closed.")})):u._next().then((function(t){return o.length<r.concurrency?t:a.any(o).catch(a.AggregateError,(function(t){throw t[0]})).return(t)})).then((function(t){var e;return e=c(t).then((function(){return o.splice(o.indexOf(e),1)})),o.push(e)})).then(n).catch((function(t){if("No more rows in the cursor."!==(null!=t?t.message:void 0))throw t;return a.all(o)}))})().then((function(){if(null!=e)return e(null)})).catch((function(t){if(null!=e)return e(t);throw t})),null==e?i:null})),t.prototype._each=t.prototype.each,t.prototype._eachAsync=t.prototype.eachAsync,t.prototype.toArray=v(0,1,(function(t){var e,r;if(null!=t&&"function"!=typeof t)throw new f.ReqlDriverCompileError("First argument to `toArray` must be a function or undefined.");return e=[],r=function(t){e.push(t)},this.eachAsync(r).then((function(){return e})).nodeify(t)})),t.prototype._makeEmitter=function(){return this.emitter=new c,this.each=function(){throw new f.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")},this.next=function(){throw new f.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")}},t.prototype.addListener=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.addListener(t,e)},t.prototype.on=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.on(t,e)},t.prototype.once=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.once(t,e)},t.prototype.removeListener=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.removeListener(t,e)},t.prototype.removeAllListeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.removeAllListeners(t)},t.prototype.setMaxListeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.setMaxListeners(t)},t.prototype.listeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.listeners(t)},t.prototype.emit=function(){var t,e,r;return t=1<=arguments.length?g.call(arguments,0):[],null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),(e=this.emitter).emit.apply(e,t)},t.prototype._eachCb=function(t,e){return null!=t?this.emitter.emit("error",t):this.emitter.emit("data",e)},t}()),u=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object Feed]"})),e}(s),function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}b(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object UnionedFeed]"}))}(s),o=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object AtomFeed]"})),e}(s),p=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object OrderByLimitFeed]"})),e}(s),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype._hasNext=l((function(){return null==this.__index&&(this.__index=0),this.__index<this.length})),e.prototype._next=v(0,1,(function(t){var e,r;return r=this,e=function(t){var e;return null!=r._closeCbPromise&&t(new f.ReqlDriverError("Cursor is closed.")),!0===r._hasNext()?(e=r).__index%r.stackSize==r.stackSize-1?y((function(){return t(null,e[e.__index++])})):t(null,e[e.__index++]):t(new f.ReqlDriverError("No more rows in the cursor."))},a.fromNode(e).nodeify(t)})),e.prototype.toArray=v(0,1,(function(t){var e,r;return r=this,e=function(t){return null!=r._closeCbPromise&&t(new f.ReqlDriverError("Cursor is closed.")),null!=r.__index?t(null,r.slice(r.__index,r.length)):t(null,r)},a.fromNode(e).nodeify(t)})),e.prototype.close=v(0,1,(function(t){return this.length=0,this.__index=0,this._closeCbPromise=a.resolve().nodeify(t),this._closeCbPromise})),e.prototype.makeIterable=function(t){var r,n,o;for(n in t.__proto__={},o=e.prototype)r=o[n],"constructor"!==n&&("_next"===n?(t.__proto__.next=r,t.__proto__._next=r):t.__proto__[n]=r);return t.__proto__.__proto__=[].__proto__,t},e}(s),t.exports.Cursor=i,t.exports.Feed=u,t.exports.AtomFeed=o,t.exports.OrderByLimitFeed=p,t.exports.makeIterable=n.prototype.makeIterable},function(t,e){t.exports=require("crypto")}])}));