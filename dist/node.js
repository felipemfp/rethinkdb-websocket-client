!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.RethinkdbWebsocketClient=e():t.RethinkdbWebsocketClient=e()}(self,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=30)}([function(t,e,r){"use strict";var n=r(7),o="undefined"==typeof navigator,i=function(){try{var t={};return n.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(t){return!1}}(),s={e:{}},c;function u(){try{var t=c;return c=null,t.apply(this,arguments)}catch(t){return s.e=t,s}}function a(t){return c=t,u}var p=function(t,e){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=t,this.constructor$=e,e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}return n.prototype=e.prototype,t.prototype=new n,t.prototype};function l(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function f(t){return!l(t)}function h(t){return l(t)?new Error(k(t)):t}function _(t,e){var r,n=t.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=t[r];return o[r]=e,o}function y(t,e,r){if(!n.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var o=Object.getOwnPropertyDescriptor(t,e);return null!=o?null==o.get&&null==o.set?o.value:r:void 0}function d(t,e,r){if(l(t))return t;var o={value:r,configurable:!0,enumerable:!1,writable:!0};return n.defineProperty(t,e,o),t}function v(t){throw t}var m=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1};if(n.isES5){var r=Object.getOwnPropertyNames;return function(t){for(var o=[],i=Object.create(null);null!=t&&!e(t);){var s;try{s=r(t)}catch(t){return o}for(var c=0;c<s.length;++c){var u=s[c];if(!i[u]){i[u]=!0;var a=Object.getOwnPropertyDescriptor(t,u);null!=a&&null==a.get&&null==a.set&&o.push(u)}}t=n.getPrototypeOf(t)}return o}}var o={}.hasOwnProperty;return function(r){if(e(r))return[];var n=[];t:for(var i in r)if(o.call(r,i))n.push(i);else{for(var s=0;s<t.length;++s)if(o.call(t[s],i))continue t;n.push(i)}return n}}(),g=/this\s*\.\s*\S+\s*=/;function w(t){try{if("function"==typeof t){var e=n.names(t.prototype),r=n.isES5&&e.length>1,o=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=g.test(t+"")&&n.names(t).length>0;if(r||o||i)return!0}return!1}catch(t){return!1}}function b(t){function e(){}e.prototype=t;for(var r=8;r--;)new e;return t}var E=/^[a-z$_][a-z$_0-9]*$/i;function O(t){return E.test(t)}function S(t,e,r){for(var n=new Array(t),o=0;o<t;++o)n[o]=e+o+r;return n}function k(t){try{return t+""}catch(t){return"[no string representation]"}}function C(t){try{d(t,"isOperational",!0)}catch(t){}}function R(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function T(t){return t instanceof Error&&n.propertyIsWritable(t,"stack")}var x="stack"in new Error?function(t){return T(t)?t:new Error(k(t))}:function(t){if(T(t))return t;try{throw new Error(k(t))}catch(t){return t}};function j(t){return{}.toString.call(t)}function A(t,e,r){for(var o=n.names(t),i=0;i<o.length;++i){var s=o[i];if(r(s))try{n.defineProperty(e,s,n.getDescriptor(t,s))}catch(t){}}}var N={isClass:w,isIdentifier:O,inheritedDataKeys:m,getDataPropertyOrDefault:y,thrower:v,isArray:n.isArray,haveGetters:i,notEnumerableProp:d,isPrimitive:l,isObject:f,canEvaluate:o,errorObj:s,tryCatch:a,inherits:p,withAppended:_,maybeWrapAsError:h,toFastProperties:b,filledRange:S,toString:k,canAttachTrace:T,ensureErrorObject:x,originatesFromRejection:R,markAsOriginatingFromRejection:C,classString:j,copyDescriptors:A,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===j(process).toLowerCase()},P;N.isRecentNode=N.isNode&&(P=process.versions.node.split(".").map(Number),0===P[0]&&P[1]>10||P[0]>0),N.isNode&&N.toFastProperties(process);try{throw new Error}catch(t){N.lastLineError=t}t.exports=N},function(t,e,r){"use strict";var n,o,i=r(7),s=i.freeze,c=r(0),u=c.inherits,a=c.notEnumerableProp;function p(t,e){function r(n){if(!(this instanceof r))return new r(n);a(this,"message","string"==typeof n?n:e),a(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(r,Error),r}var l=p("Warning","warning"),f=p("CancellationError","cancellation error"),h=p("TimeoutError","timeout error"),_=p("AggregateError","aggregate error");try{n=TypeError,o=RangeError}catch(t){n=p("TypeError","type error"),o=p("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),d=0;d<y.length;++d)"function"==typeof Array.prototype[y[d]]&&(_.prototype[y[d]]=Array.prototype[y[d]]);i.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var v=0;function m(t){if(!(this instanceof m))return new m(t);a(this,"name","OperationalError"),a(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(a(this,"message",t.message),a(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_.prototype.toString=function(){var t=Array(4*v+1).join(" "),e="\n"+t+"AggregateError of:\n";v++,t=Array(4*v+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(n=o.join("\n"))+"\n"}return v--,e},u(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=s({CancellationError:f,TimeoutError:h,OperationalError:m,RejectionError:m,AggregateError:_}),a(Error,"__BluebirdErrorTypes__",g)),t.exports={Error:Error,TypeError:n,RangeError:o,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:l}},function(t,e,r){"use strict";var n;try{throw new Error}catch(t){n=t}var o=r(33),i=r(34),s=r(0);function c(){this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=o.isStatic?o(this.drainQueues):o}function u(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function a(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function p(t){this._normalQueue._pushOne(t),this._queueTick()}c.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},c.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(t){setTimeout(t,0)})},c.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},c.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout((function(){t(e)}),0);else try{this._schedule((function(){t(e)}))}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},s.hasDevTools?(o.isStatic&&(o=function(t){setTimeout(t,0)}),c.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?u.call(this,t,e,r):this._schedule((function(){setTimeout((function(){t.call(e,r)}),100)}))},c.prototype.invoke=function(t,e,r){this._trampolineEnabled?a.call(this,t,e,r):this._schedule((function(){t.call(e,r)}))},c.prototype.settlePromises=function(t){this._trampolineEnabled?p.call(this,t):this._schedule((function(){t._settlePromises()}))}):(c.prototype.invokeLater=u,c.prototype.invoke=a,c.prototype.settlePromises=p),c.prototype.invokeFirst=function(t,e,r){this._normalQueue.unshift(t,e,r),this._queueTick()},c.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var r=t.shift(),n=t.shift();e.call(r,n)}else e._settlePromises()}},c.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},c.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},c.prototype._reset=function(){this._isTickUsed=!1},t.exports=new c,t.exports.firstLineError=n},function(t,e){t.exports=require("util")},function(t,e,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var o=r(32)();o.noConflict=function(){try{Promise===o&&(Promise=n)}catch(t){}return o},t.exports=o},function(t,e){t.exports={VersionDummy:{Version:{V0_1:1063369270,V0_2:1915781601,V0_3:1601562686,V0_4:1074539808,V1_0:885177795},Protocol:{PROTOBUF:656407617,JSON:2120839367}},Query:{QueryType:{START:1,CONTINUE:2,STOP:3,NOREPLY_WAIT:4,SERVER_INFO:5},AssocPair:{}},Frame:{FrameType:{POS:1,OPT:2}},Backtrace:{},Response:{ResponseType:{SUCCESS_ATOM:1,SUCCESS_SEQUENCE:2,SUCCESS_PARTIAL:3,WAIT_COMPLETE:4,SERVER_INFO:5,CLIENT_ERROR:16,COMPILE_ERROR:17,RUNTIME_ERROR:18},ErrorType:{INTERNAL:1e6,RESOURCE_LIMIT:2e6,QUERY_LOGIC:3e6,NON_EXISTENCE:31e5,OP_FAILED:41e5,OP_INDETERMINATE:42e5,USER:5e6,PERMISSION_ERROR:6e6},ResponseNote:{SEQUENCE_FEED:1,ATOM_FEED:2,ORDER_BY_LIMIT_FEED:3,UNIONED_FEED:4,INCLUDES_STATES:5}},Datum:{DatumType:{R_NULL:1,R_BOOL:2,R_NUM:3,R_STR:4,R_ARRAY:5,R_OBJECT:6,R_JSON:7},AssocPair:{}},Term:{TermType:{DATUM:1,MAKE_ARRAY:2,MAKE_OBJ:3,VAR:10,JAVASCRIPT:11,UUID:169,HTTP:153,ERROR:12,IMPLICIT_VAR:13,DB:14,TABLE:15,GET:16,GET_ALL:78,EQ:17,NE:18,LT:19,LE:20,GT:21,GE:22,NOT:23,ADD:24,SUB:25,MUL:26,DIV:27,MOD:28,FLOOR:183,CEIL:184,ROUND:185,APPEND:29,PREPEND:80,DIFFERENCE:95,SET_INSERT:88,SET_INTERSECTION:89,SET_UNION:90,SET_DIFFERENCE:91,SLICE:30,SKIP:70,LIMIT:71,OFFSETS_OF:87,CONTAINS:93,GET_FIELD:31,KEYS:94,VALUES:186,OBJECT:143,HAS_FIELDS:32,WITH_FIELDS:96,PLUCK:33,WITHOUT:34,MERGE:35,BETWEEN_DEPRECATED:36,BETWEEN:182,REDUCE:37,MAP:38,FOLD:187,FILTER:39,CONCAT_MAP:40,ORDER_BY:41,DISTINCT:42,COUNT:43,IS_EMPTY:86,UNION:44,NTH:45,BRACKET:170,INNER_JOIN:48,OUTER_JOIN:49,EQ_JOIN:50,ZIP:72,RANGE:173,INSERT_AT:82,DELETE_AT:83,CHANGE_AT:84,SPLICE_AT:85,COERCE_TO:51,TYPE_OF:52,UPDATE:53,DELETE:54,REPLACE:55,INSERT:56,DB_CREATE:57,DB_DROP:58,DB_LIST:59,TABLE_CREATE:60,TABLE_DROP:61,TABLE_LIST:62,CONFIG:174,STATUS:175,WAIT:177,RECONFIGURE:176,REBALANCE:179,SYNC:138,GRANT:188,INDEX_CREATE:75,INDEX_DROP:76,INDEX_LIST:77,INDEX_STATUS:139,INDEX_WAIT:140,INDEX_RENAME:156,FUNCALL:64,BRANCH:65,OR:66,AND:67,FOR_EACH:68,FUNC:69,ASC:73,DESC:74,INFO:79,MATCH:97,UPCASE:141,DOWNCASE:142,SAMPLE:81,DEFAULT:92,JSON:98,TO_JSON_STRING:172,ISO8601:99,TO_ISO8601:100,EPOCH_TIME:101,TO_EPOCH_TIME:102,NOW:103,IN_TIMEZONE:104,DURING:105,DATE:106,TIME_OF_DAY:126,TIMEZONE:127,YEAR:128,MONTH:129,DAY:130,DAY_OF_WEEK:131,DAY_OF_YEAR:132,HOURS:133,MINUTES:134,SECONDS:135,TIME:136,MONDAY:107,TUESDAY:108,WEDNESDAY:109,THURSDAY:110,FRIDAY:111,SATURDAY:112,SUNDAY:113,JANUARY:114,FEBRUARY:115,MARCH:116,APRIL:117,MAY:118,JUNE:119,JULY:120,AUGUST:121,SEPTEMBER:122,OCTOBER:123,NOVEMBER:124,DECEMBER:125,LITERAL:137,GROUP:144,SUM:145,AVG:146,MIN:147,MAX:148,SPLIT:149,UNGROUP:150,RANDOM:151,CHANGES:152,ARGS:154,BINARY:155,GEOJSON:157,TO_GEOJSON:158,POINT:159,LINE:160,POLYGON:161,DISTANCE:162,INTERSECTS:163,INCLUDES:164,CIRCLE:165,GET_INTERSECTING:166,FILL:167,GET_NEAREST:168,POLYGON_SUB:171,MINVAL:180,MAXVAL:181},AssocPair:{}}}},function(t,e){t.exports=require("events")},function(t,e){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!(r&&!r.writable&&!r.set)}};else{var n={}.hasOwnProperty,o={}.toString,i={}.constructor.prototype,s=function(t){var e=[];for(var r in t)n.call(t,r)&&e.push(r);return e};t.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:s,names:s,defineProperty:function(t,e,r){return t[e]=r.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return i}},isES5:r,propertyIsWritable:function(){return!0}}}},function(t,e){var r,n,o,i,s,c,u,a,p,l,f,h,_,y,d,v,m,g,w=function(t,e){for(var r in e)b.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},b={}.hasOwnProperty;i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(c=function(t){function e(t,e,r){this.name=this.constructor.name,this.msg=t,this.frames=null!=r?r.slice(0):void 0,null!=e?"."===t[t.length-1]?this.message=t.slice(0,t.length-1)+" in:\n"+_.prototype.printQuery(e)+"\n"+_.prototype.printCarrots(e,r):this.message=t+" in:\n"+_.prototype.printQuery(e)+"\n"+_.prototype.printCarrots(e,r):this.message=""+t,null!=Error.captureStackTrace&&Error.captureStackTrace(this,this)}return w(e,t),e}(Error))),v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(o),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(c)),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(c))),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(c),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d)),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(n),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e}(d),_=function(){var t,e,r,n,o;function i(){}return i.prototype.printQuery=function(t){var e;return e=n(t),o(e)},n=function(t){var e,r,o,i,s;for(o in r=function(){var r,o,i,s;for(s=[],r=0,o=(i=t.args).length;r<o;r++)e=i[r],s.push(n(e));return s}(),i={},s=t.optargs)b.call(s,o)&&(e=s[o],i[o]=n(e));return t.compose(r,i)},i.prototype.printCarrots=function(t,i){var s;return s=0===i.length?[e(n(t))]:r(t,i),o(s).replace(/[^\^]/g," ")},r=function(t,o){var i,s,c,u,a,p,l;for(a in c=o.shift(),s=function(){var e,s,a,p;for(a=t.args,p=[],u=e=0,s=a.length;e<s;u=++e)i=a[u],c===u?p.push(r(i,o)):p.push(n(i));return p}(),p={},l=t.optargs)b.call(l,a)&&(i=l[a],p[a]=c===a?r(i,o):n(i));return null!=c?t.compose(s,p):e(t.compose(s,p))},t={},e=function(e){return[t,e]},o=function(e){var r,n,i,s;for(i="",r=0,n=e.length;r<n;r++)s=e[r],Array.isArray(s)?2===s.length&&s[0]===t?i+=o(s[1]).replace(/./g,"^"):i+=o(s):i+=s;return i},i}(),t.exports={ReqlError:c,ReqlCompileError:o,RqlCompileError:o,ReqlServerCompileError:v,ReqlDriverCompileError:i,RqlClientError:s,ReqlRuntimeError:d,RqlRuntimeError:d,RqlServerError:d,ReqlQueryLogicError:h,ReqlNonExistenceError:a,ReqlResourceLimitError:y,ReqlUserError:g,ReqlInternalError:u,ReqlTimeoutError:m,ReqlAvailabilityError:n,ReqlOpFailedError:p,ReqlOpIndeterminateError:l,ReqlPermissionError:f,ReqlDriverError:s,RqlDriverError:s,ReqlAuthError:r,printQuery:_.prototype.printQuery}},function(t,e,r){var n=r(70),o=[8,9,10,11,12,13,14,15];function i(t,e){if(this instanceof i==!1)throw new TypeError("Classes can't be function-called");this._options=t||{},this._isServer=!!e,this._inflate=null,this._deflate=null,this.params=null}i.extensionName="permessage-deflate",i.prototype.offer=function(){var t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(t.client_max_window_bits=!0),t},i.prototype.accept=function(t){var e;return t=this.normalizeParams(t),e=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params=e,e},i.prototype.cleanup=function(){this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate&&(this._deflate.close(),this._deflate=null)},i.prototype.acceptAsServer=function(t){var e={};if(!t.some((function(t){if(e={},(!1!==this._options.serverNoContextTakeover||!t.server_no_context_takeover)&&(!1!==this._options.serverMaxWindowBits||!t.server_max_window_bits)&&!("number"==typeof this._options.serverMaxWindowBits&&"number"==typeof t.server_max_window_bits&&this._options.serverMaxWindowBits>t.server_max_window_bits)&&("number"!=typeof this._options.clientMaxWindowBits||t.client_max_window_bits))return(this._options.serverNoContextTakeover||t.server_no_context_takeover)&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),!1!==this._options.clientNoContextTakeover&&t.client_no_context_takeover&&(e.client_no_context_takeover=!0),"number"==typeof this._options.serverMaxWindowBits?e.server_max_window_bits=this._options.serverMaxWindowBits:"number"==typeof t.server_max_window_bits&&(e.server_max_window_bits=t.server_max_window_bits),"number"==typeof this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:!1!==this._options.clientMaxWindowBits&&"number"==typeof t.client_max_window_bits&&(e.client_max_window_bits=t.client_max_window_bits),!0}),this))throw new Error("Doesn't support the offered configuration");return e},i.prototype.acceptAsClient=function(t){var e=t[0];if(null!=this._options.clientNoContextTakeover&&!1===this._options.clientNoContextTakeover&&e.client_no_context_takeover)throw new Error('Invalid value for "client_no_context_takeover"');if(null!=this._options.clientMaxWindowBits){if(!1===this._options.clientMaxWindowBits&&e.client_max_window_bits)throw new Error('Invalid value for "client_max_window_bits"');if("number"==typeof this._options.clientMaxWindowBits&&(!e.client_max_window_bits||e.client_max_window_bits>this._options.clientMaxWindowBits))throw new Error('Invalid value for "client_max_window_bits"')}return e},i.prototype.normalizeParams=function(t){return t.map((function(t){return Object.keys(t).forEach((function(e){var r=t[e];if(r.length>1)throw new Error("Multiple extension parameters for "+e);switch(r=r[0],e){case"server_no_context_takeover":case"client_no_context_takeover":if(!0!==r)throw new Error("invalid extension parameter value for "+e+" ("+r+")");t[e]=!0;break;case"server_max_window_bits":case"client_max_window_bits":if("string"==typeof r&&(r=parseInt(r,10),!~o.indexOf(r)))throw new Error("invalid extension parameter value for "+e+" ("+r+")");if(!this._isServer&&!0===r)throw new Error("Missing extension parameter value for "+e);t[e]=r;break;default:throw new Error("Not defined extension parameter ("+e+")")}}),this),t}),this)},i.prototype.decompress=function(t,e,r){var o=this._isServer?"client":"server";if(!this._inflate){var i=this.params[o+"_max_window_bits"];this._inflate=n.createInflateRaw({windowBits:"number"==typeof i?i:15})}var s=this,c=[];function u(t){p(),r(t)}function a(t){c.push(t)}function p(){s._inflate&&(s._inflate.removeListener("error",u),s._inflate.removeListener("data",a),e&&s.params[o+"_no_context_takeover"]&&(s._inflate.close(),s._inflate=null))}this._inflate.on("error",u).on("data",a),this._inflate.write(t),e&&this._inflate.write(new Buffer([0,0,255,255])),this._inflate.flush((function(){p(),r(null,Buffer.concat(c))}))},i.prototype.compress=function(t,e,r){var o=this._isServer?"server":"client";if(!this._deflate){var i=this.params[o+"_max_window_bits"];this._deflate=n.createDeflateRaw({flush:n.Z_SYNC_FLUSH,windowBits:"number"==typeof i?i:15,memLevel:this._options.memLevel||8})}var s=this,c=[];function u(t){p(),r(t)}function a(t){c.push(t)}function p(){s._deflate&&(s._deflate.removeListener("error",u),s._deflate.removeListener("data",a),e&&s.params[o+"_no_context_takeover"]&&(s._deflate.close(),s._deflate=null))}this._deflate.on("error",u).on("data",a),this._deflate.write(t),this._deflate.flush((function(){p();var t=Buffer.concat(c);e&&(t=t.slice(0,t.length-4)),r(null,t)}))},t.exports=i},function(t,e,r){var n,o,i;o=r(15),i=r(26),n=r(8),i.connect=o.connect,i.Error=n,i._bluebird=r(4),t.exports=i,t.exports.net=o},function(t,e,r){"use strict";r.r(e),function(t){r.d(e,"configureTcpPolyfill",(function(){return l})),r.d(e,"setIsConnected",(function(){return f})),r.d(e,"Socket",(function(){return h})),r.d(e,"connect",(function(){return _})),r.d(e,"createConnection",(function(){return y})),r.d(e,"createServer",(function(){return d})),r.d(e,"isIPv4",(function(){return v})),r.d(e,"isIPv6",(function(){return m})),r.d(e,"isIP",(function(){return g}));var n=r(27),o=r.n(n),i=r(28),s=r.n(i),c=r(29);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a={path:"/",secure:!1,wsProtocols:void 0,wsBinaryType:void 0,simulatedLatencyMs:void 0,waitForPacket:!1,isConnected:!1},p=function(t){return function(){throw new Error("Not implemented in TcpPolyfill: "+t)}};function l(t){a.path=t.path,a.secure=t.secure,a.wsProtocols=t.wsProtocols,a.wsBinaryType=t.wsBinaryType,a.simulatedLatencyMs=t.simulatedLatencyMs,a.waitForPacket=t.waitForPacket,a.isConnected=!1}function f(){a.isConnected=!0}function h(e){var r=this;if(!(this instanceof h))return new h(e);var n=new s.a({});["on","once","removeListener","emit","addListener","removeAllListeners","setMaxListeners","listeners"].forEach((function(t){r[t]=n[t].bind(n)}));var i=null;this.connect=function(e,s,u){r._simulatedLatencyMs=a.simulatedLatencyMs;var p=a.secure?"wss":"ws",l=a.path,f="".concat(p,"://").concat(s,":").concat(e).concat(l),h=new c.a;i=new t(f,a.wsProtocols),a.wsBinaryType&&(i.binaryType=a.wsBinaryType),u&&n.on("connect",u),i.onopen=function(t){n.emit("connect")},i.onclose=function(t){n.emit("end"),n.emit("close")},i.onerror=function(t){n.emit("error",t)},i.onmessage=function(t){var e=t.data,r="string"==typeof e&&"base64"===i.protocol,s=a.wsProtocols&&a.wsProtocols.constructor===Array&&a.wsProtocols.indexOf("base64")>=0,c="undefined"!=typeof navigator&&"ReactNative"===navigator.product&&s&&!i.protocol,u=r||c,p=a.waitForPacket&&a.isConnected;if("undefined"!=typeof Blob&&e instanceof Blob)o()(e,(function(t,e){if(t)throw t;n.emit("data",e)}));else if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){if(6===e.byteLength&&"logout"===Buffer.from(e).toString())return n.emit("logout");if(p){h.addChunk(Buffer.from(e));for(var l=h.read();l;)n.emit("data",l),l=h.read()}else n.emit("data",Buffer.from(e))}else u?n.emit("data",new Buffer(e,"base64")):n.emit("data",e)}},this.end=function(t){void 0!==t&&r.write(t),i.close()},this.destroy=function(){i.close()},this.write=function(t){var e=null;if("base64"===i.protocol)e=new Buffer(t).toString("base64");else{for(var n=new ArrayBuffer(t.length),o=new Uint8Array(n),s=0;s<t.length;++s)o[s]=t[s];e=n}var c=r._simulatedLatencyMs;"number"==typeof c&&c>0?setTimeout((function(){return i.send(e)}),c):i.send(e)},this.setNoDelay=function(t){},this.setKeepAlive=function(t,e){};["setEncoding","pause","resume","setTimeout","address","unref","ref"].forEach((function(t){r[t]=p(t)}))}function _(){for(var t={},e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r[0]&&"object"===u(r[0]))t.port=r[0].port,t.host=r[0].host,t.connectListener=r[1];else{if(!(Number(r[0])>0))throw new Error("Unsupported arguments for net.connect");t.port=r[0],t.host=r[1],t.connectListener=r[2]}var o=new h;return o.connect(t.port,t.host,t.connectListener),o}var y=_,d=p("createServer"),v=function(t){return!0},m=function(t){return!1},g=function(t){return v(t)?4:m(t)?6:0}}.call(this,r(64))},function(t,e){t.exports=require("crypto")},function(t,e,r){var n,o,i,s,c,u,a,p,l,f,h=[].slice;o=r(8),l=r(5),p=l.Response.ErrorType,a=function(t){return 1===t?"":"s"},t.exports.ar=function(t){return function(){var e;if((e=1<=arguments.length?h.call(arguments,0):[]).length!==t.length)throw new o.ReqlDriverCompileError("Expected "+t.length+" argument"+a(t.length)+" but found "+e.length+".");return t.apply(this,e)}},t.exports.varar=function(t,e,r){return function(){var n;if(n=1<=arguments.length?h.call(arguments,0):[],null!=t&&n.length<t||null!=e&&n.length>e){if(null!=t&&null==e)throw new o.ReqlDriverCompileError("Expected "+t+" or more arguments but found "+n.length+".");if(null!=e&&null==t)throw new o.ReqlDriverCompileError("Expected "+e+" or fewer arguments but found "+n.length+".");throw new o.ReqlDriverCompileError("Expected between "+t+" and "+e+" arguments but found "+n.length+".")}return r.apply(this,n)}},t.exports.aropt=function(t){return function(){var e,r,n,i;if(null!=(i=(e=1<=arguments.length?h.call(arguments,0):[])[r=t.length-1])&&"[object Object]"!==Object.prototype.toString.call(i)&&(i=null),r!==(n=e.length-(null!=i?1:0)))throw 1!==r?new o.ReqlDriverCompileError("Expected "+r+" arguments (not including options) but found "+n+"."):new o.ReqlDriverCompileError("Expected "+r+" argument (not including options) but found "+n+".");return t.apply(this,e)}},t.exports.toArrayBuffer=function(t){var e,r,n,o,i;for(e=new Uint8Array(new ArrayBuffer(t.length)),r=n=0,o=t.length;n<o;r=++n)i=t[r],e[r]=i;return e.buffer},t.exports.fromCamelCase=function(t){return t.replace(/[A-Z]/g,(function(t){return"_"+t.toLowerCase()}))},t.exports.toCamelCase=function(t){return t.replace(/_[a-z]/g,(function(t){return t[1].toUpperCase()}))},n=function(t,e){var r,n,i,s,c;switch(t.$reql_type$){case"TIME":switch(e.timeFormat){case"native":case void 0:if(null==t.epoch_time)throw new o.ReqlDriverError("pseudo-type TIME "+t+" object missing expected field 'epoch_time'.");return new Date(1e3*t.epoch_time);case"raw":return t;default:throw new o.ReqlDriverError("Unknown timeFormat run option "+e.timeFormat+".")}break;case"GROUPED_DATA":switch(e.groupFormat){case"native":case void 0:for(c=[],n=0,i=(s=t.data).length;n<i;n++)r=s[n],c.push({group:r[0],reduction:r[1]});return c;case"raw":return t;default:throw new o.ReqlDriverError("Unknown groupFormat run option "+e.groupFormat+".")}break;case"BINARY":switch(e.binaryFormat){case"native":case void 0:if(null==t.data)throw new o.ReqlDriverError("pseudo-type BINARY object missing expected field 'data'.");return new Buffer(t.data,"base64");case"raw":return t;default:throw new o.ReqlDriverError("Unknown binaryFormat run option "+e.binaryFormat+".")}break;default:return t}},f=function(t,e){var r,o,i,s,c;if(Array.isArray(t))for(r=o=0,s=t.length;o<s;r=++o)c=t[r],t[r]=f(c,e);else if(t&&"object"==typeof t){for(i in t)c=t[i],t[i]=f(c,e);t=n(t,e)}return t},s=function(t,e){return f(t.r[0],e)},u=function(t,e){return f(t.r,e)},c=function(t,e,r){return new t(s(e),r,e.b)},i=function(t){switch(t){case p.QUERY_LOGIC:return o.ReqlQueryLogicError;case p.NON_EXISTENCE:return o.ReqlNonExistenceError;case p.RESOURCE_LIMIT:return o.ReqlResourceLimitError;case p.USER:return o.ReqlUserError;case p.INTERNAL:return o.ReqlInternalError;case p.OP_FAILED:return o.ReqlOpFailedError;case p.OP_INDETERMINATE:return o.ReqlOpIndeterminateError;case p.PERMISSION_ERROR:return o.ReqlPermissionError;default:return o.ReqlRuntimeError}},t.exports.recursivelyConvertPseudotype=f,t.exports.mkAtom=s,t.exports.mkSeq=u,t.exports.mkErr=c,t.exports.errorClass=i},function(t,e,r){"use strict";var n=r(0),o=n.maybeWrapAsError,i=r(1),s=i.TimeoutError,c=i.OperationalError,u=n.haveGetters,a=r(7);var p,l=/^(?:name|message|stack|cause)$/;function f(t){var e;if(function(t){return t instanceof Error&&a.getPrototypeOf(t)===Error.prototype}(t)){(e=new c(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var r=a.keys(t),o=0;o<r.length;++o){var i=r[o];l.test(i)||(e[i]=t[i])}return e}return n.markAsOriginatingFromRejection(t),t}function h(t){return function(e,r){if(null!==t){if(e){var n=f(o(e));t._attachExtraTrace(n),t._reject(n)}else if(arguments.length>2){for(var i=arguments.length,s=new Array(i-1),c=1;c<i;++c)s[c-1]=arguments[c];t._fulfill(s)}else t._fulfill(r);t=null}}}if(p=u?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=h(t),this.callback=this.asCallback},u){var _={get:function(){return h(this.promise)}};a.defineProperty(p.prototype,"asCallback",_),a.defineProperty(p.prototype,"callback",_)}p._nodebackForPromise=h,p.prototype.toString=function(){return"[object PromiseResolver]"},p.prototype.resolve=p.prototype.fulfill=function(t){if(!(this instanceof p))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(t)},p.prototype.reject=function(t){if(!(this instanceof p))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(t)},p.prototype.progress=function(t){if(!(this instanceof p))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(t)},p.prototype.cancel=function(t){this.promise.cancel(t)},p.prototype.timeout=function(){this.reject(new s("timeout"))},p.prototype.isResolved=function(){return this.promise.isResolved()},p.prototype.toJSON=function(){return this.promise.toJSON()},t.exports=p},function(t,e,r){var n,o,i,s,c,u,a,p,l,f,h,_,y,d,v,m,g,w,b,E,O,S,k,C=function(t,e){for(var r in e)R.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},R={}.hasOwnProperty;_=r(11),O=r(25),l=r(6),S=r(13),p=r(8),a=r(77),b=r(5),u=r(12),g=b.VersionDummy.Version.V1_0,w=0,d=b.VersionDummy.Protocol.JSON,v=b.Query.QueryType,m=b.Response.ResponseType,E=r(26),i=r(4),c=S.ar,k=S.varar,S.aropt,f=S.mkAtom,h=S.mkErr,n=function(t){function e(t,e){var r,n,o;void 0===t?t={}:"string"==typeof t&&(t={host:t}),this.host=t.host||this.DEFAULT_HOST,this.port=t.port||this.DEFAULT_PORT,this.db=t.db,this.authKey=t.authKey||this.DEFAULT_AUTH_KEY,this.timeout=t.timeout||this.DEFAULT_TIMEOUT,"boolean"==typeof t.ssl&&t.ssl?this.ssl={}:"object"==typeof t.ssl?this.ssl=t.ssl:this.ssl=!1,this.outstandingCallbacks={},this.nextToken=1,this.open=!1,this.closing=!1,this.buffer=new Buffer(0),this._events=this._events||{},o=this,n=function(t){return o.removeListener("connect",r),t instanceof p.ReqlError?e(t):e(new p.ReqlDriverError("Could not connect to "+o.host+":"+o.port+".\n"+t.message))},this.once("error",n),r=function(t){return function(){return t.removeListener("error",n),t.open=!0,e(null,t)}}(this),this.once("connect",r),this._closePromise=null}return C(e,t),e.prototype.DEFAULT_HOST="localhost",e.prototype.DEFAULT_PORT=28015,e.prototype.DEFAULT_AUTH_KEY="",e.prototype.DEFAULT_TIMEOUT=20,e.prototype._data=function(t){var e,r,n,o,i;for(this.buffer=Buffer.concat([this.buffer,t]),o=[];this.buffer.length>=12&&(i=this.buffer.readUInt32LE(0)+4294967296*this.buffer.readUInt32LE(4),n=this.buffer.readUInt32LE(8),this.buffer.length>=12+n);)r=this.buffer.slice(12,n+12),e=JSON.parse(r),this._processResponse(e,i),o.push(this.buffer=this.buffer.slice(12+n));return o},e.prototype._delQuery=function(t){return delete this.outstandingCallbacks[t]},e.prototype._processResponse=function(t,e){var r,n,o,i,s,c,u,l,_,y;if(u=t.p,null!=this.outstandingCallbacks[e])if(r=(l=this.outstandingCallbacks[e]).cb,y=l.root,n=l.cursor,c=l.opts,l.feed,null!=n){if(n._addResponse(t),n._endFlag&&0===n._outstandingRequests)return this._delQuery(e)}else if(null!=r)switch(t.t){case m.COMPILE_ERROR:return r(h(p.ReqlServerCompileError,t,y)),this._delQuery(e);case m.CLIENT_ERROR:return r(h(p.ReqlDriverError,t,y)),this._delQuery(e);case m.RUNTIME_ERROR:return o=S.errorClass(t.e),r(h(o,t,y)),this._delQuery(e);case m.SUCCESS_ATOM:return t=f(t,c),Array.isArray(t)&&(t=a.makeIterable(t)),null!=u&&(t={profile:u,value:t}),r(null,t),this._delQuery(e);case m.SUCCESS_PARTIAL:for(n=null,i=0,s=(_=t.n).length;i<s;i++)switch(_[i]){case b.Response.ResponseNote.SEQUENCE_FEED:null==n&&(n=new a.Feed(this,e,c,y));break;case b.Response.ResponseNote.UNIONED_FEED:null==n&&(n=new a.UnionedFeed(this,e,c,y));break;case b.Response.ResponseNote.ATOM_FEED:null==n&&(n=new a.AtomFeed(this,e,c,y));break;case b.Response.ResponseNote.ORDER_BY_LIMIT_FEED:null==n&&(n=new a.OrderByLimitFeed(this,e,c,y))}return null==n&&(n=new a.Cursor(this,e,c,y)),this.outstandingCallbacks[e].cursor=n,r(null,null!=u?{profile:u,value:n._addResponse(t)}:n._addResponse(t));case m.SUCCESS_SEQUENCE:return n=new a.Cursor(this,e,c,y),this._delQuery(e),r(null,null!=u?{profile:u,value:n._addResponse(t)}:n._addResponse(t));case m.WAIT_COMPLETE:return this._delQuery(e),r(null,null);case m.SERVER_INFO:return this._delQuery(e),r(null,t=f(t,c));default:return r(new p.ReqlDriverError("Unknown response type"))}},e.prototype.close=k(0,2,(function(t,e){var r,n,o,s,c;if(null!=e){if(s=t,"[object Object]"!==Object.prototype.toString.call(s))throw new p.ReqlDriverError("First argument to two-argument `close` must be an object.");r=e}else"[object Object]"===Object.prototype.toString.call(t)?(s=t,r=null):"function"==typeof t?(s={},r=t):(s=t,r=null);for(n in s)if(R.call(s,n)&&"noreplyWait"!==n)throw new p.ReqlDriverError("First argument to two-argument `close` must be { noreplyWait: <bool> }.");return null!=this._closePromise?this._closePromise.nodeify(r):(this.closing=!0,o=(null==s.noreplyWait||s.noreplyWait)&&this.open,this._closePromise=new i((c=this,function(t,e){var r;return r=function(r,n){return c.open=!1,c.closing=!1,c.cancel(),null!=r?e(r):t(n)},o?c.noreplyWait(r):r()})).nodeify(r))})),e.prototype.noreplyWait=k(0,1,(function(t){var e,r,n;return this.open?(r=this.nextToken++,(e={}).type=v.NOREPLY_WAIT,e.token=r,new i((n=this,function(t,o){var i;return i=function(e,r){return e?o(e):t(r)},n.outstandingCallbacks[r]={cb:i,root:null,opts:null},n._sendQuery(e)})).nodeify(t)):new i((function(t,e){return e(new p.ReqlDriverError("Connection is closed."))})).nodeify(t)})),e.prototype.server=k(0,1,(function(t){var e,r,n;return this.open?(r=this.nextToken++,(e={}).type=v.SERVER_INFO,e.token=r,new i((n=this,function(t,o){var i;return i=function(e,r){return e?o(e):t(r)},n.outstandingCallbacks[r]={cb:i,root:null,opts:null},n._sendQuery(e)})).nodeify(t)):new i((function(t,e){return e(new p.ReqlDriverError("Connection is closed."))})).nodeify(t)})),e.prototype.cancel=c((function(){var t,e,r,n;for(t in r={t:m.RUNTIME_ERROR,r:["Connection is closed."],b:[]},e=this.outstandingCallbacks)R.call(e,t)&&(null!=(n=e[t]).cursor?n.cursor._addResponse(r):null!=n.cb&&n.cb(h(S.errorClass(r.e),r,n.root)));return this.outstandingCallbacks={}})),e.prototype.reconnect=k(0,2,(function(t,e){var r,n,o;return null!=e?(n=t,r=e):"function"==typeof t?(n={},r=t):(n=null!=t?t:{},r=e),new i((o=this,function(t,e){var r;return r=function(r){return o.constructor.call(o,{host:o.host,port:o.port,timeout:o.timeout,authKey:o.authKey},(function(r,n){return null!=r?e(r):t(n)}))},o.close(n,r)})).nodeify(r)})),e.prototype.use=c((function(t){return this.db=t})),e.prototype.isOpen=function(){return this.open&&!this.closing},e.prototype._start=function(t,e,r){var n,o,i,s;if(!this.open)throw new p.ReqlDriverError("Connection is closed.");for(n in i=this.nextToken++,(o={}).global_optargs={},o.type=v.START,o.query=t.build(),o.token=i,r)R.call(r,n)&&(s=r[n],o.global_optargs[S.fromCamelCase(n)]=E.expr(s).build());if(null==r.db&&null==this.db||(o.global_optargs.db=E.db(r.db||this.db).build()),null!=r.noreply&&(o.global_optargs.noreply=E.expr(!!r.noreply).build()),null!=r.profile&&(o.global_optargs.profile=E.expr(!!r.profile).build()),null!=r.noreply&&r.noreply||(this.outstandingCallbacks[i]={cb:e,root:t,opts:r}),this._sendQuery(o),null!=r.noreply&&r.noreply&&"function"==typeof e)return e(null)},e.prototype._continueQuery=function(t){var e;if(!this.open)throw new p.ReqlDriverError("Connection is closed.");return e={type:v.CONTINUE,token:t},this._sendQuery(e)},e.prototype._endQuery=function(t){var e;if(!this.open)throw new p.ReqlDriverError("Connection is closed.");return e={type:v.STOP,token:t},this._sendQuery(e)},e.prototype._sendQuery=function(t){var e;return e=[t.type],void 0!==t.query&&(e.push(t.query),null!=t.global_optargs&&Object.keys(t.global_optargs).length>0&&e.push(t.global_optargs)),this._writeQuery(t.token,JSON.stringify(e))},e}(l.EventEmitter),y={},s=function(t){function e(t,r){var n,o;if(!e.isAvailable())throw new p.ReqlDriverError("TCP sockets are not available in this environment");e.__super__.constructor.call(this,t,r),this.ssl?(this.ssl.host=this.host,this.ssl.port=this.port,this.rawSocket=O.connect(this.ssl)):this.rawSocket=_.connect(this.port,this.host),this.rawSocket.setNoDelay(),this.rawSocket.setKeepAlive(!0),n=setTimeout((o=this,function(){return o.rawSocket.destroy(),o.emit("error",new p.ReqlTimeoutError("Could not connect to "+o.host+":"+o.port+", operation timed out."))}),1e3*this.timeout),this.rawSocket.once("error",(function(){return clearTimeout(n)})),this.rawSocket.once("connect",function(e){return function(){var r,o,i,s,c,a,l,f,h,_,v,m,b,E,O,S,k,C;return(k=new Buffer(4)).writeUInt32LE(g,0),new Buffer(4).writeUInt32LE(d,0),b=new Buffer(u.randomBytes(18)).toString("base64"),e.rawSocket.user=t.user,e.rawSocket.password=t.password,void 0===e.rawSocket.user&&(e.rawSocket.user="admin"),void 0===e.rawSocket.password&&(e.rawSocket.password=""),s="n="+e.rawSocket.user+",r="+b,h=JSON.stringify({protocol_version:w,authentication_method:"SCRAM-SHA-256",authentication:"n,,"+s}),v=new Buffer("\0","binary"),e.rawSocket.write(Buffer.concat([k,Buffer(h.toString()),v])),S=1,_=0,f=0,E="",O="",o="",i="",r=0,C=function(t,e){var r,n,o,i;for(i=[],r=n=0,o=Math.min(t.length,e.length);0<=o?n<o:n>o;r=0<=o?++n:--n)i.push(t[r]^e[r]);return new Buffer(i)},m=function(t,e,r){var n,o,i,s,c,a;if(n=t.toString("base64")+","+e.toString("base64")+","+r.toString(),y[n])return y[n];for((i=u.createHmac("sha256",t)).update(e),i.update("\0\0\0"),c=a=i.digest(),o=0,s=r-1;0<=s?o<s:o>s;0<=s?++o:--o)(i=u.createHmac("sha256",t)).update(c),c=i.digest(),a=C(a,c);return y[n]=a,a},c=function(t,e){var r,n,o,i,s,c;for(o=void 0,c=e,s=void 0,t.length===e.length&&(o=t,s=0),t.length!==e.length&&(o=e,s=1),r=n=0,i=Math.min(o.length,c.length);0<=i?n<i:n>i;r=0<=i?++n:--n)s|=o[r]^c[r];return 0===s},l=function(t,r){return 10<=t&&t<=20?e.emit("error",new p.ReqlAuthError(r)):e.emit("error",new p.ReqlDriverError(r))},a=function(t){var y,d,g,k,R,T,x,j,A,N,P,F,I,D,L,U,B,M,q,H,V,W,Q,G;for(e.buffer=Buffer.concat([e.buffer,t]),P=0,A=F=0,D=(U=e.buffer).length;F<D;A=++F)if(0===U[A]){V=e.buffer.slice(P,A),P=A+1,W=V.toString();try{H=JSON.parse(W)}catch(x){throw x,new p.ReqlDriverError(W)}if(1===S){if(!H.success)return void l(H.error_code,H.error);if(_=H.min_protocol_version,f=H.max_protocol_version,_>w||f<w)throw new p.ReqlDriverError("Unsupported protocol version "+w+", expected between "+_+" and "+f+".");S=2}else if(2===S){if(!H.success)return void l(H.error_code,H.error);for(d={},I=0,L=(B=(E=H.authentication).split(",")).length;I<L;I++)A=(N=B[I]).indexOf("="),d[N.slice(0,A)]=N.slice(A+1);if(o=d.r,i=new Buffer(d.s,"base64"),r=parseInt(d.i),o.substr(0,b.length)!==b)throw new p.ReqlAuthError("Invalid nonce from server");g="c=biws,r="+o,M=m(e.rawSocket.password,i,r),k=u.createHmac("sha256",M).update("Client Key").digest(),Q=u.createHash("sha256").update(k).digest(),y=s+","+E+","+g,T=u.createHmac("sha256",Q).update(y).digest(),R=C(k,T),q=u.createHmac("sha256",M).update("Server Key").digest(),O=u.createHmac("sha256",q).update(y).digest(),S=3,h=JSON.stringify({authentication:g+",p="+R.toString("base64")}),v=new Buffer("\0","binary"),e.rawSocket.write(Buffer.concat([Buffer(h.toString()),v]))}else{if(3!==S)throw new p.ReqlDriverError("Unexpected handshake state");if(!H.success)return void l(H.error_code,H.error);if(j=H.authentication.indexOf("="),G=H.authentication.slice(j+1),!c(G,O.toString("base64")))throw new p.ReqlAuthError("Invalid server signature");S=4,e.rawSocket.removeListener("data",a),e.rawSocket.on("data",(function(t){return e._data(t)})),clearTimeout(n),e.emit("connect")}}return e.buffer=e.buffer.slice(P+1)},e.rawSocket.on("data",a)}}(this)),this.rawSocket.on("error",function(t){return function(e){return t.emit("error",e)}}(this)),this.rawSocket.on("close",function(t){return function(){return t.isOpen()&&t.close({noreplyWait:!1}),t.emit("close")}}(this)),this.rawSocket.on("timeout",function(t){return function(){return t.open=!1,t.emit("timeout")}}(this))}return C(e,t),e.isAvailable=function(){return!process.browser},e.prototype.clientPort=function(){return this.rawSocket.localPort},e.prototype.clientAddress=function(){return this.rawSocket.localAddress},e.prototype.close=k(0,2,(function(t,r){var n,o,s;return null!=r?(o=t,n=r):"[object Object]"===Object.prototype.toString.call(t)?(o=t,n=null):"function"==typeof t?(o={},n=t):o={},new i((s=this,function(t,r){var n;return n=function(e,n){var o,i,c;return i=function(){return null!=e?r(e):t(n)},o=function(){var t;return i(),null!=(t=s.rawSocket)&&t.removeAllListeners(),s.rawSocket=null,s.emit("close")},null!=s.rawSocket?"closed"===s.rawSocket.readyState?o():(null!=(c=s.rawSocket)&&c.once("close",o),s.rawSocket.end()):process.nextTick(i)},e.__super__.close.call(s,o,n)})).nodeify(n)})),e.prototype.cancel=function(){return this.rawSocket.destroy(),e.__super__.cancel.call(this)},e.prototype._writeQuery=function(t,e){var r;return(r=new Buffer(8)).writeUInt32LE(4294967295&t,0),r.writeUInt32LE(Math.floor(t/4294967295),4),this.rawSocket.write(r),this.write(new Buffer(e))},e.prototype.write=function(t){var e;return(e=new Buffer(4)).writeUInt32LE(t.length,0),this.rawSocket.write(e),this.rawSocket.write(t)},e}(n),o=function(t){function e(t,r){var n,o,i,s;if(!e.isAvailable())throw new p.ReqlDriverError("XMLHttpRequest is not available in this environment");e.__super__.constructor.call(this,t,r),n="https"===t.protocol?"https":this.DEFAULT_PROTOCOL,o=n+"://"+this.host+":"+this.port+t.pathname+"ajax/reql/",(i=new XMLHttpRequest).open("POST",o+"open-new-connection?cacheBuster="+Math.random(),!0),i.responseType="text",i.onreadystatechange=(s=this,function(t){if(4===i.readyState)return 200===i.status?(s._url=o,s._connId=i.response,s.emit("connect")):s.emit("error",new p.ReqlDriverError("XHR error, http status "+i.status+"."))}),i.send(),this.xhr=i}return C(e,t),e.prototype.DEFAULT_PROTOCOL="http",e.isAvailable=function(){return"undefined"!=typeof XMLHttpRequest},e.prototype.cancel=function(){var t;if(null!=this._connId)return this.xhr.abort(),(t=new XMLHttpRequest).open("POST",this._url+"close-connection?conn_id="+this._connId,!0),t.responseType="arraybuffer",t.send(),this._url=null,this._connId=null,e.__super__.cancel.call(this)},e.prototype.close=k(0,2,(function(t,r){var n,o;if(null!=r?(o=t,n=r):"[object Object]"===Object.prototype.toString.call(t)?(o=t,n=null):(o={},n=t),null!=n&&"function"!=typeof n)throw new p.ReqlDriverError("Final argument to `close` must be a callback function or object.");return e.__super__.close.call(this,o,n)})),e.prototype._writeQuery=function(t,e){var r;return(r=new Buffer(encodeURI(e).split(/%..|./).length-1+8)).writeUInt32LE(4294967295&t,0),r.writeUInt32LE(Math.floor(t/4294967295),4),r.write(e,8),this.write(r,t)},e.prototype.write=function(t,e){var r,n,o,i;for((o=new XMLHttpRequest).open("POST",this._url+"?conn_id="+this._connId,!0),o.responseType="arraybuffer",o.onreadystatechange=(i=this,function(t){var e,r;if(4===o.readyState&&200===o.status)return r=new Buffer(function(){var t,r,n,i;for(i=[],t=0,r=(n=new Uint8Array(o.response)).length;t<r;t++)e=n[t],i.push(e);return i}()),i._data(r)}),o.onerror=function(t){return function(r){return t.outstandingCallbacks[e].cb(new Error("This HTTP connection is not open"))}}(this),n=new Uint8Array(t.length),r=0;r<t.length;)n[r]=t[r],r++;return o.send(n),this.xhr=o},e}(n),t.exports.isConnection=function(t){return t instanceof n},t.exports.connect=k(0,2,(function(t,e){var r;return"function"==typeof t?(r={},e=t):r=t||{},new i((function(t,e){if(null!=r.authKey&&(null!=r.password||null!=r.user||null!=r.username))throw new p.ReqlDriverError("Cannot use both authKey and password");if(r.user&&r.username)throw new p.ReqlDriverError("Cannot use both user and username");return r.authKey?(r.user="admin",r.password=r.authKey):null!=r.username&&(r.user=r.username),function(t,e){if(s.isAvailable())return new s(t,e);if(o.isAvailable())return new o(t,e);throw new p.ReqlDriverError("Neither TCP nor HTTP avaiable in this environment")}(r,(function(r,n){return r?e(r):t(n)}))})).nodeify(e)})),t.exports.Connection=n,t.exports.HttpConnection=o,t.exports.TcpConnection=s},function(t,e,r){"use strict";
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */var n=r(17),o=r(3),i=r(18),s=r(65),c=r(12),u=r(66),a=r(67),p=r(19),l=r(20),f=r(23),h=r(74),_=r(75),y=r(24),d=r(9),v=r(6).EventEmitter,m=13;function g(t,e,r){if(this instanceof g==!1)return new g(t,e,r);v.call(this),e&&!Array.isArray(e)&&"object"==typeof e&&(r=e,e=null),"string"==typeof e&&(e=[e]),Array.isArray(e)||(e=[]),this._socket=null,this._ultron=null,this._closeReceived=!1,this.bytesReceived=0,this.readyState=null,this.supports={},this.extensions={},Array.isArray(t)?S.apply(this,t.concat(r)):k.apply(this,[t,e,r])}function w(t,e,r){this.type="message",this.data=t,this.target=r,this.binary=e}function b(t,e,r){this.type="close",this.wasClean=void 0===t||1e3===t,this.code=t,this.reason=e,this.target=r}function E(t){this.type="open",this.target=t}function O(t,e,r){var n=e;return e&&(t&&443!=r||!t&&80!=r)&&(n=n+":"+r),n}function S(t,e,r,n){n=new p({protocolVersion:m,protocol:null,extensions:{}}).merge(n),this.protocol=n.value.protocol,this.protocolVersion=n.value.protocolVersion,this.extensions=n.value.extensions,this.supports.binary="hixie-76"!==this.protocolVersion,this.upgradeReq=t,this.readyState=g.CONNECTING,this._isServer=!0,"hixie-76"===n.value.protocolVersion?C.call(this,_,h,e,r):C.call(this,f,l,e,r)}function k(t,e,r){if(8!==(r=new p({origin:null,protocolVersion:m,host:null,headers:null,protocol:e.join(","),agent:null,pfx:null,key:null,passphrase:null,cert:null,ca:null,ciphers:null,rejectUnauthorized:null,perMessageDeflate:!0,localAddress:null}).merge(r)).value.protocolVersion&&13!==r.value.protocolVersion)throw new Error("unsupported protocol version");var o=n.parse(t),u="ws+unix:"===o.protocol;if(!o.host&&!u)throw new Error("invalid url");var a,h="wss:"===o.protocol||"https:"===o.protocol,_=h?s:i,v=o.port||(h?443:80),w=o.auth,b={};r.value.perMessageDeflate&&(a=new d(!0!==typeof r.value.perMessageDeflate?r.value.perMessageDeflate:{},!1),b[d.extensionName]=a.offer()),this._isServer=!1,this.url=t,this.protocolVersion=r.value.protocolVersion,this.supports.binary="hixie-76"!==this.protocolVersion;var E=new Buffer(r.value.protocolVersion+"-"+Date.now()).toString("base64"),S=c.createHash("sha1");S.update(E+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var k=S.digest("base64"),R=r.value.agent,T=O(h,o.hostname,v),j={port:v,host:o.hostname,headers:{Connection:"Upgrade",Upgrade:"websocket",Host:T,"Sec-WebSocket-Version":r.value.protocolVersion,"Sec-WebSocket-Key":E}};if(w&&(j.headers.Authorization="Basic "+new Buffer(w).toString("base64")),r.value.protocol&&(j.headers["Sec-WebSocket-Protocol"]=r.value.protocol),r.value.host&&(j.headers.Host=r.value.host),r.value.headers)for(var A in r.value.headers)r.value.headers.hasOwnProperty(A)&&(j.headers[A]=r.value.headers[A]);Object.keys(b).length&&(j.headers["Sec-WebSocket-Extensions"]=y.format(b)),(r.isDefinedAndNonNull("pfx")||r.isDefinedAndNonNull("key")||r.isDefinedAndNonNull("passphrase")||r.isDefinedAndNonNull("cert")||r.isDefinedAndNonNull("ca")||r.isDefinedAndNonNull("ciphers")||r.isDefinedAndNonNull("rejectUnauthorized"))&&(r.isDefinedAndNonNull("pfx")&&(j.pfx=r.value.pfx),r.isDefinedAndNonNull("key")&&(j.key=r.value.key),r.isDefinedAndNonNull("passphrase")&&(j.passphrase=r.value.passphrase),r.isDefinedAndNonNull("cert")&&(j.cert=r.value.cert),r.isDefinedAndNonNull("ca")&&(j.ca=r.value.ca),r.isDefinedAndNonNull("ciphers")&&(j.ciphers=r.value.ciphers),r.isDefinedAndNonNull("rejectUnauthorized")&&(j.rejectUnauthorized=r.value.rejectUnauthorized),R||(R=new _.Agent(j))),j.path=o.path||"/",R&&(j.agent=R),u&&(j.socketPath=o.pathname),r.value.localAddress&&(j.localAddress=r.value.localAddress),r.value.origin&&(r.value.protocolVersion<13?j.headers["Sec-WebSocket-Origin"]=r.value.origin:j.headers.Origin=r.value.origin);var N=this,P=_.request(j);P.on("error",(function(t){N.emit("error",t),x.call(N,t)})),P.once("response",(function(t){var e;N.emit("unexpected-response",P,t)||(e=new Error("unexpected server response ("+t.statusCode+")"),P.abort(),N.emit("error",e)),x.call(N,e)})),P.once("upgrade",(function(t,e,n){if(N.readyState===g.CLOSED)return N.emit("close"),N.removeAllListeners(),void e.end();var o=t.headers["sec-websocket-accept"];if(void 0===o||o!==k)return N.emit("error","invalid server key"),N.removeAllListeners(),void e.end();var i=t.headers["sec-websocket-protocol"],s=(r.value.protocol||"").split(/, */),c=null;if(!r.value.protocol&&i?c="server sent a subprotocol even though none requested":r.value.protocol&&!i?c="server sent no subprotocol even though requested":i&&-1===s.indexOf(i)&&(c="server responded with an invalid protocol"),c)return N.emit("error",c),N.removeAllListeners(),void e.end();i&&(N.protocol=i);var u=y.parse(t.headers["sec-websocket-extensions"]);if(a&&u[d.extensionName]){try{a.accept(u[d.extensionName])}catch(t){return N.emit("error","invalid extension parameter"),N.removeAllListeners(),void e.end()}N.extensions[d.extensionName]=a}C.call(N,f,l,e,n),P.removeAllListeners(),P=null,R=null})),P.end(),this.readyState=g.CONNECTING}function C(t,e,r,n){var o=this._ultron=new a(r),i=!1,s=this;function c(t){i||s.readyState===g.CLOSED||(i=!0,r.removeListener("data",c),o.on("data",u),n&&n.length>0&&(u(n),n=null),t&&u(t))}function u(t){s.bytesReceived+=t.length,s._receiver.add(t)}r.setTimeout(0),r.setNoDelay(!0),this._receiver=new t(this.extensions),this._socket=r,o.on("end",x.bind(this)),o.on("close",x.bind(this)),o.on("error",x.bind(this)),o.on("data",c),process.nextTick(c),s._receiver.ontext=function(t,e){e=e||{},s.emit("message",t,e)},s._receiver.onbinary=function(t,e){(e=e||{}).binary=!0,s.emit("message",t,e)},s._receiver.onping=function(t,e){e=e||{},s.pong(t,{mask:!s._isServer,binary:!0===e.binary},!0),s.emit("ping",t,e)},s._receiver.onpong=function(t,e){s.emit("pong",t,e||{})},s._receiver.onclose=function(t,e,r){r=r||{},s._closeReceived=!0,s.close(t,e)},s._receiver.onerror=function(t,e){s.close(void 0!==e?e:1002,""),s.emit("error",t,e)},this._sender=new e(r,this.extensions),this._sender.on("error",(function(t){s.close(1002,""),s.emit("error",t)})),this.readyState=g.OPEN,this.emit("open")}function R(t){t._queue=t._queue||[]}function T(t){var e=t._queue;if(void 0!==e){delete t._queue;for(var r=0,n=e.length;r<n;++r)e[r]()}}function x(t){if(this.readyState!==g.CLOSED){var e=this.readyState!==g.CONNECTING;if(this.readyState=g.CLOSED,clearTimeout(this._closeTimer),this._closeTimer=null,e&&(t&&(this._closeCode=1006),this.emit("close",this._closeCode||1e3,this._closeMessage||"")),this._socket){this._ultron&&this._ultron.destroy(),this._socket.on("error",(function(){try{this.destroy()}catch(t){}}));try{t?this._socket.destroy():this._socket.end()}catch(t){}this._socket=null,this._ultron=null}this._sender&&(this._sender.removeAllListeners(),this._sender=null),this._receiver&&(this._receiver.cleanup(),this._receiver=null),this.extensions[d.extensionName]&&this.extensions[d.extensionName].cleanup(),this.extensions=null,this.removeAllListeners(),this.on("error",(function(){})),delete this._queue}}o.inherits(g,v),["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(t,e){g.prototype[t]=g[t]=e})),g.prototype.close=function(t,e){if(this.readyState!==g.CLOSED)if(this.readyState!==g.CONNECTING)if(this.readyState!==g.CLOSING){var r=this;try{this.readyState=g.CLOSING,this._closeCode=t,this._closeMessage=e;var n=!this._isServer;this._sender.close(t,e,n,(function(t){t&&r.emit("error",t),r._closeReceived&&r._isServer?r.terminate():(clearTimeout(r._closeTimer),r._closeTimer=setTimeout(x.bind(r,!0),3e4))}))}catch(t){this.emit("error",t)}}else this._closeReceived&&this._isServer&&this.terminate();else this.readyState=g.CLOSED},g.prototype.pause=function(){if(this.readyState!==g.OPEN)throw new Error("not opened");return this._socket.pause()},g.prototype.ping=function(t,e,r){if(this.readyState!==g.OPEN){if(!0===r)return;throw new Error("not opened")}void 0===(e=e||{}).mask&&(e.mask=!this._isServer),this._sender.ping(t,e)},g.prototype.pong=function(t,e,r){if(this.readyState!==g.OPEN){if(!0===r)return;throw new Error("not opened")}void 0===(e=e||{}).mask&&(e.mask=!this._isServer),this._sender.pong(t,e)},g.prototype.resume=function(){if(this.readyState!==g.OPEN)throw new Error("not opened");return this._socket.resume()},g.prototype.send=function(t,e,r){if("function"==typeof e&&(r=e,e={}),this.readyState===g.OPEN)if(t||(t=""),this._queue){var n=this;this._queue.push((function(){n.send(t,e,r)}))}else{(e=e||{}).fin=!0,void 0===e.binary&&(e.binary=t instanceof ArrayBuffer||t instanceof Buffer||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array),void 0===e.mask&&(e.mask=!this._isServer),void 0===e.compress&&(e.compress=!0),this.extensions[d.extensionName]||(e.compress=!1);var o="function"==typeof u.Readable?u.Readable:u.Stream;if(t instanceof o){R(this);n=this;!function(t,e,r,n){e.on("data",(function(e){t.readyState===g.OPEN?(r.fin=!1,t._sender.send(e,r)):"function"==typeof n?n(new Error("not opened")):(delete t._queue,t.emit("error",new Error("not opened")))})),e.on("end",(function(){t.readyState===g.OPEN?(r.fin=!0,t._sender.send(null,r),"function"==typeof n&&n(null)):"function"==typeof n?n(new Error("not opened")):(delete t._queue,t.emit("error",new Error("not opened")))}))}(this,t,e,(function(t){process.nextTick((function(){T(n)})),"function"==typeof r&&r(t)}))}else this._sender.send(t,e,r)}else{if("function"!=typeof r)throw new Error("not opened");r(new Error("not opened"))}},g.prototype.stream=function(t,e){"function"==typeof t&&(e=t,t={});var r=this;if("function"!=typeof e)throw new Error("callback must be provided");if(this.readyState===g.OPEN)this._queue?this._queue.push((function(){r.stream(t,e)})):(void 0===(t=t||{}).mask&&(t.mask=!this._isServer),void 0===t.compress&&(t.compress=!0),this.extensions[d.extensionName]||(t.compress=!1),R(this),process.nextTick(e.bind(null,null,(function n(o,i){try{if(r.readyState!==g.OPEN)throw new Error("not opened");t.fin=!0===i,r._sender.send(o,t),i?T(r):process.nextTick(e.bind(null,null,n))}catch(t){"function"==typeof e?e(t):(delete r._queue,r.emit("error",t))}}))));else{if("function"!=typeof e)throw new Error("not opened");e(new Error("not opened"))}},g.prototype.terminate=function(){if(this.readyState!==g.CLOSED)if(this._socket){this.readyState=g.CLOSING;try{this._socket.end()}catch(t){return void x.call(this,!0)}this._closeTimer&&clearTimeout(this._closeTimer),this._closeTimer=setTimeout(x.bind(this,!0),3e4)}else this.readyState===g.CONNECTING&&x.call(this,!0)},Object.defineProperty(g.prototype,"bufferedAmount",{get:function(){var t=0;return this._socket&&(t=this._socket.bufferSize||0),t}}),["open","error","close","message"].forEach((function(t){Object.defineProperty(g.prototype,"on"+t,{get:function(){var e=this.listeners(t)[0];return e?e._listener?e._listener:e:void 0},set:function(e){this.removeAllListeners(t),this.addEventListener(t,e)}})})),g.prototype.addEventListener=function(t,e){var r=this;function n(t,n){e.call(r,new w(t,!!n.binary,r))}function o(t,n){e.call(r,new b(t,n,r))}function i(t){t.type="error",t.target=r,e.call(r,t)}function s(){e.call(r,new E(r))}"function"==typeof e&&("message"===t?(n._listener=e,this.on(t,n)):"close"===t?(o._listener=e,this.on(t,o)):"error"===t?(i._listener=e,this.on(t,i)):"open"===t?(s._listener=e,this.on(t,s)):this.on(t,e))},t.exports=g,t.exports.buildHostHeader=O},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("http")},function(t,e,r){
/*!
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
var n=r(68);t.exports=function(t){var e={},r=this.value={};Object.keys(t).forEach((function(n){e[n]=t[n],Object.defineProperty(r,n,{get:function(){return e[n]},configurable:!1,enumerable:!0})})),this.reset=function(){return Object.keys(t).forEach((function(r){e[r]=t[r]})),this},this.merge=function(t,r){if(t=t||{},"[object Array]"===Object.prototype.toString.call(r)){for(var n=[],o=0,i=r.length;o<i;++o){var s=r[o];s in t||n.push(s)}if(n.length>0)throw n.length>1?new Error("options "+n.slice(0,n.length-1).join(", ")+" and "+n[n.length-1]+" must be defined"):new Error("option "+n[0]+" must be defined")}return Object.keys(t).forEach((function(r){r in e&&(e[r]=t[r])})),this},this.copy=function(e){var n={};return Object.keys(t).forEach((function(t){-1!==e.indexOf(t)&&(n[t]=r[t])})),n},this.read=function(t,e){if("function"==typeof e){var r=this;n.readFile(t,(function(t,n){if(t)return e(t);var o=JSON.parse(n);r.merge(o),e()}))}else{var o=JSON.parse(n.readFileSync(t));this.merge(o)}return this},this.isDefined=function(t){return void 0!==r[t]},this.isDefinedAndNonNull=function(t){return null!=r[t]},Object.freeze(r),Object.freeze(this)}},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
var n=r(6),o=r(3),i=(n.EventEmitter,r(21)),s=r(22).BufferUtil,c=r(9);function u(t,e){if(this instanceof u==!1)throw new TypeError("Classes can't be function-called");n.EventEmitter.call(this),this._socket=t,this.extensions=e||{},this.firstFragment=!0,this.compress=!1,this.messageHandlers=[],this.processing=!1}function a(t,e){this[e]=(65280&t)>>8,this[e+1]=255&t}function p(t,e){this[e]=(4278190080&t)>>24,this[e+1]=(16711680&t)>>16,this[e+2]=(65280&t)>>8,this[e+3]=255&t}function l(t){for(var e=new Uint8Array(t.buffer||t),r=t.byteLength||t.length,n=t.byteOffset||0,o=new Buffer(r),i=0;i<r;++i)o[i]=e[n+i];return o}o.inherits(u,n.EventEmitter),u.prototype.close=function(t,e,r,n){if(void 0!==t&&("number"!=typeof t||!i.isValidErrorCode(t)))throw new Error("first argument must be a valid error code number");t=t||1e3;var o=new Buffer(2+(e?Buffer.byteLength(e):0));a.call(o,t,0),o.length>2&&o.write(e,2);var s=this;this.messageHandlers.push((function(t){s.frameAndSend(8,o,!0,r),t(),"function"==typeof n&&n()})),this.flush()},u.prototype.ping=function(t,e){var r=e&&e.mask,n=this;this.messageHandlers.push((function(e){n.frameAndSend(9,t||"",!0,r),e()})),this.flush()},u.prototype.pong=function(t,e){var r=e&&e.mask,n=this;this.messageHandlers.push((function(e){n.frameAndSend(10,t||"",!0,r),e()})),this.flush()},u.prototype.send=function(t,e,r){var n=!e||!1!==e.fin,o=e&&e.mask,i=e&&e.compress,s=e&&e.binary?2:1;!1===this.firstFragment?(s=0,i=!1):(this.firstFragment=!1,this.compress=i),n&&(this.firstFragment=!0);var c=this.compress,u=this;this.messageHandlers.push((function(e){u.applyExtensions(t,n,c,(function(t,c){t?"function"==typeof r?r(t):u.emit("error",t):(u.frameAndSend(s,c,n,o,i,r),e())}))})),this.flush()},u.prototype.frameAndSend=function(t,e,r,n,o,i){var c=!1;if(e){Buffer.isBuffer(e)||(c=!0,e=!e||void 0===e.byteLength&&void 0===e.buffer?new Buffer(e):l(e));var u=e.length,f=n?6:2,h=u;u>=65536?(f+=8,h=127):u>125&&(f+=2,h=126);var _=u<32768||n&&!c,y=new Buffer(_?u+f:f);switch(y[0]=r?128|t:t,o&&(y[0]|=64),h){case 126:a.call(y,u,2);break;case 127:p.call(y,0,2),p.call(y,u,6)}if(n){y[1]=128|h;var d=this._randomMask||(this._randomMask=new Buffer([~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random()),~~(255*Math.random())]));if(y[f-4]=d[0],y[f-3]=d[1],y[f-2]=d[2],y[f-1]=d[3],_){s.mask(e,d,y,f,u);try{this._socket.write(y,"binary",i)}catch(t){"function"==typeof i?i(t):this.emit("error",t)}}else{s.mask(e,d,e,0,u);try{this._socket.write(y,"binary"),this._socket.write(e,"binary",i)}catch(t){"function"==typeof i?i(t):this.emit("error",t)}}}else if(y[1]=h,_){e.copy(y,f);try{this._socket.write(y,"binary",i)}catch(t){"function"==typeof i?i(t):this.emit("error",t)}}else try{this._socket.write(y,"binary"),this._socket.write(e,"binary",i)}catch(t){"function"==typeof i?i(t):this.emit("error",t)}}else try{this._socket.write(new Buffer([t|(r?128:0),0|(n?128:0)].concat(n?[0,0,0,0]:[])),"binary",i)}catch(t){"function"==typeof i?i(t):this.emit("error",t)}},u.prototype.flush=function(){if(!this.processing){var t=this.messageHandlers.shift();if(t){this.processing=!0;var e=this;t((function(){e.processing=!1,e.flush()}))}}},u.prototype.applyExtensions=function(t,e,r,n){r&&t?((t.buffer||t)instanceof ArrayBuffer&&(t=l(t)),this.extensions[c.extensionName].compress(t,e,n)):n(null,t)},t.exports=u},function(t,e){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
t.exports={isValidErrorCode:function(t){return t>=1e3&&t<=1011&&1004!=t&&1005!=t&&1006!=t||t>=3e3&&t<=4999},1e3:"normal",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"reserved for extensions",1006:"reserved for extensions",1007:"inconsistent or invalid data",1008:"policy violation",1009:"message too big",1010:"extension handshake missing",1011:"an unexpected condition prevented the request from being fulfilled"}},function(t,e,r){"use strict";
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */try{t.exports=r(!function(){var t=new Error("Cannot find module 'bufferutil'");throw t.code="MODULE_NOT_FOUND",t}())}catch(e){t.exports=r(69)}},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
r(3);var n=r(71).Validation,o=r(21),i=r(73),s=r(22).BufferUtil,c=r(9);function u(t){if(this instanceof u==!1)throw new TypeError("Classes can't be function-called");var e=-1;this.fragmentedBufferPool=new i(1024,(function(t,e){return t.used+e}),(function(t){return e=e>=0?(e+t.used)/2:t.used}));var r=-1;this.unfragmentedBufferPool=new i(1024,(function(t,e){return t.used+e}),(function(t){return r=r>=0?(r+t.used)/2:t.used})),this.extensions=t||{},this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.overflow=[],this.headerBuffer=new Buffer(10),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.currentMessage=[],this.messageHandlers=[],this.expectHeader(2,this.processPacket),this.dead=!1,this.processing=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}function a(t){return(this[t]<<8)+this[t+1]}function p(t){return(this[t]<<24)+(this[t+1]<<16)+(this[t+2]<<8)+this[t+3]}function l(t,e,r,n){switch(t){default:e.copy(r,n,0,t);break;case 16:r[n+15]=e[15];case 15:r[n+14]=e[14];case 14:r[n+13]=e[13];case 13:r[n+12]=e[12];case 12:r[n+11]=e[11];case 11:r[n+10]=e[10];case 10:r[n+9]=e[9];case 9:r[n+8]=e[8];case 8:r[n+7]=e[7];case 7:r[n+6]=e[6];case 6:r[n+5]=e[5];case 5:r[n+4]=e[4];case 4:r[n+3]=e[3];case 3:r[n+2]=e[2];case 2:r[n+1]=e[1];case 1:r[n]=e[0]}}function f(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}t.exports=u,u.prototype.add=function(t){var e=t.length;if(0!=e)if(null!=this.expectBuffer){var r=Math.min(e,this.expectBuffer.length-this.expectOffset);for(l(r,t,this.expectBuffer,this.expectOffset),this.expectOffset+=r,r<e&&this.overflow.push(t.slice(r));this.expectBuffer&&this.expectOffset==this.expectBuffer.length;){var n=this.expectBuffer;this.expectBuffer=null,this.expectOffset=0,this.expectHandler.call(this,n)}}else this.overflow.push(t)},u.prototype.cleanup=function(){this.dead=!0,this.overflow=null,this.headerBuffer=null,this.expectBuffer=null,this.expectHandler=null,this.unfragmentedBufferPool=null,this.fragmentedBufferPool=null,this.state=null,this.currentMessage=null,this.onerror=null,this.ontext=null,this.onbinary=null,this.onclose=null,this.onping=null,this.onpong=null},u.prototype.expectHeader=function(t,e){if(0!=t){this.expectBuffer=this.headerBuffer.slice(this.expectOffset,this.expectOffset+t),this.expectHandler=e;for(var r=t;r>0&&this.overflow.length>0;){var n=this.overflow.pop();r<n.length&&this.overflow.push(n.slice(r));var o=Math.min(n.length,r);l(o,n,this.expectBuffer,this.expectOffset),this.expectOffset+=o,r-=o}}else e(null)},u.prototype.expectData=function(t,e){if(0!=t){this.expectBuffer=this.allocateFromPool(t,this.state.fragmentedOperation),this.expectHandler=e;for(var r=t;r>0&&this.overflow.length>0;){var n=this.overflow.pop();r<n.length&&this.overflow.push(n.slice(r));var o=Math.min(n.length,r);l(o,n,this.expectBuffer,this.expectOffset),this.expectOffset+=o,r-=o}}else e(null)},u.prototype.allocateFromPool=function(t,e){return(e?this.fragmentedBufferPool:this.unfragmentedBufferPool).get(t)},u.prototype.processPacket=function(t){if(this.extensions[c.extensionName]){if(0!=(48&t[0]))return void this.error("reserved fields (2, 3) must be empty",1002)}else if(0!=(112&t[0]))return void this.error("reserved fields must be empty",1002);this.state.lastFragment=128==(128&t[0]),this.state.masked=128==(128&t[1]);var e=64==(64&t[0]),r=15&t[0];if(0===r){if(e)return void this.error("continuation frame cannot have the Per-message Compressed bits",1002);if(this.state.fragmentedOperation=!0,this.state.opcode=this.state.activeFragmentedOperation,1!=this.state.opcode&&2!=this.state.opcode)return void this.error("continuation frame cannot follow current opcode",1002)}else{if(r<3&&null!=this.state.activeFragmentedOperation)return void this.error("data frames after the initial data frame must have opcode 0",1002);if(r>=8&&e)return void this.error("control frames cannot have the Per-message Compressed bits",1002);this.state.compressed=e,this.state.opcode=r,!1===this.state.lastFragment?(this.state.fragmentedOperation=!0,this.state.activeFragmentedOperation=r):this.state.fragmentedOperation=!1}var n=h[this.state.opcode];void 0===n?this.error("no handler for opcode "+this.state.opcode,1002):n.start.call(this,t)},u.prototype.endPacket=function(){this.state.fragmentedOperation?this.state.lastFragment&&this.fragmentedBufferPool.reset(!0):this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.state.lastFragment&&this.state.opcode===this.state.activeFragmentedOperation&&(this.state.activeFragmentedOperation=null),this.state.lastFragment=!1,this.state.opcode=null!=this.state.activeFragmentedOperation?this.state.activeFragmentedOperation:0,this.state.masked=!1,this.expectHeader(2,this.processPacket)},u.prototype.reset=function(){this.dead||(this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.fragmentedBufferPool.reset(!0),this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.overflow=[],this.currentMessage=[],this.messageHandlers=[])},u.prototype.unmask=function(t,e,r){return null!=t&&null!=e&&s.unmask(e,t),r?e:null!=e?e.toString("utf8"):""},u.prototype.concatBuffers=function(t){for(var e=0,r=0,n=t.length;r<n;++r)e+=t[r].length;var o=new Buffer(e);return s.merge(o,t),o},u.prototype.error=function(t,e){return this.reset(),this.onerror(t,e),this},u.prototype.flush=function(){if(!this.processing&&!this.dead){var t=this.messageHandlers.shift();if(t){this.processing=!0;var e=this;t((function(){e.processing=!1,e.flush()}))}}},u.prototype.applyExtensions=function(t,e,r,n){var o=this;r?this.extensions[c.extensionName].decompress(t,e,(function(t,e){o.dead||(t?n(new Error("invalid compressed data")):n(null,e))})):n(null,t)};var h={1:{start:function(t){var e=this,r=127&t[1];r<126?h[1].getData.call(e,r):126==r?e.expectHeader(2,(function(t){h[1].getData.call(e,a.call(t,0))})):127==r&&e.expectHeader(8,(function(t){0==p.call(t,0)?h[1].getData.call(e,p.call(t,4)):e.error("packets with length spanning more than 32 bit is currently not supported",1008)}))},getData:function(t){var e=this;e.state.masked?e.expectHeader(4,(function(r){var n=r;e.expectData(t,(function(t){h[1].finish.call(e,n,t)}))})):e.expectData(t,(function(t){h[1].finish.call(e,null,t)}))},finish:function(t,e){var r=this,o=this.unmask(t,e,!0)||new Buffer(0),i=f(this.state);this.messageHandlers.push((function(t){r.applyExtensions(o,i.lastFragment,i.compressed,(function(e,o){if(e)return r.error(e.message,1007);if(null!=o&&r.currentMessage.push(o),i.lastFragment){var s=r.concatBuffers(r.currentMessage);if(r.currentMessage=[],!n.isValidUTF8(s))return void r.error("invalid utf8 sequence",1007);r.ontext(s.toString("utf8"),{masked:i.masked,buffer:s})}t()}))})),this.flush(),this.endPacket()}},2:{start:function(t){var e=this,r=127&t[1];r<126?h[2].getData.call(e,r):126==r?e.expectHeader(2,(function(t){h[2].getData.call(e,a.call(t,0))})):127==r&&e.expectHeader(8,(function(t){0==p.call(t,0)?h[2].getData.call(e,p.call(t,4,!0)):e.error("packets with length spanning more than 32 bit is currently not supported",1008)}))},getData:function(t){var e=this;e.state.masked?e.expectHeader(4,(function(r){var n=r;e.expectData(t,(function(t){h[2].finish.call(e,n,t)}))})):e.expectData(t,(function(t){h[2].finish.call(e,null,t)}))},finish:function(t,e){var r=this,n=this.unmask(t,e,!0)||new Buffer(0),o=f(this.state);this.messageHandlers.push((function(t){r.applyExtensions(n,o.lastFragment,o.compressed,(function(e,n){if(e)return r.error(e.message,1007);if(null!=n&&r.currentMessage.push(n),o.lastFragment){var i=r.concatBuffers(r.currentMessage);r.currentMessage=[],r.onbinary(i,{masked:o.masked,buffer:i})}t()}))})),this.flush(),this.endPacket()}},8:{start:function(t){if(0!=this.state.lastFragment){var e=127&t[1];e<126?h[8].getData.call(this,e):this.error("control frames cannot have more than 125 bytes of data",1002)}else this.error("fragmented close is not supported",1002)},getData:function(t){var e=this;e.state.masked?e.expectHeader(4,(function(r){var n=r;e.expectData(t,(function(t){h[8].finish.call(e,n,t)}))})):e.expectData(t,(function(t){h[8].finish.call(e,null,t)}))},finish:function(t,e){var r=this;e=r.unmask(t,e,!0);var i=f(this.state);this.messageHandlers.push((function(){if(e&&1==e.length)r.error("close packets with data must be at least two bytes long",1002);else{var t=e&&e.length>1?a.call(e,0):1e3;if(o.isValidErrorCode(t)){var s="";if(e&&e.length>2){var c=e.slice(2);if(!n.isValidUTF8(c))return void r.error("invalid utf8 sequence",1007);s=c.toString("utf8")}r.onclose(t,s,{masked:i.masked}),r.reset()}else r.error("invalid error code",1002)}})),this.flush()}},9:{start:function(t){if(0!=this.state.lastFragment){var e=127&t[1];e<126?h[9].getData.call(this,e):this.error("control frames cannot have more than 125 bytes of data",1002)}else this.error("fragmented ping is not supported",1002)},getData:function(t){var e=this;e.state.masked?e.expectHeader(4,(function(r){var n=r;e.expectData(t,(function(t){h[9].finish.call(e,n,t)}))})):e.expectData(t,(function(t){h[9].finish.call(e,null,t)}))},finish:function(t,e){var r=this;e=this.unmask(t,e,!0);var n=f(this.state);this.messageHandlers.push((function(t){r.onping(e,{masked:n.masked,binary:!0}),t()})),this.flush(),this.endPacket()}},10:{start:function(t){if(0!=this.state.lastFragment){var e=127&t[1];e<126?h[10].getData.call(this,e):this.error("control frames cannot have more than 125 bytes of data",1002)}else this.error("fragmented pong is not supported",1002)},getData:function(t){var e=this;this.state.masked?this.expectHeader(4,(function(r){var n=r;e.expectData(t,(function(t){h[10].finish.call(e,n,t)}))})):this.expectData(t,(function(t){h[10].finish.call(e,null,t)}))},finish:function(t,e){var r=this;e=r.unmask(t,e,!0);var n=f(this.state);this.messageHandlers.push((function(t){r.onpong(e,{masked:n.masked,binary:!0}),t()})),this.flush(),this.endPacket()}}}},function(t,e,r){var n=r(3);e.parse=function(t){var e={};return(t=t||"").split(",").forEach((function(t){var r=t.split(";"),n=r.shift().trim(),o=e[n]=e[n]||[],i={};r.forEach((function(t){var e=t.trim().split("="),r=e[0],n=e[1];void 0===n?n=!0:('"'===n[0]&&(n=n.slice(1)),'"'===n[n.length-1]&&(n=n.slice(0,n.length-1))),(i[r]=i[r]||[]).push(n)})),o.push(i)})),e},e.format=function(t){return Object.keys(t).map((function(e){var r=t[e];return n.isArray(r)||(r=[r]),r.map((function(t){return[e].concat(Object.keys(t).map((function(e){var r=t[e];return n.isArray(r)||(r=[r]),r.map((function(t){return!0===t?e:e+"="+t})).join("; ")}))).join("; ")})).join(", ")})).join(", ")}},function(t,e){t.exports=require("tls")},function(t,e,r){var n,o,i,s,c,u,a,p,l,f,h,_,y,d,v,m,g,w,b,E,O,S,k,C,R,T,x,j,A,N,P,F,I,D,L,U,B,M,q,H,V,W,Q,G,Y,J,z,K,X,$,Z,tt,et,rt,nt,ot,it,st,ct,ut,at,pt,lt,ft,ht,_t,yt,dt,vt,mt,gt,wt,bt,Et,Ot,St,kt,Ct,Rt,Tt,xt,jt,At,Nt,Pt,Ft,It,Dt,Lt,Ut,Bt,Mt,qt,Ht,Vt,Wt,Qt,Gt,Yt,Jt,zt,Kt,Xt,$t,Zt,te,ee,re,ne,oe,ie,se,ce,ue,ae,pe,le,fe,he,_e,ye,de,ve,me,ge,we,be,Ee,Oe,Se,ke,Ce,Re,Te,xe,je,Ae,Ne,Pe,Fe,Ie,De,Le,Ue,Be,Me,qe,He,Ve,We,Qe,Ge,Ye,Je,ze,Ke,Xe,$e,Ze,tr,er,rr,nr,or,ir,sr,cr,ur,ar,pr,lr,fr,hr,_r,yr,dr,vr,mr=[].slice,gr={}.hasOwnProperty,wr=function(t,e){for(var r in e)gr.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};dr=r(13),or=r(8),pr=r(15),lr=r(5).Term.TermType,oe=r(4),rr=dr.ar,vr=dr.varar,nr=dr.aropt,fr=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],fr.expr.apply(fr,t)},ir=function(t){var e;return void 0===t?t:(t=fr.expr(t),(e=function(t){var r,n;return t instanceof Fe&&(t instanceof pt||(!!t.args.map(e).some((function(t){return t}))||!!function(){var e,o;for(r in o=[],e=t.optargs)gr.call(e,r)&&(n=e[r],o.push(n));return o}().map(e).some((function(t){return t}))))})(t)?new z({},(function(e){return t})):t)},sr=function(t){var e,r,n;if(Array.isArray(t)){for(r=0,n=t.length;r<n;r++)if(e=t[r],!0===sr(e))return!0}else if("r.row"===t)return!0;return!1},ce=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.eq=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(q,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ne=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Wt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.lt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Nt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.le=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Tt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.gt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(it,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(K,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.not=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.add=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(n,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.sub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Re,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.mul=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Vt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.div=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(L,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.mod=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.floor=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Q,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ceil=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(h,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.round=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ye,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.append=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(i,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.prepend=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ne,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.difference=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(F,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setInsert=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ge,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setUnion=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(be,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setIntersection=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(we,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.setDifference=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(me,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.slice=vr(1,3,(function(t,e,r){return null!=r?new Oe(r,this,t,e):void 0!==e?"[object Object]"!==Object.prototype.toString.call(e)||e instanceof Fe?new Oe({},this,t,e):new Oe(e,this,t):new Oe({},this,t)})),e.prototype.skip=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ee,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.limit=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(xt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getField=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(tt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.contains=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(w,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.insertAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Et,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.spliceAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Se,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.deleteAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(N,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.changeAt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(_,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.offsetsOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(zt,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.hasFields=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(st,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.withFields=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($e,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.keys=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Rt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.values=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ze,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.changes=nr((function(t){return new y(t,this)})),e.prototype.pluck=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Zt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.without=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ze,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.merge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ut,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.between=nr((function(t,e,r){return new a(r,this,t,e)})),e.prototype.reduce=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(he,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.map=vr(1,null,(function(){var t,e,r;return t=2<=arguments.length?mr.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(It,[{},this].concat(mr.call(t),[ir(e)]),(function(){}))})),e.prototype.fold=nr((function(t,e,r){return new G(r,this,t,ir(e))})),e.prototype.filter=nr((function(t,e){return new W(e,this,ir(t))})),e.prototype.concatMap=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(m,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.distinct=nr((function(t){return new D(t,this)})),e.prototype.count=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(b,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.union=function(){var t,e,r,n,o;return r=1<=arguments.length?mr.call(arguments,0):[],n={},e=r,!(o=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(o)||o instanceof Fe||(n=o,e=r.slice(0,r.length-1)),e=function(){var r,n,o;for(o=[],r=0,n=e.length;r<n;r++)(t=e[r])instanceof c||t instanceof P?o.push(t):o.push(ir(t));return o}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qe,[n,this].concat(mr.call(e)),(function(){}))},e.prototype.nth=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Yt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.bracket=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(l,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toJSON=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toJsonString=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.match=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Dt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.split=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ke,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.upcase=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ge,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.downcase=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(U,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.isEmpty=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(St,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.innerJoin=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(wt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.outerJoin=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($t,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.eqJoin=nr((function(t,e,r){return new H(r,this,ir(t),e)})),e.prototype.zip=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(er,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.coerceTo=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(v,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.ungroup=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(We,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.typeOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(He,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.update=nr((function(t,e){return new Ye(e,this,ir(t))})),e.prototype.delete=nr((function(t){return new A(t,this)})),e.prototype.replace=nr((function(t,e){return new _e(e,this,ir(t))})),e.prototype.do=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(J,[{},ir(t.slice(-1)[0]),this].concat(mr.call(t.slice(0,-1))),(function(){}))},e.prototype.default=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(j,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.or=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Kt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.and=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(o,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.branch=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(f,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.forEach=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Y,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.sum=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Te,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.avg=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(u,[{},this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.info=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(gt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.sample=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(de,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.group=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],e.length>0&&(!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Fe||(r=n,t=e.slice(0,e.length-1))),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ot,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.orderBy=function(){var t,e,r,n,o;return r=1<=arguments.length?mr.call(arguments,0):[],n={},e=r,!(o=r[r.length-1])||"[object Object]"!==Object.prototype.toString.call(o)||o instanceof Fe||(n=o,e=r.slice(0,r.length-1)),e=function(){var r,n,o;for(o=[],r=0,n=e.length;r<n;r++)(t=e[r])instanceof c||t instanceof P?o.push(t):o.push(ir(t));return o}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Xt,[n,this].concat(mr.call(e)),(function(){}))},e.prototype.toGeojson=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Be,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.distance=nr((function(t,e){return new I(e,this,t)})),e.prototype.intersects=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ot,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.includes=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ft,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.fill=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(V,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.polygonSub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(re,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.tableCreate=nr((function(t,e){return new Ae(e,this,t)})),e.prototype.tableDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ne,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.tableList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.config=function(){return new g({},this)},e.prototype.status=function(){return new Ce({},this)},e.prototype.wait=nr((function(t){return new Xe(t,this)})),e.prototype.table=nr((function(t,e){return new je(e,this,t)})),e.prototype.get=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}($,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getAll=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],e.length>1&&(!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Fe||(r=n,t=e.slice(0,e.length-1))),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Z,[r,this].concat(mr.call(t)),(function(){}))},e.prototype.min=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],1===e.length&&(!(n=e[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Fe||(r=n,t=[])),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Bt,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.max=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],1===e.length&&(!(n=e[0])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Fe||(r=n,t=[])),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Lt,[r,this].concat(mr.call(t.map(ir))),(function(){}))},e.prototype.insert=nr((function(t,e){return new bt(e,this,fr.expr(t))})),e.prototype.indexCreate=vr(1,3,(function(t,e,r){return null!=r?new ht(r,this,t,ir(e)):null!=e?"[object Object]"!==Object.prototype.toString.call(e)||"function"==typeof e||e instanceof Fe?new ht({},this,t,ir(e)):new ht(e,this,t):new ht({},this,t)})),e.prototype.indexDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(_t,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(yt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexStatus=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(vt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexWait=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(mt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.indexRename=nr((function(t,e,r){return new dt(r,this,t,e)})),e.prototype.reconfigure=function(t){return new fe(t,this)},e.prototype.rebalance=function(){return new le({},this)},e.prototype.sync=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(xe,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.grant=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(nt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toISO8601=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Me,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.toEpochTime=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ue,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.inTimezone=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(lt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.during=nr((function(t,e,r){return new B(r,this,t,e)})),e.prototype.date=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ue,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.timeOfDay=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(De,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.timezone=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Le,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.year=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(tr,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.month=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ht,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.day=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(O,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.dayOfWeek=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(S,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.dayOfYear=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(k,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.hours=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ct,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.minutes=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Mt,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.seconds=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ve,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.uuid=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ve,[{},this].concat(mr.call(t)),(function(){}))},e.prototype.getIntersecting=nr((function(t,e){return new et(e,this,t)})),e.prototype.getNearest=nr((function(t,e){return new rt(e,this,t)})),e}(Fe=function(){function t(){var t;return void 0!=={}.__proto__?((t=rr((function(e){return t.bracket(e)}))).__proto__=this.__proto__,t):this}return t.prototype.showRunWarning=!0,t.prototype.run=function(t,e,r){if(!0===pr.isConnection(t)){if("function"==typeof e){if(void 0!==r)return oe.reject(new or.ReqlDriverError("Second argument to `run` cannot be a function if a third argument is provided.")).nodeify(e);r=e,e={}}}else(null!=t?t.constructor:void 0)===Object&&(!0===this.showRunWarning&&("undefined"!=typeof process&&null!==process&&process.stderr.write("RethinkDB warning: This syntax is deprecated. Please use `run(connection[, options], callback)`."),this.showRunWarning=!1),r=e,e=t,t=t.connection,delete e.connection);return null==e&&(e={}),null!=r&&"function"!=typeof r?oe.reject(new or.ReqlDriverError("If provided, the callback must be a function. Please use `run(connection[, options][, callback])")):!1===pr.isConnection(t)?oe.reject(new or.ReqlDriverError("First argument to `run` must be an open connection.")).nodeify(r):new oe((n=this,function(r,o){var i,s;s=function(t,e){return null!=t?o(t):r(e)};try{return t._start(n,s,e)}catch(i){return s(i)}})).nodeify(r);var n},t.prototype.toString=function(){return or.printQuery(this)},t}()),E=function(t){function e(t){var r;return(r=e.__super__.constructor.call(this)).data=t,r}return wr(e,t),e.prototype.args=[],e.prototype.optargs={},e.prototype.compose=function(){switch(typeof this.data){case"string":return'"'+this.data+'"';default:return""+this.data}},e.prototype.build=function(){if("number"==typeof this.data&&!isFinite(this.data))throw new TypeError("Illegal non-finite number `"+this.data.toString()+"`.");return this.data},e}(ce),_r=function(t){var e,r,n;for(e in r={},t)gr.call(t,e)&&(n=t[e],r[dr.toCamelCase(e)]=n);return r},yr=function(t){var e,r,n;for(e in r={},t)gr.call(t,e)&&(n=t[e],void 0!==e&&void 0!==n&&(r[dr.fromCamelCase(e)]=fr.expr(n)));return r},ie=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.compose=function(t,e){return["r.",this.st]},e}(se=function(t){function e(){var t,r,n,o,i;return o=arguments[0],r=2<=arguments.length?mr.call(arguments,1):[],(i=e.__super__.constructor.call(this)).args=function(){var e,o,i;for(i=[],n=e=0,o=r.length;e<o;n=++e){if(void 0===(t=r[n]))throw new or.ReqlDriverCompileError("Argument "+n+" to "+(this.st||this.mt)+" may not be `undefined`.");i.push(fr.expr(t))}return i}.call(this),i.optargs=yr(o),i}return wr(e,t),e.prototype.build=function(){var t,e,r,n,o,i,s,c,u,a;for(u=[this.tt,[]],r=0,o=(s=this.args).length;r<o;r++)e=s[r],u[1].push(e.build());for(n in i={},t=!1,c=this.optargs)gr.call(c,n)&&(a=c[n],t=!0,i[n]=a.build());return t&&u.push(i),u},e.prototype.compose=function(t,e){return this.st?["r.",this.st,"(",ur(t,e),")"]:(hr(this.args[0])&&(t[0]=["r(",t[0],")"]),[t[0],".",this.mt,"(",ur(t.slice(1),e),")"])},e}(ce)),cr=function(t){var e,r,n,o,i;if(null==t[0])return[];for(i=[t[0]],r=0,n=(o=t.slice(1)).length;r<n;r++)e=o[r],i.push(", ",e);return i},ar=function(t){var e,r;return["{",cr(function(){var n;for(e in n=[],t)gr.call(t,e)&&(r=t[e],n.push([JSON.stringify(e),": ",r]));return n}()),"}"]},ur=function(t,e){var r;return r=[],t.length>0&&r.push(cr(t)),Object.keys(e).length>0&&(r.length>0&&r.push(", "),r.push(ar(_r(e)))),r},hr=function(t){return t instanceof E||t instanceof Pt||t instanceof Ft},Pt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MAKE_ARRAY,e.prototype.st="[...]",e.prototype.compose=function(t){return["[",cr(t),"]"]},e}(se),Ft=function(t){function e(t,r){var n,o,i;for(n in null==r&&(r=20),(o=e.__super__.constructor.call(this,{})).optargs={},t)if(gr.call(t,n)){if(void 0===(i=t[n]))throw new or.ReqlDriverCompileError("Object field '"+n+"' may not be undefined");o.optargs[n]=fr.expr(i,r-1)}return o}return wr(e,t),e.prototype.tt=lr.MAKE_OBJ,e.prototype.st="{...}",e.prototype.compose=function(t,e){return ar(e)},e.prototype.build=function(){var t,e,r,n;for(t in r={},e=this.optargs)gr.call(e,t)&&(n=e[t],r[t]=n.build());return r},e}(se),Ke=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.VAR,e.prototype.compose=function(t){return["var_"+t]},e}(se),kt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.JAVASCRIPT,e.prototype.st="js",e}(se),ut=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.HTTP,e.prototype.st="http",e}(se),Ct=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.JSON,e.prototype.st="json",e}(se),p=function(t){function e(t){var r;if(t instanceof Fe)r=e.__super__.constructor.call(this,{},t);else{if(!(t instanceof Buffer))throw new TypeError("Parameter to `r.binary` must be a Buffer object or RQL query.");(r=e.__super__.constructor.call(this)).base64_data=t.toString("base64")}return r}return wr(e,t),e.prototype.tt=lr.BINARY,e.prototype.st="binary",e.prototype.compose=function(){return 0===this.args.length?"r.binary(<data>)":e.__super__.compose.apply(this,arguments)},e.prototype.build=function(){return 0===this.args.length?{$reql_type$:"BINARY",data:this.base64_data}:e.__super__.build.apply(this,arguments)},e}(se),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ARGS,e.prototype.st="args",e}(se),Je=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ERROR,e.prototype.st="error",e}(se),ae=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.RANDOM,e.prototype.st="random",e}(se),pt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.IMPLICIT_VAR,e.prototype.compose=function(){return["r.row"]},e}(se),C=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DB,e.prototype.st="db",e}(se),je=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TABLE,e.prototype.st="table",e.prototype.compose=function(t,e){return this.args[0]instanceof C?[t[0],".table(",ur(t.slice(1),e),")"]:["r.table(",ur(t,e),")"]},e}(se),$=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GET,e.prototype.mt="get",e}(se),Z=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GET_ALL,e.prototype.mt="getAll",e}(se),q=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.EQ,e.prototype.mt="eq",e}(se),Wt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.NE,e.prototype.mt="ne",e}(se),Nt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.LT,e.prototype.mt="lt",e}(se),Tt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.LE,e.prototype.mt="le",e}(se),it=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GT,e.prototype.mt="gt",e}(se),K=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GE,e.prototype.mt="ge",e}(se),Qt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.NOT,e.prototype.mt="not",e}(se),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ADD,e.prototype.mt="add",e}(se),Re=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SUB,e.prototype.mt="sub",e}(se),Vt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MUL,e.prototype.mt="mul",e}(se),L=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DIV,e.prototype.mt="div",e}(se),qt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MOD,e.prototype.mt="mod",e}(se),Q=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FLOOR,e.prototype.mt="floor",e}(se),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CEIL,e.prototype.mt="ceil",e}(se),ye=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ROUND,e.prototype.mt="round",e}(se),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.APPEND,e.prototype.mt="append",e}(se),ne=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.PREPEND,e.prototype.mt="prepend",e}(se),F=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DIFFERENCE,e.prototype.mt="difference",e}(se),ge=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SET_INSERT,e.prototype.mt="setInsert",e}(se),be=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SET_UNION,e.prototype.mt="setUnion",e}(se),we=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SET_INTERSECTION,e.prototype.mt="setIntersection",e}(se),me=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SET_DIFFERENCE,e.prototype.mt="setDifference",e}(se),Oe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SLICE,e.prototype.mt="slice",e}(se),Ee=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SKIP,e.prototype.mt="skip",e}(se),xt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.LIMIT,e.prototype.mt="limit",e}(se),tt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GET_FIELD,e.prototype.mt="getField",e}(se),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.BRACKET,e.prototype.st="(...)",e.prototype.compose=function(t){return[t[0],"(",t[1],")"]},e}(se),w=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CONTAINS,e.prototype.mt="contains",e}(se),Et=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INSERT_AT,e.prototype.mt="insertAt",e}(se),Se=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SPLICE_AT,e.prototype.mt="spliceAt",e}(se),N=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DELETE_AT,e.prototype.mt="deleteAt",e}(se),_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CHANGE_AT,e.prototype.mt="changeAt",e}(se),st=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.HAS_FIELDS,e.prototype.mt="hasFields",e}(se),$e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.WITH_FIELDS,e.prototype.mt="withFields",e}(se),Rt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.KEYS,e.prototype.mt="keys",e}(se),ze=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.VALUES,e.prototype.mt="values",e}(se),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CHANGES,e.prototype.mt="changes",e}(se),Jt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.OBJECT,e.prototype.mt="object",e}(se),Zt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.PLUCK,e.prototype.mt="pluck",e}(se),zt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.OFFSETS_OF,e.prototype.mt="offsetsOf",e}(se),Ze=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.WITHOUT,e.prototype.mt="without",e}(se),Ut=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MERGE,e.prototype.mt="merge",e}(se),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.BETWEEN,e.prototype.mt="between",e}(se),he=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.REDUCE,e.prototype.mt="reduce",e}(se),It=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MAP,e.prototype.mt="map",e}(se),G=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FOLD,e.prototype.mt="fold",e}(se),W=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FILTER,e.prototype.mt="filter",e}(se),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CONCAT_MAP,e.prototype.mt="concatMap",e}(se),Xt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ORDER_BY,e.prototype.mt="orderBy",e}(se),D=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DISTINCT,e.prototype.mt="distinct",e}(se),b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.COUNT,e.prototype.mt="count",e}(se),Qe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.UNION,e.prototype.mt="union",e}(se),Yt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.NTH,e.prototype.mt="nth",e}(se),qe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TO_JSON_STRING,e.prototype.mt="toJsonString",e}(se),Dt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MATCH,e.prototype.mt="match",e}(se),ke=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SPLIT,e.prototype.mt="split",e}(se),Ge=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.UPCASE,e.prototype.mt="upcase",e}(se),U=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DOWNCASE,e.prototype.mt="downcase",e}(se),St=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.IS_EMPTY,e.prototype.mt="isEmpty",e}(se),ot=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GROUP,e.prototype.mt="group",e}(se),Te=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SUM,e.prototype.mt="sum",e}(se),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.AVG,e.prototype.mt="avg",e}(se),Bt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MIN,e.prototype.mt="min",e}(se),Lt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MAX,e.prototype.mt="max",e}(se),wt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INNER_JOIN,e.prototype.mt="innerJoin",e}(se),$t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.OUTER_JOIN,e.prototype.mt="outerJoin",e}(se),H=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.EQ_JOIN,e.prototype.mt="eqJoin",e}(se),er=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ZIP,e.prototype.mt="zip",e}(se),pe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.RANGE,e.prototype.st="range",e}(se),v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.COERCE_TO,e.prototype.mt="coerceTo",e}(se),We=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.UNGROUP,e.prototype.mt="ungroup",e}(se),He=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TYPE_OF,e.prototype.mt="typeOf",e}(se),gt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INFO,e.prototype.mt="info",e}(se),de=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SAMPLE,e.prototype.mt="sample",e}(se),Ye=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.UPDATE,e.prototype.mt="update",e}(se),A=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DELETE,e.prototype.mt="delete",e}(se),_e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.REPLACE,e.prototype.mt="replace",e}(se),bt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INSERT,e.prototype.mt="insert",e}(se),R=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DB_CREATE,e.prototype.st="dbCreate",e}(se),T=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DB_DROP,e.prototype.st="dbDrop",e}(se),x=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DB_LIST,e.prototype.st="dbList",e}(se),Ae=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TABLE_CREATE,e.prototype.mt="tableCreate",e}(se),Ne=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TABLE_DROP,e.prototype.mt="tableDrop",e}(se),Pe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TABLE_LIST,e.prototype.mt="tableList",e}(se),ht=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_CREATE,e.prototype.mt="indexCreate",e}(se),_t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_DROP,e.prototype.mt="indexDrop",e}(se),dt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_RENAME,e.prototype.mt="indexRename",e}(se),yt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_LIST,e.prototype.mt="indexList",e}(se),vt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_STATUS,e.prototype.mt="indexStatus",e}(se),mt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INDEX_WAIT,e.prototype.mt="indexWait",e}(se),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CONFIG,e.prototype.mt="config",e}(se),Ce=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.STATUS,e.prototype.mt="status",e}(se),Xe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.WAIT,e.prototype.mt="wait",e}(se),fe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.RECONFIGURE,e.prototype.mt="reconfigure",e}(se),le=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.REBALANCE,e.prototype.mt="rebalance",e}(se),xe=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SYNC,e.prototype.mt="sync",e}(se),nt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GRANT,e.prototype.mt="grant",e}(se),J=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FUNCALL,e.prototype.st="do",e.prototype.compose=function(t){return t.length>2?["r.do(",cr(t.slice(1)),", ",t[0],")"]:(hr(this.args[1])&&(t[1]=["r(",t[1],")"]),[t[1],".do(",t[0],")"])},e}(se),j=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DEFAULT,e.prototype.mt="default",e}(se),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.BRANCH,e.prototype.st="branch",e}(se),Kt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.OR,e.prototype.mt="or",e}(se),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.AND,e.prototype.mt="and",e}(se),Y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FOR_EACH,e.prototype.mt="forEach",e}(se),z=function(t){function e(t,r){var n,o,i,s,c;for(o=[],n=[],c=0;c<r.length;)n.push(e.nextVarId),o.push(new Ke({},e.nextVarId)),e.nextVarId++,c++;if(void 0===(s=r.apply(null,o)))throw new or.ReqlDriverCompileError("Anonymous function returned `undefined`. Did you forget a `return`?");return i=function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pt,[{}].concat(mr.call(n)),(function(){})),e.__super__.constructor.call(this,t,i,s)}return wr(e,t),e.prototype.tt=lr.FUNC,e.nextVarId=0,e.prototype.compose=function(t){var e,r,n,o,i,s;if(!0===sr(t[1]))return[t[1]];for(s="",r=n=0,o=(i=t[0][1]).length;n<o;r=++n)e=i[r],s+=r%2==0?Ke.prototype.compose(e):e;return["function(",s,") { return ",t[1],"; }"]},e}(se),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ASC,e.prototype.st="asc",e}(se),P=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DESC,e.prototype.st="desc",e}(se),At=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.LITERAL,e.prototype.st="literal",e}(se),at=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.ISO8601,e.prototype.st="ISO8601",e}(se),Me=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TO_ISO8601,e.prototype.mt="toISO8601",e}(se),M=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.EPOCH_TIME,e.prototype.st="epochTime",e}(se),Ue=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TO_EPOCH_TIME,e.prototype.mt="toEpochTime",e}(se),Gt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.NOW,e.prototype.st="now",e}(se),lt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.IN_TIMEZONE,e.prototype.mt="inTimezone",e}(se),B=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DURING,e.prototype.mt="during",e}(se),ue=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DATE,e.prototype.mt="date",e}(se),De=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TIME_OF_DAY,e.prototype.mt="timeOfDay",e}(se),Le=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TIMEZONE,e.prototype.mt="timezone",e}(se),tr=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.YEAR,e.prototype.mt="year",e}(se),Ht=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MONTH,e.prototype.mt="month",e}(se),O=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DAY,e.prototype.mt="day",e}(se),S=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DAY_OF_WEEK,e.prototype.mt="dayOfWeek",e}(se),k=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DAY_OF_YEAR,e.prototype.mt="dayOfYear",e}(se),ct=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.HOURS,e.prototype.mt="hours",e}(se),Mt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MINUTES,e.prototype.mt="minutes",e}(se),ve=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SECONDS,e.prototype.mt="seconds",e}(se),Ie=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TIME,e.prototype.st="time",e}(se),X=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GEOJSON,e.prototype.st="geojson",e}(se),Be=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TO_GEOJSON,e.prototype.mt="toGeojson",e}(se),te=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.POINT,e.prototype.st="point",e}(se),jt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.LINE,e.prototype.st="line",e}(se),ee=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.POLYGON,e.prototype.st="polygon",e}(se),I=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DISTANCE,e.prototype.mt="distance",e}(se),Ot=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INTERSECTS,e.prototype.mt="intersects",e}(se),ft=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.INCLUDES,e.prototype.mt="includes",e}(se),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.CIRCLE,e.prototype.st="circle",e}(se),et=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GET_INTERSECTING,e.prototype.mt="getIntersecting",e}(se),rt=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.GET_NEAREST,e.prototype.mt="getNearest",e}(se),V=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FILL,e.prototype.mt="fill",e}(se),re=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.POLYGON_SUB,e.prototype.mt="polygonSub",e}(se),Ve=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.UUID,e.prototype.st="uuid",e}(se),fr.expr=vr(1,2,(function(t,e){var r;if(null==e&&(e=20),void 0===t)throw new or.ReqlDriverCompileError("Cannot wrap undefined with r.expr().");if(e<=0)throw new or.ReqlDriverCompileError("Nesting depth limit exceeded.");if("number"!=typeof e||isNaN(e))throw new or.ReqlDriverCompileError("Second argument to `r.expr` must be a number or undefined.");return t instanceof Fe?t:"function"==typeof t?new z({},t):t instanceof Date?new at({},t.toISOString()):t instanceof Buffer?new p(t):Array.isArray(t)?(t=function(){var n,o,i;for(i=[],n=0,o=t.length;n<o;n++)r=t[n],i.push(fr.expr(r,e-1));return i}(),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pt,[{}].concat(mr.call(t)),(function(){}))):"number"==typeof t?new E(t):"[object Object]"===Object.prototype.toString.call(t)?new Ft(t,e):new E(t)})),fr.js=nr((function(t,e){return new kt(e,t)})),fr.http=nr((function(t,e){return new ut(e,t)})),fr.json=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ct,[{}].concat(mr.call(t)),(function(){}))},fr.error=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Je,[{}].concat(mr.call(t)),(function(){}))},fr.random=function(){var t,e,r,n;return r={},t=e=1<=arguments.length?mr.call(arguments,0):[],!(n=e[e.length-1])||"[object Object]"!==Object.prototype.toString.call(n)||n instanceof Fe||(r=n,t=e.slice(0,e.length-1)),function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ae,[r].concat(mr.call(t)),(function(){}))},fr.binary=rr((function(t){return new p(t)})),fr.row=new pt({}),fr.table=nr((function(t,e){return new je(e,t)})),fr.db=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(C,[{}].concat(mr.call(t)),(function(){}))},fr.dbCreate=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(R,[{}].concat(mr.call(t)),(function(){}))},fr.dbDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(T,[{}].concat(mr.call(t)),(function(){}))},fr.dbList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(x,[{}].concat(mr.call(t)),(function(){}))},fr.tableCreate=nr((function(t,e){return new Ae(e,t)})),fr.tableDrop=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ne,[{}].concat(mr.call(t)),(function(){}))},fr.tableList=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Pe,[{}].concat(mr.call(t)),(function(){}))},fr.grant=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(nt,[{}].concat(mr.call(t)),(function(){}))},fr.do=vr(1,null,(function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(J,[{},ir(t.slice(-1)[0])].concat(mr.call(t.slice(0,-1))),(function(){}))})),fr.branch=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(f,[{}].concat(mr.call(t)),(function(){}))},fr.map=vr(1,null,(function(){var t,e,r;return t=2<=arguments.length?mr.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(It,[{}].concat(mr.call(t),[ir(e)]),(function(){}))})),fr.group=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ot,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.reduce=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(he,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.count=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(b,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.sum=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Te,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.avg=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(u,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.min=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Bt,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.max=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Lt,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.distinct=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(D,[{}].concat(mr.call(t)),(function(){}))},fr.contains=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(w,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.asc=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(c,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.desc=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(P,[{}].concat(mr.call(t.map(ir))),(function(){}))},fr.eq=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(q,[{}].concat(mr.call(t)),(function(){}))},fr.ne=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Wt,[{}].concat(mr.call(t)),(function(){}))},fr.lt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Nt,[{}].concat(mr.call(t)),(function(){}))},fr.le=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Tt,[{}].concat(mr.call(t)),(function(){}))},fr.gt=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(it,[{}].concat(mr.call(t)),(function(){}))},fr.ge=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(K,[{}].concat(mr.call(t)),(function(){}))},fr.or=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Kt,[{}].concat(mr.call(t)),(function(){}))},fr.and=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(o,[{}].concat(mr.call(t)),(function(){}))},fr.not=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qt,[{}].concat(mr.call(t)),(function(){}))},fr.add=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(n,[{}].concat(mr.call(t)),(function(){}))},fr.sub=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Re,[{}].concat(mr.call(t)),(function(){}))},fr.div=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(L,[{}].concat(mr.call(t)),(function(){}))},fr.mul=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Vt,[{}].concat(mr.call(t)),(function(){}))},fr.mod=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(qt,[{}].concat(mr.call(t)),(function(){}))},fr.floor=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Q,[{}].concat(mr.call(t)),(function(){}))},fr.ceil=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(h,[{}].concat(mr.call(t)),(function(){}))},fr.round=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ye,[{}].concat(mr.call(t)),(function(){}))},fr.typeOf=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(He,[{}].concat(mr.call(t)),(function(){}))},fr.info=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(gt,[{}].concat(mr.call(t)),(function(){}))},fr.literal=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(At,[{}].concat(mr.call(t)),(function(){}))},fr.ISO8601=nr((function(t,e){return new at(e,t)})),fr.epochTime=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(M,[{}].concat(mr.call(t)),(function(){}))},fr.now=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Gt,[{}].concat(mr.call(t)),(function(){}))},fr.time=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ie,[{}].concat(mr.call(t)),(function(){}))},fr.monday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MONDAY,e.prototype.st="monday",e}(ie)),fr.tuesday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.TUESDAY,e.prototype.st="tuesday",e}(ie)),fr.wednesday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.WEDNESDAY,e.prototype.st="wednesday",e}(ie)),fr.thursday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.THURSDAY,e.prototype.st="thursday",e}(ie)),fr.friday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FRIDAY,e.prototype.st="friday",e}(ie)),fr.saturday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SATURDAY,e.prototype.st="saturday",e}(ie)),fr.sunday=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SUNDAY,e.prototype.st="sunday",e}(ie)),fr.january=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.JANUARY,e.prototype.st="january",e}(ie)),fr.february=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.FEBRUARY,e.prototype.st="february",e}(ie)),fr.march=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MARCH,e.prototype.st="march",e}(ie)),fr.april=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.APRIL,e.prototype.st="april",e}(ie)),fr.may=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MAY,e.prototype.st="may",e}(ie)),fr.june=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.JUNE,e.prototype.st="june",e}(ie)),fr.july=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.JULY,e.prototype.st="july",e}(ie)),fr.august=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.AUGUST,e.prototype.st="august",e}(ie)),fr.september=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.SEPTEMBER,e.prototype.st="september",e}(ie)),fr.october=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.OCTOBER,e.prototype.st="october",e}(ie)),fr.november=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.NOVEMBER,e.prototype.st="november",e}(ie)),fr.december=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.DECEMBER,e.prototype.st="december",e}(ie)),fr.minval=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MINVAL,e.prototype.st="minval",e}(ie)),fr.maxval=new(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return wr(e,t),e.prototype.tt=lr.MAXVAL,e.prototype.st="maxval",e}(ie)),fr.object=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Jt,[{}].concat(mr.call(t)),(function(){}))},fr.args=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(s,[{}].concat(mr.call(t)),(function(){}))},fr.geojson=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(X,[{}].concat(mr.call(t)),(function(){}))},fr.point=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(te,[{}].concat(mr.call(t)),(function(){}))},fr.line=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(jt,[{}].concat(mr.call(t)),(function(){}))},fr.polygon=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(ee,[{}].concat(mr.call(t)),(function(){}))},fr.intersects=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ot,[{}].concat(mr.call(t)),(function(){}))},fr.distance=nr((function(t,e,r){return new I(r,t,e)})),fr.circle=nr((function(t,e,r){return new d(r,t,e)})),fr.uuid=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Ve,[{}].concat(mr.call(t)),(function(){}))},fr.range=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(pe,[{}].concat(mr.call(t)),(function(){}))},fr.union=function(){var t;return t=1<=arguments.length?mr.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var n=new r,o=t.apply(n,e);return Object(o)===o?o:n}(Qe,[{}].concat(mr.call(t)),(function(){}))},t.exports=fr},function(t,e){t.exports=function(t,e){if("undefined"==typeof Blob||!(t instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof e)throw new Error("second argument must be a function");var r=new FileReader;r.addEventListener("loadend",(function t(n){r.removeEventListener("loadend",t,!1),n.error?e(n.error):e(null,Buffer.from(r.result))}),!1),r.readAsArrayBuffer(t)}},function(t,e,r){var n;
/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */!function(o){var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=10;function c(){this._events={},this._conf&&u.call(this,this._conf)}function u(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners&&(this._events.maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),this.wildcard&&(this.listenerTree={}))}function a(t){this._events={},this.newListener=!1,u.call(this,t)}function p(t,e,r,n){if(!r)return[];var o,i,s,c,u,a,l,f=[],h=e.length,_=e[n],y=e[n+1];if(n===h&&r._listeners){if("function"==typeof r._listeners)return t&&t.push(r._listeners),[r];for(o=0,i=r._listeners.length;o<i;o++)t&&t.push(r._listeners[o]);return[r]}if("*"===_||"**"===_||r[_]){if("*"===_){for(s in r)"_listeners"!==s&&r.hasOwnProperty(s)&&(f=f.concat(p(t,e,r[s],n+1)));return f}if("**"===_){for(s in(l=n+1===h||n+2===h&&"*"===y)&&r._listeners&&(f=f.concat(p(t,e,r,h))),r)"_listeners"!==s&&r.hasOwnProperty(s)&&("*"===s||"**"===s?(r[s]._listeners&&!l&&(f=f.concat(p(t,e,r[s],h))),f=f.concat(p(t,e,r[s],n))):f=s===y?f.concat(p(t,e,r[s],n+2)):f.concat(p(t,e,r[s],n)));return f}f=f.concat(p(t,e,r[_],n+1))}if((c=r["*"])&&p(t,e,c,n+1),u=r["**"])if(n<h)for(s in u._listeners&&p(t,e,u,h),u)"_listeners"!==s&&u.hasOwnProperty(s)&&(s===y?p(t,e,u[s],n+2):s===_?p(t,e,u[s],n+1):((a={})[s]=u[s],p(t,e,{"**":a},n+1)));else u._listeners?p(t,e,u,h):u["*"]&&u["*"]._listeners&&p(t,e,u["*"],h);return f}function l(t,e){for(var r=0,n=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;r+1<n;r++)if("**"===t[r]&&"**"===t[r+1])return;for(var o=this.listenerTree,c=t.shift();c;){if(o[c]||(o[c]={}),o=o[c],0===t.length){if(o._listeners){if("function"==typeof o._listeners)o._listeners=[o._listeners,e];else if(i(o._listeners)&&(o._listeners.push(e),!o._listeners.warned)){var u=s;void 0!==this._events.maxListeners&&(u=this._events.maxListeners),u>0&&o._listeners.length>u&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace())}}else o._listeners=e;return!0}c=t.shift()}return!0}a.prototype.delimiter=".",a.prototype.setMaxListeners=function(t){this._events||c.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t},a.prototype.event="",a.prototype.once=function(t,e){return this.many(t,1,e),this},a.prototype.many=function(t,e,r){var n=this;if("function"!=typeof r)throw new Error("many only accepts instances of Function");function o(){0==--e&&n.off(t,o),r.apply(this,arguments)}return o._origin=r,this.on(t,o),n},a.prototype.emit=function(){this._events||c.call(this);var t,e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];for(o=0,r=this._all.length;o<r;o++)this.event=e,this._all[o].apply(this,n)}if("error"===e&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){t=[];var i="string"==typeof e?e.split(this.delimiter):e.slice();p.call(this,t,i,this.listenerTree,0)}else t=this._events[e];if("function"==typeof t){if(this.event=e,1===arguments.length)t.call(this);else if(arguments.length>1)switch(arguments.length){case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];t.apply(this,n)}return!0}if(t){for(r=arguments.length,n=new Array(r-1),o=1;o<r;o++)n[o-1]=arguments[o];var s=t.slice();for(o=0,r=s.length;o<r;o++)this.event=e,s[o].apply(this,n);return s.length>0||!!this._all}return!!this._all},a.prototype.on=function(t,e){if("function"==typeof t)return this.onAny(t),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");if(this._events||c.call(this),this.emit("newListener",t,e),this.wildcard)return l.call(this,t,e),this;if(this._events[t]){if("function"==typeof this._events[t])this._events[t]=[this._events[t],e];else if(i(this._events[t])&&(this._events[t].push(e),!this._events[t].warned)){var r=s;void 0!==this._events.maxListeners&&(r=this._events.maxListeners),r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}}else this._events[t]=e;return this},a.prototype.onAny=function(t){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(t),this},a.prototype.addListener=a.prototype.on,a.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var r,n=[];if(this.wildcard){var o="string"==typeof t?t.split(this.delimiter):t.slice();n=p.call(this,null,o,this.listenerTree,0)}else{if(!this._events[t])return this;r=this._events[t],n.push({_listeners:r})}for(var s=0;s<n.length;s++){var c=n[s];if(r=c._listeners,i(r)){for(var u=-1,a=0,l=r.length;a<l;a++)if(r[a]===e||r[a].listener&&r[a].listener===e||r[a]._origin&&r[a]._origin===e){u=a;break}if(u<0)continue;return this.wildcard?c._listeners.splice(u,1):this._events[t].splice(u,1),0===r.length&&(this.wildcard?delete c._listeners:delete this._events[t]),this}(r===e||r.listener&&r.listener===e||r._origin&&r._origin===e)&&(this.wildcard?delete c._listeners:delete this._events[t])}return this},a.prototype.offAny=function(t){var e,r=0,n=0;if(t&&this._all&&this._all.length>0){for(r=0,n=(e=this._all).length;r<n;r++)if(t===e[r])return e.splice(r,1),this}else this._all=[];return this},a.prototype.removeListener=a.prototype.off,a.prototype.removeAllListeners=function(t){if(0===arguments.length)return!this._events||c.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),r=p.call(this,null,e,this.listenerTree,0),n=0;n<r.length;n++){var o=r[n];o._listeners=null}else{if(!this._events[t])return this;this._events[t]=null}return this},a.prototype.listeners=function(t){if(this.wildcard){var e=[],r="string"==typeof t?t.split(this.delimiter):t.slice();return p.call(this,e,r,this.listenerTree,0),e}return this._events||c.call(this),this._events[t]||(this._events[t]=[]),i(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},a.prototype.listenersAny=function(){return this._all?this._all:[]},void 0===(n=function(){return a}.call(e,r,e,t))||(t.exports=n)}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){this.offset=0,this.lastChunk=!1,this.chunk=null,this.chunkLength=0,this.headerSize=8,this.lengthPadding=0,this.header=null};n.prototype.addChunk=function(t){if(!this.chunk||this.offset===this.chunkLength)return this.chunk=t,this.chunkLength=t.length,void(this.offset=0);var e=t.length,r=this.chunkLength+e;if(r>this.chunk.length){for(var n=2*this.chunk.length;r>=n;)n*=2;var o=Buffer.alloc(n);this.chunk.copy(o),this.chunk=o}t.copy(this.chunk,this.chunkLength),this.chunkLength=r},n.prototype.read=function(){if(this.chunkLength<this.headerSize+4+this.offset)return!1;var t=this.chunk.readInt32LE(this.offset+this.headerSize)+this.lengthPadding;if(t>this.chunkLength-(this.offset+4+this.headerSize))return!1;var e=this.chunk.slice(this.offset,this.offset+t+4+this.headerSize);return this.offset+=t+12,e}},function(t,e,r){t.exports=r(31)},function(t,e,r){"use strict";r.r(e),r.d(e,"connect",(function(){return p})),r.d(e,"default",(function(){return l}));var n=r(4),o=r.n(n);r.d(e,"Promise",(function(){return o.a}));var i=r(10),s=r.n(i);r.d(e,"rethinkdb",(function(){return s.a}));var c=r(5),u=r.n(c);r.d(e,"protodef",(function(){return u.a}));var a=r(11);function p(t){var e=t.host,r=t.port,n=t.path,i=t.secure,c=t.wsProtocols,u=t.wsBinaryType,p=t.db,l=t.simulatedLatencyMs,f=t.user,h=t.password,_=t.waitForPacket;Object(a.configureTcpPolyfill)({path:n,secure:i,wsProtocols:c,wsBinaryType:u,simulatedLatencyMs:l,waitForPacket:_});var y=process.browser;process.browser=!1;var d=f,v=h;void 0===d&&(d="default"),void 0===v&&(v="");var m={host:e,port:r,db:p,user:d,password:v},g=o.a.promisify(s.a.connect)(m);return process.browser=y,g.then((function(t){return Object(a.setIsConnected)(),t}))}var l={rethinkdb:s.a,protodef:u.a,Promise:o.a,connect:p}},function(t,e,r){"use strict";t.exports=function(){var e,n=function(){return new p("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},o=function(){return new S.PromiseInspection(this._target())},i=function(t){return S.reject(new p(t))},s=r(0);e=s.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},s.notEnumerableProp(S,"_getDomain",e);var c={},u=r(2),a=r(1),p=S.TypeError=a.TypeError;S.RangeError=a.RangeError,S.CancellationError=a.CancellationError,S.TimeoutError=a.TimeoutError,S.OperationalError=a.OperationalError,S.RejectionError=a.OperationalError,S.AggregateError=a.AggregateError;var l=function(){},f={},h={e:null},_=r(35)(S,l),y=r(36)(S,l,_,i),d=r(37)(),v=r(38)(S,d),m=r(39)(S,d,v),g=r(40)(h),w=r(14),b=w._nodebackForPromise,E=s.errorObj,O=s.tryCatch;function S(t){if("function"!=typeof t)throw new p("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==S)throw new p("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,t!==l&&this._resolveFromResolver(t)}function k(t){var e=new S(l);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._progressHandler0=t,e._promise0=t,e._receiver0=t,e._settledValue=t}return S.prototype.toString=function(){return"[object Promise]"},S.prototype.caught=S.prototype.catch=function(t){var e=arguments.length;if(e>1){var r,n=new Array(e-1),o=0;for(r=0;r<e-1;++r){var i=arguments[r];if("function"!=typeof i)return S.reject(new p("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));n[o++]=i}n.length=o,t=arguments[r];var s=new g(n,t,this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},S.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},S.prototype.then=function(t,e,r){if(v()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+s.classString(t);arguments.length>1&&(n+=", "+s.classString(e)),this._warn(n)}return this._then(t,e,r,void 0,void 0)},S.prototype.done=function(t,e,r){this._then(t,e,r,void 0,void 0)._setIsFinal()},S.prototype.spread=function(t,e){return this.all()._then(t,e,void 0,f,void 0)},S.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},S.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},S.prototype.all=function(){return new y(this).promise()},S.prototype.error=function(t){return this.caught(s.originatesFromRejection,t)},S.getNewLibraryCopy=t.exports,S.is=function(t){return t instanceof S},S.fromNode=function(t){var e=new S(l),r=O(t)(b(e));return r===E&&e._rejectCallback(r.e,!0,!0),e},S.all=function(t){return new y(t).promise()},S.defer=S.pending=function(){var t=new S(l);return new w(t)},S.cast=function(t){var e=_(t);if(!(e instanceof S)){var r=e;(e=new S(l))._fulfillUnchecked(r)}return e},S.resolve=S.fulfilled=S.cast,S.reject=S.rejected=function(t){var e=new S(l);return e._captureStackTrace(),e._rejectCallback(t,!0),e},S.setScheduler=function(t){if("function"!=typeof t)throw new p("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var e=u._schedule;return u._schedule=t,e},S.prototype._then=function(t,r,n,o,i){var s=void 0!==i,c=s?i:new S(l);s||(c._propagateFrom(this,5),c._captureStackTrace());var a=this._target();a!==this&&(void 0===o&&(o=this._boundTo),s||c._setIsMigrated());var p=a._addCallbacks(t,r,n,c,o,e());return a._isResolved()&&!a._isSettlePromisesQueued()&&u.invoke(a._settlePromiseAtPostResolution,a,p),c},S.prototype._settlePromiseAtPostResolution=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(t)},S.prototype._length=function(){return 131071&this._bitField},S.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},S.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},S.prototype._setLength=function(t){this._bitField=-131072&this._bitField|131071&t},S.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},S.prototype._setRejected=function(){this._bitField=134217728|this._bitField},S.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},S.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},S.prototype._isFinal=function(){return(33554432&this._bitField)>0},S.prototype._cancellable=function(){return(67108864&this._bitField)>0},S.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},S.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},S.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},S.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},S.prototype._isMigrated=function(){return(4194304&this._bitField)>0},S.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[5*t-5+4];if(e!==c)return void 0===e&&this._isBound()?this._boundValue():e},S.prototype._promiseAt=function(t){return 0===t?this._promise0:this[5*t-5+3]},S.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[5*t-5+0]},S.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[5*t-5+1]},S.prototype._boundValue=function(){var t=this._boundTo;return void 0!==t&&t instanceof S?t.isFulfilled()?t.value():void 0:t},S.prototype._migrateCallbacks=function(t,e){var r=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),o=t._progressHandlerAt(e),i=t._promiseAt(e),s=t._receiverAt(e);i instanceof S&&i._setIsMigrated(),void 0===s&&(s=c),this._addCallbacks(r,n,o,i,s,null)},S.prototype._addCallbacks=function(t,e,r,n,o,i){var s=this._length();if(s>=131066&&(s=0,this._setLength(0)),0===s)this._promise0=n,void 0!==o&&(this._receiver0=o),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===i?t:i.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:i.bind(e)),"function"==typeof r&&(this._progressHandler0=null===i?r:i.bind(r));else{var c=5*s-5;this[c+3]=n,this[c+4]=o,"function"==typeof t&&(this[c+0]=null===i?t:i.bind(t)),"function"==typeof e&&(this[c+1]=null===i?e:i.bind(e)),"function"==typeof r&&(this[c+2]=null===i?r:i.bind(r))}return this._setLength(s+1),s},S.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=131066&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=5*r-5;this[n+3]=e,this[n+4]=t}this._setLength(r+1)},S.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},S.prototype._resolveCallback=function(t,e){if(!this._isFollowingOrFulfilledOrRejected()){if(t===this)return this._rejectCallback(n(),!1,!0);var r=_(t,this);if(!(r instanceof S))return this._fulfill(t);var o=1|(e?4:0);this._propagateFrom(r,o);var i=r._target();if(i._isPending()){for(var s=this._length(),c=0;c<s;++c)i._migrateCallbacks(this,c);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else i._isFulfilled()?this._fulfillUnchecked(i._value()):this._rejectUnchecked(i._reason(),i._getCarriedStackTrace())}},S.prototype._rejectCallback=function(t,e,r){r||s.markAsOriginatingFromRejection(t);var n=s.ensureErrorObject(t),o=n===t;this._attachExtraTrace(n,!!e&&o),this._reject(t,o?void 0:n)},S.prototype._resolveFromResolver=function(t){var e=this;this._captureStackTrace(),this._pushContext();var r=!0,n=O(t)((function(t){null!==e&&(e._resolveCallback(t),e=null)}),(function(t){null!==e&&(e._rejectCallback(t,r),e=null)}));r=!1,this._popContext(),void 0!==n&&n===E&&null!==e&&(e._rejectCallback(n.e,!0,!0),e=null)},S.prototype._settlePromiseFromHandler=function(t,e,r,o){var i;if(!o._isRejected())if(o._pushContext(),i=e!==f||this._isRejected()?O(t).call(e,r):O(t).apply(this._boundValue(),r),o._popContext(),i===E||i===o||i===h){var s=i===o?n():i.e;o._rejectCallback(s,!1,!0)}else o._resolveCallback(i)},S.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},S.prototype._followee=function(){return this._rejectionHandler0},S.prototype._setFollowee=function(t){this._rejectionHandler0=t},S.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},S.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&t._isBound()&&this._setBoundTo(t._boundTo)},S.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},S.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},S.prototype._settlePromiseAt=function(t){var e=this._promiseAt(t),r=e instanceof S;if(r&&e._isMigrated())return e._unsetIsMigrated(),u.invoke(this._settlePromiseAt,this,t);var n=this._isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,i=this._settledValue,s=this._receiverAt(t);this._clearCallbackDataAtIndex(t),"function"==typeof n?r?this._settlePromiseFromHandler(n,s,i,e):n.call(s,i,e):s instanceof y?s._isResolved()||(this._isFulfilled()?s._promiseFulfilled(i,e):s._promiseRejected(i,e)):r&&(this._isFulfilled()?e._fulfill(i):e._reject(i,o)),t>=4&&4==(31&t)&&u.invokeLater(this._setLength,this,0)},S.prototype._clearCallbackDataAtIndex=function(t){if(0===t)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var e=5*t-5;this[e+3]=this[e+4]=this[e+0]=this[e+1]=this[e+2]=void 0}},S.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},S.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},S.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},S.prototype._queueSettlePromises=function(){u.settlePromises(this),this._setSettlePromisesQueued()},S.prototype._fulfillUnchecked=function(t){if(t===this){var e=n();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._setFulfilled(),this._settledValue=t,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},S.prototype._rejectUncheckedCheckError=function(t){var e=s.ensureErrorObject(t);this._rejectUnchecked(t,e===t?void 0:e)},S.prototype._rejectUnchecked=function(t,e){if(t===this){var r=n();return this._attachExtraTrace(r),this._rejectUnchecked(r)}this._setRejected(),this._settledValue=t,this._cleanValues(),this._isFinal()?u.throwLater((function(t){throw"stack"in t&&u.invokeFirst(d.unhandledRejection,void 0,t),t}),void 0===e?t:e):(void 0!==e&&e!==t&&this._setCarriedStackTrace(e),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled())},S.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var t=this._length(),e=0;e<t;e++)this._settlePromiseAt(e)},s.notEnumerableProp(S,"_makeSelfResolutionError",n),r(41)(S,y),r(42)(S,l,_,i),r(43)(S,l,_),r(44)(S,h,_),r(45)(S),r(46)(S),r(47)(S,y,_,l),S.version="2.11.0",S.Promise=S,r(48)(S,y,i,_,l),r(49)(S),r(50)(S,i,_,m),r(51)(S,i,l,_),r(52)(S),r(53)(S),r(54)(S,y,_,i),r(55)(S,l,_,i),r(56)(S,y,i,_,l),r(57)(S,y),r(58)(S,y,i),r(59)(S,l),r(60)(S),r(61)(S,l),r(62)(S,l),r(63)(S,l),s.toFastProperties(S),s.toFastProperties(S.prototype),k({a:1}),k({b:2}),k({c:3}),k(1),k((function(){})),k(void 0),k(!1),k(new S(l)),d.setBounds(u.firstLineError,s.lastLineError),S}},function(t,e,r){"use strict";var n,o=r(0);if(o.isNode&&"undefined"==typeof MutationObserver){var i=global.setImmediate,s=process.nextTick;n=o.isRecentNode?function(t){i.call(global,t)}:function(t){s.call(process,t)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?n="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}:(n=function(t){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}).isStatic=!0;t.exports=n},function(t,e,r){"use strict";function n(t){this._capacity=t,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(t){return this._capacity<t},n.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},n.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var r=(this._front-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},n.prototype.unshift=function(t,e,r){this._unshiftOne(r),this._unshiftOne(e),this._unshiftOne(t)},n.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=r,this._length=n},n.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},t.exports=n},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=n.errorObj,i=n.isObject;function s(t){return t.then}var c={}.hasOwnProperty;return function(r,u){if(i(r)){if(r instanceof t)return r;if(function(t){return c.call(t,"_promise0")}(r)){var a=new t(e);return r._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a}var p=n.tryCatch(s)(r);if(p===o){u&&u._pushContext();a=t.reject(p.e);return u&&u._popContext(),a}if("function"==typeof p)return function(r,i,s){var c=new t(e),u=c;s&&s._pushContext();c._captureStackTrace(),s&&s._popContext();var a=!0,p=n.tryCatch(i).call(r,(function(t){if(!c)return;c._resolveCallback(t),c=null}),(function(t){if(!c)return;c._rejectCallback(t,a,!0),c=null}),(function(t){if(!c)return;"function"==typeof c._progress&&c._progress(t)}));a=!1,c&&p===o&&(c._rejectCallback(p.e,!0,!0),c=null);return u}(r,p,u)}return r}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0).isArray;function s(r){var n,o=this._promise=new t(e);r instanceof t&&(n=r,o._propagateFrom(n,5)),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function e(r,s){var c=n(this._values,this._promise);if(c instanceof t){if(c=c._target(),this._values=c,!c._isFulfilled())return c._isPending()?void c._then(e,this._reject,void 0,this,s):void this._reject(c._reason());if(c=c._value(),!i(c)){var u=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(u)}}else if(!i(c))return void this._promise._reject(o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0!==c.length){var a=this.getActualLength(c.length);this._length=a,this._values=this.shouldCopyValues()?new Array(a):this._values;for(var p=this._promise,l=0;l<a;++l){var f=this._isResolved(),h=n(c[l],p);h instanceof t?(h=h._target(),f?h._ignoreRejections():h._isPending()?h._proxyPromiseArray(this,l):h._isFulfilled()?this._promiseFulfilled(h._value(),l):this._promiseRejected(h._reason(),l)):f||this._promiseFulfilled(h,l)}}else-5===s?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{}}}(s))},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},s.prototype.__hardReject__=s.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1,!0)},s.prototype._promiseProgressed=function(t,e){this._promise._progress({index:e,value:t})},s.prototype._promiseFulfilled=function(t,e){this._values[e]=t,++this._totalResolved>=this._length&&this._resolve(this._values)},s.prototype._promiseRejected=function(t,e){this._totalResolved++,this._reject(t)},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(t){return t},s}},function(t,e,r){"use strict";t.exports=function(){var t,e=r(2),n=r(0),o=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,i=null,s=null,c=!1;function u(t){this._parent=t;var e=this._length=1+(void 0===t?0:t._length);y(this,u),e>32&&this.uncycle()}function a(t){for(var e=[],r=0;r<t.length;++r){var n=t[r],o=i.test(n)||"    (No stack trace)"===n,s=o&&l(n);o&&!s&&(c&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function p(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}n.inherits(u,Error),u.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],r={},n=0,o=this;void 0!==o;++n)e.push(o),o=o._parent;for(n=(t=this._length=n)-1;n>=0;--n){var i=e[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<t;++n){var s=r[e[n].stack];if(void 0!==s&&s!==n){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[n]._parent=void 0,e[n]._length=1;var c=n>0?e[n-1]:this;s<t-1?(c._parent=e[s+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var u=c._length+1,a=n-2;a>=0;--a)e[a]._length=u,u++;return}}}},u.prototype.parent=function(){return this._parent},u.prototype.hasParent=function(){return void 0!==this._parent},u.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=u.parseStackAndMessage(t),r=e.message,o=[e.stack],i=this;void 0!==i;)o.push(a(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],r=1;r<t.length;++r){for(var n=t[r],o=e.length-1,i=e[o],s=-1,c=n.length-1;c>=0;--c)if(n[c]===i){s=c;break}for(c=s;c>=0;--c){var u=n[c];if(e[o]!==u)break;e.pop(),o--}e=n}}(o),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(o),n.notEnumerableProp(t,"stack",function(t,e){for(var r=0;r<e.length-1;++r)e[r].push("From previous event:"),e[r]=e[r].join("\n");r<e.length&&(e[r]=e[r].join("\n"));return t+"\n"+e.join("\n")}(r,o)),n.notEnumerableProp(t,"__stackCleaned__",!0)}},u.parseStackAndMessage=function(t){var e=t.stack;return{message:t.toString(),stack:a(e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),r=0;r<e.length;++r){var n=e[r];if("    (No stack trace)"===n||i.test(n))break}return r>0&&(e=e.slice(r)),e}(t):["    (No stack trace)"])}},u.formatAndLogError=function(e,r){if("undefined"!=typeof console){var n;if("object"==typeof e||"function"==typeof e){var o=e.stack;n=r+s(o,e)}else n=r+String(e);"function"==typeof t?t(n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}},u.unhandledRejection=function(t){u.formatAndLogError(t,"^--- With additional stack trace: ")},u.isSupported=function(){return"function"==typeof y},u.fireRejectionEvent=function(t,r,n,o){var i=!1;try{"function"==typeof r&&(i=!0,"rejectionHandled"===t?r(o):r(n,o))}catch(t){e.throwLater(t)}var s=!1;try{s=d(t,n,o)}catch(t){s=!0,e.throwLater(t)}var c=!1;if(_)try{c=_(t.toLowerCase(),{reason:n,promise:o})}catch(t){c=!0,e.throwLater(t)}s||i||c||"unhandledRejection"!==t||u.formatAndLogError(n,"Unhandled rejection ")};var l=function(){return!1},f=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function h(t){var e=t.match(f);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}u.setBounds=function(t,e){if(u.isSupported()){for(var r,n,i=t.stack.split("\n"),s=e.stack.split("\n"),c=-1,a=-1,p=0;p<i.length;++p){if(f=h(i[p])){r=f.fileName,c=f.line;break}}for(p=0;p<s.length;++p){var f;if(f=h(s[p])){n=f.fileName,a=f.line;break}}c<0||a<0||!r||!n||r!==n||c>=a||(l=function(t){if(o.test(t))return!0;var e=h(t);return!!(e&&e.fileName===r&&c<=e.line&&e.line<=a)})}};var _,y=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():p(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,i=t,s=e;var r=Error.captureStackTrace;return l=function(t){return o.test(t)},function(t,e){Error.stackTraceLimit=Error.stackTraceLimit+6,r(t,e),Error.stackTraceLimit=Error.stackTraceLimit-6}}var n,u=new Error;if("string"==typeof u.stack&&u.stack.split("\n")[0].indexOf("stackDetection@")>=0)return i=/@/,s=e,c=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){n="stack"in t}return"stack"in u||!n||"number"!=typeof Error.stackTraceLimit?(s=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?p(e):e.toString()},null):(i=t,s=e,function(t){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}(),d=function(){if(n.isNode)return function(t,e,r){return"rejectionHandled"===t?process.emit(t,r):process.emit(t,e,r)};var t=!1,e=!0;try{var r=new self.CustomEvent("test");t=r instanceof CustomEvent}catch(t){}if(!t)try{var o=document.createEvent("CustomEvent");o.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(o)}catch(t){e=!1}e&&(_=function(e,r){var n;return t?n=new self.CustomEvent(e,{detail:r,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!0,r),!!n&&!self.dispatchEvent(n)});var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),function(t,e,r){var n=i[t],o=self[n];return!!o&&("rejectionHandled"===t?o.call(self,r):o.call(self,e,r),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(t=function(t){console.warn(t)},n.isNode&&process.stderr.isTTY?t=function(t){process.stderr.write("[31m"+t+"[39m\n")}:n.isNode||"string"!=typeof(new Error).stack||(t=function(t){console.warn("%c"+t,"color: red")})),u}},function(t,e,r){"use strict";t.exports=function(t,e){var n,o,i=t._getDomain,s=r(2),c=r(1).Warning,u=r(0),a=u.canAttachTrace,p=u.isNode&&(!!process.env.BLUEBIRD_DEBUG||!1);return u.isNode&&0==process.env.BLUEBIRD_DEBUG&&(p=!1),p&&s.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),s.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){e.fireRejectionEvent("rejectionHandled",n,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),e.fireRejectionEvent("unhandledRejection",o,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return p&&(this._trace=new e(this._peekContext())),this},t.prototype._attachExtraTrace=function(t,r){if(p&&a(t)){var n=this._trace;if(void 0!==n&&r&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var o=e.parseStackAndMessage(t);u.notEnumerableProp(t,"stack",o.message+"\n"+o.stack.join("\n")),u.notEnumerableProp(t,"__stackCleaned__",!0)}}},t.prototype._warn=function(t){var r=new c(t),n=this._peekContext();if(n)n.attachExtraTrace(r);else{var o=e.parseStackAndMessage(r);r.stack=o.message+"\n"+o.stack.join("\n")}e.formatAndLogError(r,"")},t.onPossiblyUnhandledRejection=function(t){var e=i();o="function"==typeof t?null===e?t:e.bind(t):void 0},t.onUnhandledRejectionHandled=function(t){var e=i();n="function"==typeof t?null===e?t:e.bind(t):void 0},t.longStackTraces=function(){if(s.haveItemsQueued()&&!1===p)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(p=e.isSupported())&&s.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return p&&e.isSupported()},e.isSupported()||(t.longStackTraces=function(){},p=!1),function(){return p}}},function(t,e,r){"use strict";t.exports=function(t,e,r){var n=[];function o(){this._trace=new e(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return o.prototype._pushContext=function(){r()&&void 0!==this._trace&&n.push(this._trace)},o.prototype._popContext=function(){r()&&void 0!==this._trace&&n.pop()},t.prototype._peekContext=i,t.prototype._pushContext=o.prototype._pushContext,t.prototype._popContext=o.prototype._popContext,function(){if(r())return new o}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(0),n=r(1),o=e.tryCatch,i=e.errorObj,s=r(7).keys,c=n.TypeError;function u(t,e,r){this._instances=t,this._callback=e,this._promise=r}function a(t,e){var r={},n=o(t).call(r,e);return n===i?n:s(r).length?(i.e=new c("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),i):n}return u.prototype.doFilter=function(e){for(var r=this._callback,n=this._promise._boundValue(),s=0,c=this._instances.length;s<c;++s){var u=this._instances[s],p=u===Error||null!=u&&u.prototype instanceof Error;if(p&&e instanceof u)return(l=o(r).call(n,e))===i?(t.e=l.e,t):l;if("function"==typeof u&&!p){var l,f=a(u,e);if(f===i){e=i.e;break}if(f)return(l=o(r).call(n,e))===i?(t.e=l.e,t):l}}return t.e=e,t},u}},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=r(2),i=n.tryCatch,s=n.errorObj;t.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},t.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(t)},t.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},t.prototype._doProgressWith=function(e){var r=e.value,o=e.handler,c=e.promise,u=e.receiver,a=i(o).call(u,r);if(a===s){if(null!=a.e&&"StopProgressPropagation"!==a.e.name){var p=n.canAttachTrace(a.e)?a.e:new Error(n.toString(a.e));c._attachExtraTrace(p),c._progress(a.e)}}else a instanceof t?a._then(c._progress,null,null,c,void 0):c._progress(a)},t.prototype._progressUnchecked=function(r){for(var n=this._length(),i=this._progress,s=0;s<n;s++){var c=this._progressHandlerAt(s),u=this._promiseAt(s);if(u instanceof t)"function"==typeof c?o.invoke(this._doProgressWith,this,{handler:c,promise:u,receiver:this._receiverAt(s),value:r}):o.invoke(i,u,r);else{var a=this._receiverAt(s);"function"==typeof c?c.call(a,r,u):a instanceof e&&!a._isResolved()&&a._promiseProgressed(r,u)}}}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),s=i.tryCatch;t.method=function(r){if("function"!=typeof r)throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var n=new t(e);n._captureStackTrace(),n._pushContext();var o=s(r).apply(this,arguments);return n._popContext(),n._resolveFromSyncValue(o),n}},t.attempt=t.try=function(r,n,c){if("function"!=typeof r)return o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var u=new t(e);u._captureStackTrace(),u._pushContext();var a=i.isArray(n)?s(r).apply(c,n):s(r).call(c,n);return u._popContext(),u._resolveFromSyncValue(a),u},t.prototype._resolveFromSyncValue=function(t){t===i.errorObj?this._rejectCallback(t.e,!1,!0):this._resolveCallback(t,!0)}}},function(t,e,r){"use strict";t.exports=function(t,e,r){var n=function(t,e){this._reject(e)},o=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(n,n,null,this,t)},i=function(t,e){this._isPending()&&this._resolveCallback(e.target)},s=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(n){var c=r(n),u=new t(e);u._propagateFrom(this,1);var a=this._target();if(u._setBoundTo(c),c instanceof t){var p={promiseRejectionQueued:!1,promise:u,target:a,bindingPromise:c};a._then(e,o,u._progress,u,p),c._then(i,s,u._progress,u,p)}else u._resolveCallback(a);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=131072|this._bitField,this._boundTo=t):this._bitField=-131073&this._bitField},t.prototype._isBound=function(){return 131072==(131072&this._bitField)},t.bind=function(n,o){var i=r(n),s=new t(e);return s._setBoundTo(i),i instanceof t?i._then((function(){s._resolveCallback(o)}),s._reject,s._progress,s,null):s._resolveCallback(o),s}}},function(t,e,r){"use strict";t.exports=function(t,e,n){var o=r(0),i=o.isPrimitive,s=o.thrower;function c(){return this}function u(){throw this}function a(t,e,r){var n,o;return n=i(e)?r?(o=e,function(){return o}):function(t){return function(){throw t}}(e):r?c:u,t._then(n,s,void 0,e,void 0)}function p(r){var o=this.promise,i=this.handler,s=o._isBound()?i.call(o._boundValue()):i();if(void 0!==s){var c=n(s,o);if(c instanceof t)return a(c=c._target(),r,o.isFulfilled())}return o.isRejected()?(e.e=r,e):r}function l(e){var r=this.promise,o=this.handler,i=r._isBound()?o.call(r._boundValue(),e):o(e);if(void 0!==i){var s=n(i,r);if(s instanceof t)return a(s=s._target(),e,!0)}return e}t.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?p:l,e?p:void 0,void 0,r,void 0)},t.prototype.lastly=t.prototype.finally=function(t){return this._passThroughHandler(t,!0)},t.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},function(t,e,r){"use strict";var n=r(0).isPrimitive;t.exports=function(t){var e=function(){return this},r=function(){throw this},o=function(){},i=function(){throw void 0},s=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype.return=t.prototype.thenReturn=function(r){return void 0===r?this.then(o):n(r)?this._then(s(r,2),void 0,void 0,void 0,void 0):(r instanceof t&&r._ignoreRejections(),this._then(e,void 0,void 0,r,void 0))},t.prototype.throw=t.prototype.thenThrow=function(t){return void 0===t?this.then(i):n(t)?this._then(s(t,1),void 0,void 0,void 0,void 0):this._then(r,void 0,void 0,t,void 0)}}},function(t,e,r){"use strict";t.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValue=t._settledValue):(this._bitField=0,this._settledValue=void 0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},e.prototype.isFulfilled=t.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype._isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype._isPending=function(){return 0==(402653184&this._bitField)},e.prototype.isResolved=t.prototype._isResolved=function(){return(402653184&this._bitField)>0},t.prototype.isPending=function(){return this._target()._isPending()},t.prototype.isRejected=function(){return this._target()._isRejected()},t.prototype.isFulfilled=function(){return this._target()._isFulfilled()},t.prototype.isResolved=function(){return this._target()._isResolved()},t.prototype._value=function(){return this._settledValue},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},t.prototype.value=function(){var t=this._target();if(!t.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return t._settledValue},t.prototype.reason=function(){var t=this._target();if(!t.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return t._unsetRejectionIsUnhandled(),t._settledValue},t.PromiseInspection=e}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),s=i.canEvaluate,c=i.tryCatch,u=i.errorObj;if(s){for(var a=function(t){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,t))},p=function(t){for(var e=[],r=1;r<=t;++r)e.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,e.join(", ")))},l=[],f=[void 0],h=1;h<=5;++h)l.push(a(h)),f.push(p(h));var _=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};_.prototype.callers=f,_.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(e>=r){var n=this.callers[r];t._pushContext();var o=c(n)(this);t._popContext(),o===u?t._rejectCallback(o.e,!1,!0):t._resolveCallback(o)}else this.now=e};var y=function(t){this._reject(t)}}t.join=function(){var r,i=arguments.length-1;if(i>0&&"function"==typeof arguments[i]&&(r=arguments[i],i<6&&s)){(v=new t(o))._captureStackTrace();for(var c=new _(i,r),u=l,a=0;a<i;++a){var p=n(arguments[a],v);p instanceof t?(p=p._target())._isPending()?p._then(u[a],y,void 0,v,c):p._isFulfilled()?u[a].call(v,p._value(),c):v._reject(p._reason()):u[a].call(v,p,c)}return v}for(var f=arguments.length,h=new Array(f),d=0;d<f;++d)h[d]=arguments[d];r&&h.pop();var v=new e(h).promise();return void 0!==r?v.spread(r):v}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o,i){var s=t._getDomain,c=r(2),u=r(0),a=u.tryCatch,p=u.errorObj,l={},f=[];function h(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace();var o=s();this._callback=null===o?e:o.bind(e),this._preservedValues=n===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=r>=1?[]:f,c.invoke(_,this,void 0)}function _(){this._init$(void 0,-2)}function y(t,e,r,n){var o="object"==typeof r&&null!==r?r.concurrency:0;return new h(t,e,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,n)}u.inherits(h,e),h.prototype._init=function(){},h.prototype._promiseFulfilled=function(e,r){var n=this._values,i=this.length(),s=this._preservedValues,c=this._limit;if(n[r]===l){if(n[r]=e,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(c>=1&&this._inFlight>=c)return n[r]=e,void this._queue.push(r);null!==s&&(s[r]=e);var u=this._callback,f=this._promise._boundValue();this._promise._pushContext();var h=a(u).call(f,e,r,i);if(this._promise._popContext(),h===p)return this._reject(h.e);var _=o(h,this._promise);if(_ instanceof t){if((_=_._target())._isPending())return c>=1&&this._inFlight++,n[r]=l,_._proxyPromiseArray(this,r);if(!_._isFulfilled())return this._reject(_._reason());h=_._value()}n[r]=h}++this._totalResolved>=i&&(null!==s?this._filter(n,s):this._resolve(n))},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),o=0,i=0;i<r;++i)t[i]&&(n[o++]=e[i]);n.length=o,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return"function"!=typeof t?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(this,t,e,null).promise()},t.map=function(t,e,r,o){return"function"!=typeof e?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(t,e,r,o).promise()}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(1),n=r(2),o=e.CancellationError;t.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;this._unsetCancellable(),r._target()._rejectCallback(t,!1,!0)},t.prototype.cancel=function(t){return this.isCancellable()?(void 0===t&&(t=new o),n.invokeLater(this._cancel,this,t),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(n.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var t=this.then();return t._unsetCancellable(),t},t.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);return n._setCancellable(),n._cancellationParent=void 0,n}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(1).TypeError,s=r(0).inherits,c=t.PromiseInspection;function u(e){for(var r=e.length,n=0;n<r;++n){var o=e[n];if(o.isRejected())return t.reject(o.error());e[n]=o._settledValue}return e}function a(t){setTimeout((function(){throw t}),0)}function p(e,r){var o=0,i=e.length,s=t.defer();return function c(){if(o>=i)return s.resolve();var u=function(t){var e=n(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(e[o++]);if(u instanceof t&&u._isDisposable()){try{u=n(u._getDisposer().tryDispose(r),e.promise)}catch(t){return a(t)}if(u instanceof t)return u._then(c,a,null,null,null)}c()}(),s.promise}function l(t){var e=new c;return e._settledValue=t,e._bitField=268435456,p(this,e).thenReturn(t)}function f(t){var e=new c;return e._settledValue=t,e._bitField=134217728,p(this,e).thenThrow(t)}function h(t,e,r){this._data=t,this._promise=e,this._context=r}function _(t,e,r){this.constructor$(t,e,r)}function y(t){return h.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}h.prototype.data=function(){return this._data},h.prototype.promise=function(){return this._promise},h.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},h.prototype.tryDispose=function(t){var e=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=null!==e?this.doDispose(e,t):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},h.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},s(_,h),_.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},t.using=function(){var r=arguments.length;if(r<2)return e("you must pass at least 2 arguments to Promise.using");var o,i=arguments[r-1];if("function"!=typeof i)return e("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s=!0;2===r&&Array.isArray(arguments[0])?(r=(o=arguments[0]).length,s=!1):(o=arguments,r--);for(var c=new Array(r),a=0;a<r;++a){var p=o[a];if(h.isDisposer(p)){var _=p;(p=p.promise())._setDisposable(_)}else{var d=n(p);d instanceof t&&(p=d._then(y,null,null,{resources:c,index:a},void 0))}c[a]=p}var v=t.settle(c).then(u).then((function(t){var e;v._pushContext();try{e=s?i.apply(void 0,t):i.call(void 0,t)}finally{v._popContext()}return e}))._then(l,f,void 0,c,void 0);return c.promise=v,v},t.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new _(t,this,o());throw new i}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(1).TypeError,s=r(0),c=s.errorObj,u=s.tryCatch,a=[];function p(e,r,o,i){(this._promise=new t(n))._captureStackTrace(),this._stack=i,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(a):a}p.prototype.promise=function(){return this._promise},p.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},p.prototype._continue=function(e){if(e===c)return this._promise._rejectCallback(e.e,!1,!0);var r=e.value;if(!0===e.done)this._promise._resolveCallback(r);else{var n=o(r,this._promise);if(!(n instanceof t)&&null===(n=function(e,r,n){for(var i=0;i<r.length;++i){n._pushContext();var s=u(r[i])(e);if(n._popContext(),s===c){n._pushContext();var a=t.reject(c.e);return n._popContext(),a}var p=o(s,n);if(p instanceof t)return p}return null}(n,this._yieldHandlers,this._promise)))return void this._throw(new i("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));n._then(this._next,this._throw,void 0,this,null)}},p.prototype._throw=function(t){this._promise._attachExtraTrace(t),this._promise._pushContext();var e=u(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},p.prototype._next=function(t){this._promise._pushContext();var e=u(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},t.coroutine=function(t,e){if("function"!=typeof t)throw new i("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=Object(e).yieldHandler,n=p,o=(new Error).stack;return function(){var e=t.apply(this,arguments),i=new n(void 0,void 0,r,o);return i._generator=e,i._next(void 0),i.promise()}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");a.push(t)},t.spawn=function(r){if("function"!=typeof r)return e("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=new p(r,this),o=n.promise();return n._run(t.spawn),o}}},function(t,e,r){"use strict";t.exports=function(t){var e=r(0),n=r(2),o=e.tryCatch,i=e.errorObj;function s(t,r){if(!e.isArray(t))return c.call(this,t,r);var s=o(r).apply(this._boundValue(),[null].concat(t));s===i&&n.throwLater(s.e)}function c(t,e){var r=this._boundValue(),s=void 0===t?o(e).call(r,null):o(e).call(r,null,t);s===i&&n.throwLater(s.e)}function u(t,e){if(!t){var r=this._target()._getCarriedStackTrace();r.cause=t,t=r}var s=o(e).call(this._boundValue(),t);s===i&&n.throwLater(s.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,e){if("function"==typeof t){var r=c;void 0!==e&&Object(e).spread&&(r=s),this._then(r,u,void 0,this,t)}return this}}},function(t,e,r){"use strict";var n=Object.create;if(n){var o=n(null),i=n(null);o[" size"]=i[" size"]=0}t.exports=function(t){var e,n,s=r(0),c=s.canEvaluate,u=s.isIdentifier,a=function(t){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,t))(f)},p=function(t){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",t))},l=function(t,e,r){var n=r[t];if("function"!=typeof n){if(!u(t))return null;if(n=e(t),r[t]=n,r[" size"]++,r[" size"]>512){for(var o=Object.keys(r),i=0;i<256;++i)delete r[o[i]];r[" size"]=o.length-256}}return n};function f(e,r){var n;if(null!=e&&(n=e[r]),"function"!=typeof n){var o="Object "+s.classString(e)+" has no method '"+s.toString(r)+"'";throw new t.TypeError(o)}return n}function h(t){return f(t,this.pop()).apply(t,this)}function _(t){return t[this]}function y(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}e=function(t){return l(t,a,o)},n=function(t){return l(t,p,i)},t.prototype.call=function(t){for(var r=arguments.length,n=new Array(r-1),o=1;o<r;++o)n[o-1]=arguments[o];if(c){var i=e(t);if(null!==i)return this._then(i,void 0,void 0,n,void 0)}return n.push(t),this._then(h,void 0,void 0,n,void 0)},t.prototype.get=function(t){var e;if("number"==typeof t)e=y;else if(c){var r=n(t);e=null!==r?r:_}else e=_;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0),s=i.isObject,c=r(7);function u(t){for(var e=c.keys(t),r=e.length,n=new Array(2*r),o=0;o<r;++o){var i=e[o];n[o]=t[i],n[o+r]=i}this.constructor$(n)}function a(e){var r,i=n(e);return s(i)?(r=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new u(i).promise(),i instanceof t&&r._propagateFrom(i,4),r):o("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}i.inherits(u,e),u.prototype._init=function(){this._init$(void 0,-3)},u.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){for(var r={},n=this.length(),o=0,i=this.length();o<i;++o)r[this._values[o+n]]=this._values[o];this._resolve(r)}},u.prototype._promiseProgressed=function(t,e){this._promise._progress({key:this._values[e+this.length()],value:t})},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return a(this)},t.props=function(t){return a(t)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o){var i=r(0).isArray,s=function(t){return t.then((function(e){return c(e,t)}))};function c(r,c){var u=n(r);if(u instanceof t)return s(u);if(!i(r))return o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var a=new t(e);void 0!==c&&a._propagateFrom(c,5);for(var p=a._fulfill,l=a._reject,f=0,h=r.length;f<h;++f){var _=r[f];(void 0!==_||f in r)&&t.cast(_)._then(p,l,void 0,a,null)}return a}t.race=function(t){return c(t,void 0)},t.prototype.race=function(){return c(this,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e,n,o,i){var s=t._getDomain,c=r(2),u=r(0),a=u.tryCatch,p=u.errorObj;function l(e,r,n,u){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=u===i?[]:null,this._zerothIsAccum=void 0===n,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var a=o(n,this._promise),p=!1,l=a instanceof t;l&&((a=a._target())._isPending()?a._proxyPromiseArray(this,-1):a._isFulfilled()?(n=a._value(),this._gotAccum=!0):(this._reject(a._reason()),p=!0)),l||this._zerothIsAccum||(this._gotAccum=!0);var h=s();this._callback=null===h?r:h.bind(r),this._accum=n,p||c.invoke(f,this,void 0)}function f(){this._init$(void 0,-5)}function h(t,e,r,o){return"function"!=typeof e?n("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new l(t,e,r,o).promise()}u.inherits(l,e),l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},l.prototype._promiseFulfilled=function(e,r){var n=this._values;n[r]=e;var i,s=this.length(),c=this._preservedValues,u=null!==c,l=this._gotAccum,f=this._valuesPhase;if(!f)for(f=this._valuesPhase=new Array(s),i=0;i<s;++i)f[i]=0;if(i=f[r],0===r&&this._zerothIsAccum?(this._accum=e,this._gotAccum=l=!0,f[r]=0===i?1:2):-1===r?(this._accum=e,this._gotAccum=l=!0):0===i?f[r]=1:(f[r]=2,this._accum=e),l){for(var h,_=this._callback,y=this._promise._boundValue(),d=this._reducingIndex;d<s;++d)if(2!==(i=f[d])){if(1!==i)return;if(e=n[d],this._promise._pushContext(),u?(c.push(e),h=a(_).call(y,e,d,s)):h=a(_).call(y,this._accum,e,d,s),this._promise._popContext(),h===p)return this._reject(h.e);var v=o(h,this._promise);if(v instanceof t){if((v=v._target())._isPending())return f[d]=4,v._proxyPromiseArray(this,d);if(!v._isFulfilled())return this._reject(v._reason());h=v._value()}this._reducingIndex=d+1,this._accum=h}else this._reducingIndex=d+1;this._resolve(u?c:this._accum)}},t.prototype.reduce=function(t,e){return h(this,t,e,null)},t.reduce=function(t,e,r,n){return h(t,e,r,n)}}},function(t,e,r){"use strict";t.exports=function(t,e){var n=t.PromiseInspection;function o(t){this.constructor$(t)}r(0).inherits(o,e),o.prototype._promiseResolved=function(t,e){this._values[t]=e,++this._totalResolved>=this._length&&this._resolve(this._values)},o.prototype._promiseFulfilled=function(t,e){var r=new n;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)},o.prototype._promiseRejected=function(t,e){var r=new n;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)},t.settle=function(t){return new o(t).promise()},t.prototype.settle=function(){return new o(this).promise()}}},function(t,e,r){"use strict";t.exports=function(t,e,n){var o=r(0),i=r(1).RangeError,s=r(1).AggregateError,c=o.isArray;function u(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function a(t,e){if((0|e)!==e||e<0)return n("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var r=new u(t),o=r.promise();return r.setHowMany(e),r.init(),o}o.inherits(u,e),u.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(t){this._howMany=t},u.prototype._promiseFulfilled=function(t){this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},u.prototype._promiseRejected=function(t){if(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()){for(var e=new s,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(t){this._values.push(t)},u.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new i(e)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return a(t,e)},t.prototype.some=function(t){return a(this,t)},t._SomePromiseArray=u}},function(t,e,r){"use strict";t.exports=function(t,e){var n={},o=r(0),i=r(14)._nodebackForPromise,s=o.withAppended,c=o.maybeWrapAsError,u=o.canEvaluate,a=r(1).TypeError,p={__isPromisified__:!0},l=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),f=function(t){return o.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function h(t){return!l.test(t)}function _(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function y(t,e,r){var n=o.getDataPropertyOrDefault(t,e+r,p);return!!n&&_(n)}function d(t,e,r,n){for(var i=o.inheritedDataKeys(t),s=[],c=0;c<i.length;++c){var u=i[c],p=t[u],l=n===f||f(u,p,t);"function"!=typeof p||_(p)||y(t,u,e)||!n(u,p,t,l)||s.push(u,p)}return function(t,e,r){for(var n=0;n<t.length;n+=2){var o=t[n];if(r.test(o))for(var i=o.replace(r,""),s=0;s<t.length;s+=2)if(t[s]===i)throw new a("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",e))}}(s,e,r),s}var v=function(t){return t.replace(/([$])/,"\\$")},m=function(t){return o.filledRange(t,"_arg","")};var g=u?function(r,u,a,p){var l=Math.max(0,function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}(p)-1),f=function(t){for(var e=[t],r=Math.max(0,t-1-3),n=t-1;n>=r;--n)e.push(n);for(n=t+1;n<=3;++n)e.push(n);return e}(l),h="string"==typeof r||u===n;var _="string"==typeof r?"this != null ? this['"+r+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise);                      \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n        ".replace("Parameters",function(t){return o.filledRange(Math.max(t,3),"_arg","")}(l)).replace("[CodeForSwitchCase]",function(){for(var t,e,r,n="",o=0;o<f.length;++o)n+="case "+f[o]+":"+(t=f[o],e=void 0,r=void 0,e=m(t).join(", "),r=t>0?", ":"",(h?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===u?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",e).replace(", ",r));return n+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",h?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",_))(t,p,u,s,c,i,o.tryCatch,o.errorObj,o.notEnumerableProp,e)}:function(r,u,a,p){var l=function(){return this}(),f=r;function h(){var o=u;u===n&&(o=this);var a=new t(e);a._captureStackTrace();var p="string"==typeof f&&this!==l?this[f]:r,h=i(a);try{p.apply(o,s(arguments,h))}catch(t){a._rejectCallback(c(t),!0,!0)}return a}return"string"==typeof f&&(r=p),o.notEnumerableProp(h,"__isPromisified__",!0),h};function w(t,e,r,i){for(var s=new RegExp(v(e)+"$"),c=d(t,e,s,r),u=0,a=c.length;u<a;u+=2){var p=c[u],l=c[u+1],f=p+e;if(i===g)t[f]=g(p,n,p,l,e);else{var h=i(l,(function(){return g(p,n,p,l,e)}));o.notEnumerableProp(h,"__isPromisified__",!0),t[f]=h}}return o.toFastProperties(t),t}function b(t,e){return g(t,e,void 0,t)}t.promisify=function(t,e){if("function"!=typeof t)throw new a("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(_(t))return t;var r=b(t,arguments.length<2?n:e);return o.copyDescriptors(t,r,h),r},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new a("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");var r=(e=Object(e)).suffix;"string"!=typeof r&&(r="Async");var n=e.filter;"function"!=typeof n&&(n=f);var i=e.promisifier;if("function"!=typeof i&&(i=g),!o.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var s=o.inheritedDataKeys(t),c=0;c<s.length;++c){var u=t[s[c]];"constructor"!==s[c]&&o.isClass(u)&&(w(u.prototype,r,n,i),w(u,r,n,i))}return w(t,r,n,i)}}},function(t,e,r){"use strict";t.exports=function(t){var e=t._SomePromiseArray;function r(t){var r=new e(t),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}t.any=function(t){return r(t)},t.prototype.any=function(){return r(this)}}},function(t,e,r){"use strict";t.exports=function(t,e){var r=t.reduce;t.prototype.each=function(t){return r(this,t,null,e)},t.each=function(t,n){return r(t,n,null,e)}}},function(t,e,r){"use strict";t.exports=function(t,e){var n=r(0),o=t.TimeoutError,i=function(t){return s(+this).thenReturn(t)},s=t.delay=function(r,n){if(void 0===n){n=r,r=void 0;var o=new t(e);return setTimeout((function(){o._fulfill()}),n),o}return n=+n,t.resolve(r)._then(i,null,null,n,void 0)};function c(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function u(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}t.prototype.delay=function(t){return s(this,t)},t.prototype.timeout=function(t,e){t=+t;var r=this.then().cancellable();r._cancellationParent=this;var i=setTimeout((function(){!function(t,e){var r;t.isPending()&&(!n.isPrimitive(e)&&e instanceof Error?r=e:("string"!=typeof e&&(e="operation timed out"),r=new o(e)),n.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._cancel(r))}(r,e)}),t);return r._then(c,u,void 0,i,void 0)}}},function(t,e,r){"use strict";t.exports=function(t,e){var r=t.map;t.prototype.filter=function(t,n){return r(this,t,n,e)},t.filter=function(t,n,o){return r(t,n,o,e)}}},function(t,e,r){"use strict";
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */var n=t.exports=r(16);n.Server=r(76),n.Sender=r(20),n.Receiver=r(23),n.createServer=function(t,e){var r=new n.Server(t);return"function"==typeof e&&r.on("connection",e),r},n.connect=n.createConnection=function(t,e){var r=new n(t);return"function"==typeof e&&r.on("open",e),r}},function(t,e){t.exports=require("https")},function(t,e){t.exports=require("stream")},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o=0;function i(t){if(!(this instanceof i))return new i(t);this.id=o++,this.ee=t}i.prototype.on=function(t,e,r){return e.__ultron=this.id,this.ee.on(t,e,r),this},i.prototype.once=function(t,e,r){return e.__ultron=this.id,this.ee.once(t,e,r),this},i.prototype.remove=function(){var t,e=arguments;if(1===e.length&&"string"==typeof e[0])e=e[0].split(/[, ]+/);else if(!e.length)for(t in e=[],this.ee._events)n.call(this.ee._events,t)&&e.push(t);for(var r=0;r<e.length;r++)for(var o=this.ee.listeners(e[r]),i=0;i<o.length;i++){if((t=o[i]).listener){if(t.listener.__ultron!==this.id)continue;delete t.listener.__ultron}else{if(t.__ultron!==this.id)continue;delete t.__ultron}this.ee.removeListener(e[r],t)}return this},i.prototype.destroy=function(){return!!this.ee&&(this.remove(),this.ee=null,!0)},t.exports=i},function(t,e){t.exports=require("fs")},function(t,e){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
t.exports.BufferUtil={merge:function(t,e){for(var r=0,n=0,o=e.length;n<o;++n){var i=e[n];i.copy(t,r),r+=i.length}},mask:function(t,e,r,n,o){for(var i=e.readUInt32LE(0,!0),s=0;s<o-3;s+=4){var c=i^t.readUInt32LE(s,!0);c<0&&(c=4294967296+c),r.writeUInt32LE(c,n+s,!0)}switch(o%4){case 3:r[n+s+2]=t[s+2]^e[2];case 2:r[n+s+1]=t[s+1]^e[1];case 1:r[n+s]=t[s]^e[0]}},unmask:function(t,e){for(var r=e.readUInt32LE(0,!0),n=t.length,o=0;o<n-3;o+=4){var i=r^t.readUInt32LE(o,!0);i<0&&(i=4294967296+i),t.writeUInt32LE(i,o,!0)}switch(n%4){case 3:t[o+2]=t[o+2]^e[2];case 2:t[o+1]=t[o+1]^e[1];case 1:t[o]=t[o]^e[0]}}}},function(t,e){t.exports=require("zlib")},function(t,e,r){"use strict";
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */try{t.exports=r(!function(){var t=new Error("Cannot find module 'utf-8-validate'");throw t.code="MODULE_NOT_FOUND",t}())}catch(e){t.exports=r(72)}},function(t,e){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
t.exports.Validation={isValidUTF8:function(t){return!0}}},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
r(3);function n(t,e,r){if(this instanceof n==!1)throw new TypeError("Classes can't be function-called");"function"==typeof t?(r=e,e=t,t=0):void 0===t&&(t=0),this._growStrategy=(e||function(t,e){return t.used+e}).bind(null,this),this._shrinkStrategy=(r||function(e){return t}).bind(null,this),this._buffer=t?new Buffer(t):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__("size",(function(){return null==this._buffer?0:this._buffer.length})),this.__defineGetter__("used",(function(){return this._used}))}n.prototype.get=function(t){if(null==this._buffer||this._offset+t>this._buffer.length){var e=new Buffer(this._growStrategy(t));this._buffer=e,this._offset=0}this._used+=t;var r=this._buffer.slice(this._offset,this._offset+t);return this._offset+=t,r},n.prototype.reset=function(t){var e=this._shrinkStrategy();e<this.size&&(this._changeFactor-=1),(t||this._changeFactor<-2)&&(this._changeFactor=0,this._buffer=e?new Buffer(e):null),this._offset=0,this._used=0},t.exports=n},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
var n=r(6),o=r(3);n.EventEmitter;function i(t){if(this instanceof i==!1)throw new TypeError("Classes can't be function-called");n.EventEmitter.call(this),this.socket=t,this.continuationFrame=!1,this.isClosed=!1}t.exports=i,o.inherits(i,n.EventEmitter),i.prototype.send=function(t,e,r){if(!this.isClosed){var n="string"==typeof t,o=n?Buffer.byteLength(t):t.length,i=o>127?2:1,s=0==this.continuationFrame,c=!e||!(void 0!==e.fin&&!e.fin),u=new Buffer((s?e&&e.binary?1+i:1:0)+o+(!c||e&&e.binary?0:1)),a=s?1:0;s&&(e&&e.binary?(u.write("","binary"),i>1&&u.write(String.fromCharCode(128+o/128),a++,"binary"),u.write(String.fromCharCode(127&o),a++,"binary")):u.write("\0","binary")),n?u.write(t,a,"utf8"):t.copy(u,a,0),c?(e&&e.binary||u.write("ÿ",a+o,"binary"),this.continuationFrame=!1):this.continuationFrame=!0;try{this.socket.write(u,"binary",r)}catch(t){this.error(t.toString())}}},i.prototype.close=function(t,e,r,n){if(!this.isClosed){this.isClosed=!0;try{this.continuationFrame&&this.socket.write(new Buffer([255],"binary")),this.socket.write(new Buffer([255,0]),"binary",n)}catch(t){this.error(t.toString())}}},i.prototype.ping=function(t,e){},i.prototype.pong=function(t,e){},i.prototype.error=function(t){return this.emit("error",t),this}},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
r(3);var n=0,o=1,i=2,s=3;function c(){if(this instanceof c==!1)throw new TypeError("Classes can't be function-called");this.state=n,this.buffers=[],this.messageEnd=-1,this.spanLength=0,this.dead=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}t.exports=c,c.prototype.add=function(t){var e=this;function r(){if(e.state===n){if(2==t.length&&255==t[0]&&0==t[1])return e.reset(),void e.onclose();if(128===t[0])e.messageEnd=0,e.state=i,t=t.slice(1);else{if(0!==t[0])return void e.error("payload must start with 0x00 byte",!0);t=t.slice(1),e.state=o}}if(e.state===i){for(var r=0;r<t.length&&128&t[r];)e.messageEnd=128*e.messageEnd+(127&t[r]),++r;r<t.length&&(e.messageEnd=128*e.messageEnd+(127&t[r]),e.state=s,++r),r>0&&(t=t.slice(r))}if(e.state===s){var c=e.messageEnd-e.spanLength;return t.length>=c?(e.buffers.push(t),e.spanLength+=c,e.messageEnd=c,e.parse()):(e.buffers.push(t),void(e.spanLength+=t.length))}if(e.buffers.push(t),-1!=(e.messageEnd=function(t,e){for(var r=0,n=t.length;r<n;++r)if(t[r]===e)return r;return-1}(t,255)))return e.spanLength+=e.messageEnd,e.parse();e.spanLength+=t.length}for(;t;)t=r()},c.prototype.cleanup=function(){this.dead=!0,this.state=n,this.buffers=[]},c.prototype.parse=function(){for(var t=new Buffer(this.spanLength),e=0,r=0,n=this.buffers.length;r<n-1;++r){var i=this.buffers[r];i.copy(t,e),e+=i.length}var s=this.buffers[this.buffers.length-1];this.messageEnd>0&&s.copy(t,e,0,this.messageEnd),this.state!==o&&--this.messageEnd;var c=null;return this.messageEnd<s.length-1&&(c=s.slice(this.messageEnd+1)),this.reset(),this.ontext(t.toString("utf8")),c},c.prototype.error=function(t,e){return this.reset(),this.onerror(t,e),this},c.prototype.reset=function(t){this.dead||(this.state=n,this.buffers=[],this.messageEnd=-1,this.spanLength=0)}},function(t,e,r){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
var n=r(3),o=r(6),i=r(18),s=r(12),c=r(19),u=r(16),a=r(24),p=r(9),l=(r(25),r(17));function f(t,e){if(this instanceof f==!1)return new f(t,e);if(o.EventEmitter.call(this),!(t=new c({host:"0.0.0.0",port:null,server:null,verifyClient:null,handleProtocols:null,path:null,noServer:!1,disableHixie:!1,clientTracking:!0,perMessageDeflate:!0}).merge(t)).isDefinedAndNonNull("port")&&!t.isDefinedAndNonNull("server")&&!t.value.noServer)throw new TypeError("`port` or a `server` must be provided");var r=this;if(t.isDefinedAndNonNull("port"))this._server=i.createServer((function(t,e){var r=i.STATUS_CODES[426];e.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),e.end(r)})),this._server.allowHalfOpen=!1,this._server.listen(t.value.port,t.value.host,e),this._closeServer=function(){r._server&&r._server.close()};else if(t.value.server&&(this._server=t.value.server,t.value.path)){if(this._server._webSocketPaths&&t.value.server._webSocketPaths[t.value.path])throw new Error("two instances of WebSocketServer cannot listen on the same http server path");"object"!=typeof this._server._webSocketPaths&&(this._server._webSocketPaths={}),this._server._webSocketPaths[t.value.path]=1}this._server&&this._server.once("listening",(function(){r.emit("listening")})),void 0!==this._server&&(this._server.on("error",(function(t){r.emit("error",t)})),this._server.on("upgrade",(function(t,e,n){var o=new Buffer(n.length);n.copy(o),r.handleUpgrade(t,e,o,(function(e){r.emit("connection"+t.url,e),r.emit("connection",e)}))}))),this.options=t.value,this.path=t.value.path,this.clients=[]}function h(t,e,r,n){var o=function(){try{e.destroy()}catch(t){}};if(e.on("error",o),t.headers["sec-websocket-key"]){var c=parseInt(t.headers["sec-websocket-version"]);if(-1!==[8,13].indexOf(c)){var p=t.headers["sec-websocket-protocol"],l=c<13?t.headers["sec-websocket-origin"]:t.headers.origin,f=a.parse(t.headers["sec-websocket-extensions"]),h=this,_=function(i){var p=t.headers["sec-websocket-key"],l=s.createHash("sha1");l.update(p+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var _=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+(p=l.digest("base64"))];void 0!==i&&_.push("Sec-WebSocket-Protocol: "+i);var v={};try{v=y.call(h,f)}catch(t){return void d(e,400,"Bad Request")}if(Object.keys(v).length){var m={};Object.keys(v).forEach((function(t){m[t]=[v[t].params]})),_.push("Sec-WebSocket-Extensions: "+a.format(m))}h.emit("headers",_),e.setTimeout(0),e.setNoDelay(!0);try{e.write(_.concat("","").join("\r\n"))}catch(t){try{e.destroy()}catch(t){}return}var g=new u([t,e,r],{protocolVersion:c,protocol:i,extensions:v});h.options.clientTracking&&(h.clients.push(g),g.on("close",(function(){var t=h.clients.indexOf(g);-1!=t&&h.clients.splice(t,1)}))),e.removeListener("error",o),n(g)},v=function(){if("function"!=typeof h.options.handleProtocols)void 0!==p?_(p.split(/, */)[0]):_();else{var t=(p||"").split(/, */),r=!1;h.options.handleProtocols(t,(function(t,n){r=!0,t?_(n):d(e,401,"Unauthorized")}));r||d(e,501,"Could not process protocols")}};if("function"==typeof this.options.verifyClient){var m={origin:l,secure:void 0!==t.connection.authorized||void 0!==t.connection.encrypted,req:t};if(2==this.options.verifyClient.length)return void this.options.verifyClient(m,(function(t,r,n){void 0===r&&(r=401),void 0===n&&(n=i.STATUS_CODES[r]),t?v():d(e,r,n)}));if(!this.options.verifyClient(m))return void d(e,401,"Unauthorized")}v()}else d(e,400,"Bad Request")}else d(e,400,"Bad Request")}function _(t,e,r,n){var o=function(){try{e.destroy()}catch(t){}};if(e.on("error",o),this.options.disableHixie)d(e,401,"Hixie support disabled");else if(t.headers["sec-websocket-key2"]){var c=t.headers.origin,a=this,p=function(){var i;i=t.headers["x-forwarded-host"]?t.headers["x-forwarded-host"]:t.headers.host;var p=("https"===t.headers["x-forwarded-proto"]||e.encrypted?"wss":"ws")+"://"+i+t.url,l=t.headers["sec-websocket-protocol"],f=function(r,i){var f=t.headers["sec-websocket-key1"],h=t.headers["sec-websocket-key2"],_=s.createHash("md5");[f,h].forEach((function(t){var r=parseInt(t.replace(/[^\d]/g,"")),n=t.replace(/[^ ]/g,"").length;0!==n&&r%n==0?(r/=n,_.update(String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,255&r))):d(e,400,"Bad Request")})),_.update(r.toString("binary"));var y=["HTTP/1.1 101 Switching Protocols","Upgrade: WebSocket","Connection: Upgrade","Sec-WebSocket-Location: "+p];void 0!==l&&y.push("Sec-WebSocket-Protocol: "+l),void 0!==c&&y.push("Sec-WebSocket-Origin: "+c),e.setTimeout(0),e.setNoDelay(!0);try{var v=new Buffer(y.concat("","").join("\r\n")),m=new Buffer(_.digest("binary"),"binary"),g=new Buffer(v.length+m.length);v.copy(g,0),m.copy(g,v.length),e.write(g,"binary",(function(r){if(!r){var s=new u([t,e,i],{protocolVersion:"hixie-76",protocol:l});a.options.clientTracking&&(a.clients.push(s),s.on("close",(function(){var t=a.clients.indexOf(s);-1!=t&&a.clients.splice(t,1)}))),e.removeListener("error",o),n(s)}}))}catch(t){try{e.destroy()}catch(t){}return}};if(r&&r.length>=8){var h=r.slice(0,8),_=r.length>8?r.slice(8):null;f.call(a,h,_)}else{h=new Buffer(8);r.copy(h,0);var y=r.length,v=(_=null,function(t){var r=Math.min(t.length,8-y);0!==r&&(t.copy(h,y,0,r),8==(y+=r)&&(e.removeListener("data",v),r<t.length&&(_=t.slice(r)),f.call(a,h,_)))});e.on("data",v)}};if("function"==typeof this.options.verifyClient){var l={origin:c,secure:void 0!==t.connection.authorized||void 0!==t.connection.encrypted,req:t};if(2==this.options.verifyClient.length){a=this;return void this.options.verifyClient(l,(function(t,r,n){void 0===r&&(r=401),void 0===n&&(n=i.STATUS_CODES[r]),t?p.apply(a):d(e,r,n)}))}if(!this.options.verifyClient(l))return void d(e,401,"Unauthorized")}p()}else d(e,400,"Bad Request")}function y(t){var e={},r=this.options.perMessageDeflate;if(r&&t[p.extensionName]){var n=new p(!0!==r?r:{},!0);n.accept(t[p.extensionName]),e[p.extensionName]=n}return e}function d(t,e,r){try{var n=["HTTP/1.1 "+e+" "+r,"Content-type: text/html"];t.write(n.concat("","").join("\r\n"))}catch(t){}finally{try{t.destroy()}catch(t){}}}n.inherits(f,o.EventEmitter),f.prototype.close=function(t){var e=null;try{for(var r=0,n=this.clients.length;r<n;++r)this.clients[r].terminate()}catch(t){e=t}this.path&&this._server._webSocketPaths&&(delete this._server._webSocketPaths[this.path],0==Object.keys(this._server._webSocketPaths).length&&delete this._server._webSocketPaths);try{void 0!==this._closeServer&&this._closeServer()}finally{delete this._server}if(t)t(e);else if(e)throw e},f.prototype.handleUpgrade=function(t,e,r,n){if(this.options.path){var o=l.parse(t.url);if(o&&o.pathname!==this.options.path)return}void 0!==t.headers.upgrade&&"websocket"===t.headers.upgrade.toLowerCase()?t.headers["sec-websocket-key1"]?_.apply(this,arguments):h.apply(this,arguments):d(e,400,"Bad Request")},t.exports=f},function(t,e,r){var n,o,i,s,c,u,a,p,l,f,h,_,y,d,v,m=function(t,e){return function(){return t.apply(e,arguments)}},g=[].slice,w=function(t,e){for(var r in e)b.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},b={}.hasOwnProperty;f=r(8),d=r(13),_=r(5).Response.ResponseType,p=r(4),s=r(6).EventEmitter,l=d.ar,v=d.varar,d.aropt,h=d.mkErr,null==y&&(y=function(t){return setTimeout(t,0)}),i=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.toString=l((function(){return"[object Cursor]"})),e}(u=function(){function t(t,e,r,n){this._eachCb=m(this._eachCb,this),this._conn=t,this._token=e,this._opts=r,this._root=n,this._responses=[],this._responseIndex=0,this._outstandingRequests=1,this._iterations=0,this._endFlag=!1,this._contFlag=!1,this._closeAsap=!1,this._cont=null,this._cbQueue=[],this._closeCb=null,this._closeCbPromise=null,this.next=this._next}return t.prototype.stackSize=100,t.prototype._addResponse=function(t){if(t.t===this._type||t.t===_.SUCCESS_SEQUENCE?t.r.length>0&&this._responses.push(t):this._responses.push(t),this._outstandingRequests-=1,t.t!==this._type&&(this._endFlag=!0,null!=this._closeCb))switch(t.t){case _.COMPILE_ERROR:this._closeCb(h(f.ReqlServerCompileError,t,this._root));break;case _.CLIENT_ERROR:this._closeCb(h(f.ReqlClientError,t,this._root));break;case _.RUNTIME_ERROR:this._closeCb(h(d.errorClass(t.e),t,this._root));break;default:this._closeCb()}return this._contFlag=!1,!1===this._closeAsap?this._promptNext():this.close(this._closeCb),this},t.prototype._getCallback=function(){var t;return this._iterations+=1,t=this._cbQueue.shift(),this._iterations%this.stackSize==this.stackSize-1?function(e,r){return y((function(){return t(e,r)}))}:t},t.prototype._handleRow=function(){var t,e,r;return e=this._responses[0],r=d.recursivelyConvertPseudotype(e.r[this._responseIndex],this._opts),t=this._getCallback(),this._responseIndex+=1,this._responseIndex===e.r.length&&(this._responses.shift(),this._responseIndex=0),t(null,r)},t.prototype.bufferEmpty=function(){return 0===this._responses.length||this._responses[0].r.length<=this._responseIndex},t.prototype._promptNext=function(){var t,e,r;for(null!=this._closeCbPromise&&(t=this._getCallback())(new f.ReqlDriverError("Cursor is closed."));null!=this._cbQueue[0];){if(!0===this.bufferEmpty())return void(!0===this._endFlag?(t=this._getCallback())(new f.ReqlDriverError("No more rows in the cursor.")):this._responses.length<=1&&this._promptCont());switch(r=this._responses[0],1===this._responses.length&&this._promptCont(),r.t){case _.SUCCESS_PARTIAL:this._handleRow();break;case _.SUCCESS_SEQUENCE:0===r.r.length?this._responses.shift():this._handleRow();break;case _.COMPILE_ERROR:this._responses.shift(),(t=this._getCallback())(h(f.ReqlServerCompileError,r,this._root));break;case _.CLIENT_ERROR:this._responses.shift(),(t=this._getCallback())(h(f.ReqlClientError,r,this._root));break;case _.RUNTIME_ERROR:this._responses.shift(),t=this._getCallback(),e=d.errorClass(r.e),t(h(e,r,this._root));break;default:this._responses.shift(),(t=this._getCallback())(new f.ReqlDriverError("Unknown response type for cursor"))}}},t.prototype._promptCont=function(){if(!this._contFlag&&!this._endFlag&&this._conn.isOpen())return this._contFlag=!0,this._outstandingRequests+=1,this._conn._continueQuery(this._token)},t.prototype.hasNext=function(){throw new f.ReqlDriverError("The `hasNext` command has been removed since 1.13. Use `next` instead.")},t.prototype._next=v(0,1,(function(t){var e,r;if(null!=t&&"function"!=typeof t)throw new f.ReqlDriverError("First argument to `next` must be a function or undefined.");return r=this,e=function(t){return r._cbQueue.push(t),r._promptNext()},p.fromNode(e).nodeify(t)})),t.prototype.close=v(0,1,(function(t){var e;return null!=this._closeCbPromise?this._closeCbPromise.isPending()?this._closeCbPromise=this._closeCbPromise.nodeify(t):this._closeCbPromise=p.resolve().nodeify(t):this._endFlag?(this._closeCbPromise=p.resolve().nodeify(t),this._responses=[],this._responseIndex=0):this._closeCbPromise=new p((e=this,function(t,r){return e._closeCb=function(n){for(e._responses=[],e._responseIndex=0;e._cbQueue.length>0;)e._cbQueue.shift();return e._outstandingRequests=0,n?r(n):t()},e._closeAsap=!0,e._outstandingRequests+=1,e._conn._endQuery(e._token)})).nodeify(t),this._closeCbPromise})),t.prototype.each=v(1,2,(function(t,e){var r,n;if("function"!=typeof t)throw new f.ReqlDriverError("First argument to each must be a function.");if(null!=e&&"function"!=typeof e)throw new f.ReqlDriverError("Optional second argument to each must be a function.");return this,n=this,r=function(o,i){return null!=o?"No more rows in the cursor."===o.message?"function"==typeof e?e():void 0:t(o):!1!==t(null,i)?n._next(r):"function"==typeof e?e():void 0},this._next(r)})),t.prototype.eachAsync=v(1,3,(function(t,e,r){var n,o,i,s,c;if(null==r&&(r={concurrency:1}),"function"!=typeof t)throw new f.ReqlDriverError("First argument to eachAsync must be a function.");if(null!=e)if("object"==typeof e)r=e,e=void 0;else if("function"!=typeof e)throw new f.ReqlDriverError("Optional second argument to eachAsync must be a function or `options` object");if(!(r&&"number"==typeof r.concurrency&&r.concurrency>0))throw new f.ReqlDriverError("Optional `options.concurrency` argument to eachAsync must be a positive number");return o=[],s=function(e){var r,n,o,i;return t.length<=1?i=p.resolve(t(e)):(o=!1,r=!1,n=void 0,i=p.fromNode((function(i){return void 0!==t(e,(function(t){return o=!0,r?i(t):n=t}))?i(new f.ReqlDriverError("A two-argument row handler for eachAsync may only return undefined.")):o&&i(n),r=!0}))),i.then((function(t){if(void 0===t||typeof t===p)return t;throw new f.ReqlDriverError("Row handler for eachAsync may only return a Promise or undefined.")}))},c=this,i=(n=function(){return null!=c._closeCbPromise?p.resolve().then((function(t){throw new f.ReqlDriverError("Cursor is closed.")})):c._next().then((function(t){return o.length<r.concurrency?t:p.any(o).catch(p.AggregateError,(function(t){throw t[0]})).return(t)})).then((function(t){var e;return e=s(t).then((function(){return o.splice(o.indexOf(e),1)})),o.push(e)})).then(n).catch((function(t){if("No more rows in the cursor."!==(null!=t?t.message:void 0))throw t;return p.all(o)}))})().then((function(){if(null!=e)return e(null)})).catch((function(t){if(null!=e)return e(t);throw t})),null==e?i:null})),t.prototype._each=t.prototype.each,t.prototype._eachAsync=t.prototype.eachAsync,t.prototype.toArray=v(0,1,(function(t){var e,r;if(null!=t&&"function"!=typeof t)throw new f.ReqlDriverCompileError("First argument to `toArray` must be a function or undefined.");return e=[],r=function(t){e.push(t)},this.eachAsync(r).then((function(){return e})).nodeify(t)})),t.prototype._makeEmitter=function(){return this.emitter=new s,this.each=function(){throw new f.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")},this.next=function(){throw new f.ReqlDriverError("You cannot use the cursor interface and the EventEmitter interface at the same time.")}},t.prototype.addListener=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.addListener(t,e)},t.prototype.on=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.on(t,e)},t.prototype.once=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.once(t,e)},t.prototype.removeListener=function(t,e){var r;return null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),this.emitter.removeListener(t,e)},t.prototype.removeAllListeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.removeAllListeners(t)},t.prototype.setMaxListeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.setMaxListeners(t)},t.prototype.listeners=function(t){var e;return null==this.emitter&&(this._makeEmitter(),y((e=this,function(){return e._each(e._eachCb)}))),this.emitter.listeners(t)},t.prototype.emit=function(){var t,e,r;return t=1<=arguments.length?g.call(arguments,0):[],null==this.emitter&&(this._makeEmitter(),y((r=this,function(){return r._each(r._eachCb)}))),(e=this.emitter).emit.apply(e,t)},t.prototype._eachCb=function(t,e){return null!=t?this.emitter.emit("error",t):this.emitter.emit("data",e)},t}()),c=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object Feed]"})),e}(u),function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}w(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object UnionedFeed]"}))}(u),o=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object AtomFeed]"})),e}(u),a=function(t){function e(){this._type=_.SUCCESS_PARTIAL,e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.hasNext=function(){throw new f.ReqlDriverError("`hasNext` is not available for feeds.")},e.prototype.toArray=function(){throw new f.ReqlDriverError("`toArray` is not available for feeds.")},e.prototype.toString=l((function(){return"[object OrderByLimitFeed]"})),e}(u),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype._hasNext=l((function(){return null==this.__index&&(this.__index=0),this.__index<this.length})),e.prototype._next=v(0,1,(function(t){var e,r;return r=this,e=function(t){var e;return null!=r._closeCbPromise&&t(new f.ReqlDriverError("Cursor is closed.")),!0===r._hasNext()?(e=r).__index%r.stackSize==r.stackSize-1?y((function(){return t(null,e[e.__index++])})):t(null,e[e.__index++]):t(new f.ReqlDriverError("No more rows in the cursor."))},p.fromNode(e).nodeify(t)})),e.prototype.toArray=v(0,1,(function(t){var e,r;return r=this,e=function(t){return null!=r._closeCbPromise&&t(new f.ReqlDriverError("Cursor is closed.")),null!=r.__index?t(null,r.slice(r.__index,r.length)):t(null,r)},p.fromNode(e).nodeify(t)})),e.prototype.close=v(0,1,(function(t){return this.length=0,this.__index=0,this._closeCbPromise=p.resolve().nodeify(t),this._closeCbPromise})),e.prototype.makeIterable=function(t){var r,n,o;for(n in t.__proto__={},o=e.prototype)r=o[n],"constructor"!==n&&("_next"===n?(t.__proto__.next=r,t.__proto__._next=r):t.__proto__[n]=r);return t.__proto__.__proto__=[].__proto__,t},e}(u),t.exports.Cursor=i,t.exports.Feed=c,t.exports.AtomFeed=o,t.exports.OrderByLimitFeed=a,t.exports.makeIterable=n.prototype.makeIterable}])}));